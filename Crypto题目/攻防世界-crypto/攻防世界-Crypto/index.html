<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>攻防世界-crypto | J1Nmu</title><meta name="author" content="Jinmu"><meta name="copyright" content="Jinmu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="攻防世界-Crypto[简单] 初识RSA刚开始还以为qp,pq跟dp,dq一样 后来发现题目给出了 pq &amp;#x3D; p*(q-1)qp &amp;#x3D; q*(p-1) hidden key1234567891011121314151617181920212223import  randomimport hashli"><link rel="shortcut icon" href="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg"><link rel="canonical" href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '攻防世界-crypto',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-18 10:28:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">J1Nmu</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">攻防世界-crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-03-15T05:19:45.011Z" title="发表于 2023-03-15 13:19:45">2023-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-18T02:28:50.174Z" title="更新于 2023-03-18 10:28:50">2023-03-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/">Crypto题目</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/">攻防世界-crypto</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="攻防世界-crypto"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="攻防世界-Crypto"><a href="#攻防世界-Crypto" class="headerlink" title="攻防世界-Crypto"></a>攻防世界-Crypto</h1><h2 id="简单-初识RSA"><a href="#简单-初识RSA" class="headerlink" title="[简单] 初识RSA"></a>[简单] 初识RSA</h2><p>刚开始还以为qp,pq跟dp,dq一样</p>
<p>后来发现题目给出了</p>
<p><code>pq = p*(q-1)</code><br><code>qp = q*(p-1)</code></p>
<h2 id="hidden-key"><a href="#hidden-key" class="headerlink" title="hidden key"></a>hidden key</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># [140, 96, 112, 178, 38, 180, 158, 240, 179, 202, 251, 138, 188, 185, 23, 67, 163, 22, 150, 18, 143, 212, 93, 87, 209, 139, 92, 252, 55, 137, 6, 231, 105, 12, 65, 59, 223, 25, 179, 101, 19, 215]</span></span><br><span class="line"><span class="comment"># 2669175714787937</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">140</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">178</span>, <span class="number">38</span>, <span class="number">180</span>, <span class="number">158</span>, <span class="number">240</span>, <span class="number">179</span>, <span class="number">202</span>, <span class="number">251</span>, <span class="number">138</span>, <span class="number">188</span>, <span class="number">185</span>, <span class="number">23</span>, <span class="number">67</span>, <span class="number">163</span>, <span class="number">22</span>, <span class="number">150</span>, <span class="number">18</span>, <span class="number">143</span>, <span class="number">212</span>, <span class="number">93</span>, <span class="number">87</span>, <span class="number">209</span>, <span class="number">139</span>, <span class="number">92</span>, <span class="number">252</span>, <span class="number">55</span>, <span class="number">137</span>, <span class="number">6</span>, <span class="number">231</span>, <span class="number">105</span>, <span class="number">12</span>, <span class="number">65</span>, <span class="number">59</span>, <span class="number">223</span>, <span class="number">25</span>, <span class="number">179</span>, <span class="number">101</span>, <span class="number">19</span>, <span class="number">215</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>(<span class="params">rng</span>):</span><br><span class="line">    <span class="keyword">return</span> rng - random.randrange(rng)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2669175714787937</span> &lt;&lt; <span class="number">12</span>, (<span class="number">2669175714787937</span> &lt;&lt; <span class="number">12</span>) + <span class="number">4096</span>):</span><br><span class="line">  key = long_to_bytes(idx)</span><br><span class="line">  random.seed(<span class="built_in">int</span>(hashlib.md5(key).hexdigest(), <span class="number">16</span>))</span><br><span class="line">  flag = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">      rand(<span class="number">256</span>)</span><br><span class="line">      xor = enc[i] ^ rand(<span class="number">256</span>)</span><br><span class="line">      flag += <span class="built_in">chr</span>(xor)</span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag is: &#123;&#125;\nkey is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(flag, idx))</span><br></pre></td></tr></table></figure>



<h2 id="easychallenge"><a href="#easychallenge" class="headerlink" title="easychallenge"></a>easychallenge</h2><p>这里我把题目给出的pyc文件重命名为test.pyc，反编译后的源代码放入test.py中，无需事先创建test.py，直接在pyc文件所在位置打开终端，输入下面这句命令即可：<br>（我用的是MacBook）<br>uncompyle6 -o test.py test.pyc</p>
<h2 id="简单的LFSR"><a href="#简单的LFSR" class="headerlink" title="简单的LFSR"></a>简单的LFSR</h2><h3 id="matrix"><a href="#matrix" class="headerlink" title="matrix()"></a>matrix()</h3><p>矩阵所处环的表示<br>ZZ：整数环<br>QQ：有理数环<br>Zmod(p)：p为素数，定义在Zp上<br><strong>矩阵操作</strong><br><strong>声明</strong><br><strong>超完整定义</strong></p>
<p>mt &#x3D; matrix(QQ, 3, 2, [1, 2, 3, 4, 5, 6])</p>
<p><strong>完整定义</strong></p>
<p>mt &#x3D; matrix(ZZ, 3, 4) #定义一个在整数环上的3行4列的矩阵<br>mt &#x3D; matrix(ZZ, 0, 4) #定义一个在整数环上0行4列的矩阵，后期可动态添加行</p>
<p><strong>部分定义</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mt = matrix(QQ, 3, [1, 2, 3, 4, 5, 6]) #定义在有理数环上的3列矩阵，并赋值</span><br></pre></td></tr></table></figure>

<h5 id="求矩阵X满足XA-x3D-B"><a href="#求矩阵X满足XA-x3D-B" class="headerlink" title="求矩阵X满足XA&#x3D;B"></a>求矩阵X满足XA&#x3D;B</h5><blockquote>
<p>X &#x3D; A.solve_left(B)</p>
</blockquote>
<h5 id="求矩阵X满足AX-x3D-B"><a href="#求矩阵X满足AX-x3D-B" class="headerlink" title="求矩阵X满足AX&#x3D;B"></a>求矩阵X满足AX&#x3D;B</h5><blockquote>
<p>X &#x3D; A.solve_right(B)</p>
</blockquote>
<p>确实不会直接看的WP</p>
<p>题目源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"># a 01 string with length 128</span><br><span class="line"># your flag is flag&#123;md5(secret).hexdigest()&#125;</span><br><span class="line">secret=&#x27;11111111111111011001111114211111111111111111111111111111111111111111111111111111111111111111111111111139111111111111111111111111&#x27;</span><br><span class="line">def string2bits(s):#该函数将输入的字符串转换为位列表，其中每个字符都被转换为其二进制表示。</span><br><span class="line">    return [int(b) for b in s]</span><br><span class="line"></span><br><span class="line">def lfsr(state, mask):</span><br><span class="line">    assert(len(state) == 128)</span><br><span class="line">    assert(len(mask)  == 128)</span><br><span class="line">    nnn=0</span><br><span class="line">    output = 0</span><br><span class="line">    for i in range(128):</span><br><span class="line">        nnn=(state[i] * mask[i])</span><br><span class="line">        output = output + (state[i] * mask[i])#将 state 和 mask 的对应位相乘，将结果累加起来作为输出值 output</span><br><span class="line">    return output#state 和 mask 都是长度为 128 的二进制位序列，输出值 output 是一个十进制数。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    initState = [0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0]</span><br><span class="line">    mask = string2bits(secret)</span><br><span class="line"></span><br><span class="line">    for i in range(256):#生成output放到initState的最后一位,并向前移一位i而进行下一次循环</span><br><span class="line">        state = initState[i:]</span><br><span class="line">        output = lfsr(state, mask)</span><br><span class="line">        initState += [output]</span><br><span class="line"></span><br><span class="line">    outputState = initState[128:]</span><br><span class="line">    print(&#x27;outputState =&#x27;, outputState)</span><br><span class="line">    #</span><br><span class="line">    # outputState = [31, 66, 128, 222, 385, 664, 1143, 2000, 3458, 6003, 10379, 17942, 31047, 53687, 92924, 160797, 278304, 481638, 833479, 1442422, 2496163, 4319845, 7475835, 12937561, 22389578, 38746915, 67054735, 116043520, 200822710, 347539886, 601445745, 1040850538, 1801275628, 3117252874, 5394657302, 9335889442, 16156509611, 27960142496, 48387281659, 83738092531, 144915522009, 250787996657, 434008851435, 751087316130, 1299817167363, 2249438425629, 3892834588915, 6736864173067, 11658686709797, 20176297502410, 34916709837729, 60426182042628, 104572380769600, 180970937597032, 313184800936842, 541991553121913, 937960088661442, 1623215570164618, 2809105439634215, 4861383488449105, 8413016146818879, 14559402864389777, 25196220721365800, 43604091771673155, 75460397027739861, 130590302153314191, 225997048627046433, 391106116962451401, 676840674047358730, 1171327366605398299, 2027076463289970382, 3508019282374090135, 6070910253447116278, 10506199749411485204, 18181825882182859769, 31465115864423937634, 54452920337985370536, 94235169707018163674, 163081560265112209496, 282225790871820528073, 488414489680745790033, 845240659945376349091, 1462757121910708796880, 2531419155626961478438, 4380824981460105751921, 7581370898424646092677, 13120173698498971899800, 22705518590912550882405, 39293730885686099313323, 68000969928723717268434, 117681162033195064953557, 203656740661184789826464, 352444412513853856490154, 609933476834387348179796, 1055539066458205919344242, 1826695472762162772755920, 3161243819621244340994611, 5470787351316040252901913, 9467638673598260118507327, 16384512191330329194463349, 28354719587732695891973236, 49070128760035595469947547, 84919814815174884654495265, 146960587438213290271803310, 254327147405947343219170013, 440133637427387650641676733, 761686751771954639615932308, 1318160346062225166536927204, 2281182774793880566386854202, 3947770745464875128215489476, 6831935621711193478803584270, 11823215517979626989252654459, 20461027873324936552011726278, 35409458704049766870463574070, 61278923692217093991616774374, 106048118957748860598268928024, 183524821535095103500935105397, 317604503036094959823791626415, 549640204006492782256703506357, 951196695803666227643791343005, 1646122586216645151673646795131, 2848747878127492747395146497119, 4929987925010971381846789176787, 8531741656523753626888968333475, 14764866932914585711739993009471, 25551792860485990447357753377411, 44219438031623458174827090101591, 76525303351860239321171606062486, 132433208420836012247860425341878, 229186346534231007543300455047052, 396625454174562824696341867974807, 686392332170111774628387415187708, 1187857281228776953526538661167132, 2055682813511567389589959681437591, 3557524878237416677051445431119245, 6156583679200434562674367324375645, 10654464521349051207718915685250792, 18438410026033851006551039004948926, 31909155416202798852780253976608864, 55221366589513932226781115179478434, 95565027912492621164419094117570641, 165382987128929746587819720020389833, 286208595645816231325692474821432127, 495307054513959920117280296979778603, 857168799202977606481906830566592959, 1483399728776458203402121501599814357, 2567142851419860475561591348189292465, 4442647717774532025797522076302827645, 7688360128977964468508623330874749520, 13305327189541069887965447505836108943, 23025941637865784521234444191415083701, 39848248807227476288131461546822173104, 68960607908058729168472941626927516912, 119341892941264496254850267375680858596, 206530769418287872448439164819365157712, 357418151038572249261836365381689027787, 618540932431735991718001801386896334770, 1070434962471260463170389697079661487176, 1852474022011964581139009223827365513544, 3205855677870125101423860144920010424249, 5547991769498476629256700835469967207037, 9601247144996961660705018593534913225922, 16615732425220501988109900409620796156745, 28754864847988594478375696246052761203187, 49762612400465240380187427652132912229336, 86118213596547492163397334421181607606370, 149034513167786192667574788821667110253623, 257916243121530494722068502259305736264048, 446344856986474817826595353109273441918350, 772435768089263602359077702861161388353409, 1336762385595787378549468975393213339116484, 2313375104267880490155624917599100889633507, 4003482167596451918353914186255524345816532, 6928348730257112541629154203810355027525535, 11990066177033590775605142065871666200189459, 20749776393589512464840020374644649655647874, 35909161302935015278730531942138798319507636, 62143699335409560081369603141161471393159562, 107544682943462043814216772302622710407400704, 186114746194704481727730115452186541297539854, 322086576510057527551600558671512063007190557, 557396793585831655018738502556644467159583633, 964620099559052960425720416252526682882655111, 1669352868873354804885622348664567494237803783, 2888949755545809136243688064556192446919868175, 4999560515746991945989073252770067125902428535, 8652142635098861248148452777057412533362877977, 14973230535426489152060521332311783517581989420, 25912382876992006096351135796067625851883928825, 44843468133024591960270046213401958144446811548, 77605237763877474989955856305494246316739147127, 134302122006319171731632762048131880552676359659, 232420652202367984596938247872208285088912788686, 402222680946414142984184322215356821073359953948, 696078784456971603910909918744734815016448573082, 1204620468022900362280402553035290601874308600586, 2084692860035604927076197374205039877760447754956, 3607729103106034863624554004184342562208475089341, 6243466138784576918107250594832177417637788944304, 10804821623826866941723224844111388709787418308073, 18698615116609470739339911758664365362637188157227, 32359461308280335893458609544003265039362932173740, 56000657248244594858300036379967633467510318826268, 96913653239119041752111865895809664169241405330164, 167716892009274048794745102986623447430717183044189, 290247606246426020117292750048691625438809474898504, 502296888062545512718475829352732508523042936581530, 869265269816240261877029457458234318249621243667628, 1504333646627354107869007496936781479204707239575364, 2603370684363759081777877568090078592049534352669947, 4505342904082185194291963661562434728467247085801567, 7796859204598587173314308958000104480418858953375158, 13493093589225451977147040588861591346827624626553088, 23350886533928418622148518003626067086836308029229306, 40410592153292809121198774051487713973447271440824879, 69933788415571610361075397290260005189363125951186151, 121026060286409890014591649872661507384922097295622585, 209445356819655999941471437498154462693217873859873519, 362462079567824464738504374835340908769751488853277318, 627269857492024846036766185061792395514128412691597750, 1085541071185182881358902065797900004206275433304525877, 1878616361292087979017649753948129817575491489985996469, 3251097104102362704835900720328806405351210311448488910, 5626285705844227224482132571164442587287950705132698177, 9736741115435595736854097976874400909429981720207988487, 16850215667245180941552990697851306753178430167486844006, 29160657006948951882262364132481449161390275730087294685, 50464868454466647556267645846637274956572498586114427735, 87333524327649631040132103644841977096784627243509857937, 151137706390139040826448707126591974417399010694640174718, 261555988593488478677610370284679511774525269175612894617, 452643730033345117036459086235348615186246366652477694168, 783336475835524143955537154153262203019092265959952337070, 1355626939379487620769121922144227585175531097052439217983, 2346021735820790423533561047507688175516954900918138334291, 4059979796110323903393797058491537625611005518946149411026, 7026122432346967683382009847205881024752630926437218981740, 12159271452933065576710291263470354882115951853620136774055, 21042599768180623908382939506716338579508214228553692875423, 36415915765826987773364669427220163018133640081486671468436, 63020678797925209300085103082659626905494796721119527734083, 109062366622625198169859916735972641477602693706580750774247, 188741220186912829686057249397861922209555075583934877024777, 326631901551406455092777938653826814900794821912935940782874, 565262845103114204256414747869081614169923740442179762058936, 978232936025018959853100287323851115023773163216042197843195, 1692910980111501346802672231436092377546116455476214539222026, 2929718966760270262844895994547637314231078419236801672684198, 5070114923366815738216357619638190602226980891746062079428250, 8774242726964718704518978915749604855301897112378619823447909, 15184534590503864395968205111669668293209355696392197598100449, 26278061583779512058870924747917968681797893736357134971437061, 45476304623307832769415233578427592641287934525440233150419102, 78700412341998941621862709864667467345902574612843786168968091, 136197409928206718914848388530217366761295027423898231594892758, 235700600786468895717413188934153824796333855958950958366797470]</span><br><span class="line">    #</span><br></pre></td></tr></table></figure>

<p>分析一下题目逻辑。初始化数组 <code>initState</code> ，即为LFSR(线性反馈移位寄存器)的初始状态，<code>mask</code> 是flag转二进制之后的数组。</p>
<p>最主要的操作就是进行256轮LFSR计算</p>
<ul>
<li><code>lfsr</code>函数逻辑不算复杂，输入两个长度为128数组 <code>state, mask</code> ，输出 <code>output</code> 值为$out&#x3D;\sum{state_i \times mask_i}$</li>
<li>注意到每轮 <code>state</code> 数组取值会向右移动一个位置，同时 <code>initState</code> 长度会增长1，即数组尾部追加了 <code>output</code> 值</li>
</ul>
<p>关键的关系式$out&#x3D;\sum{state_i \times mask_i}$<br>可改写为矩阵乘法形式$out&#x3D;State \times Mask$<br>State是 $1\times128$ 向量，Mask是 $128 \times 1$ 向量</p>
<p>256轮循环最终输出 <code>initState</code> 数组后256个元素，命名为 <code>outputState</code>，其中$outputState_{0…127} \times Mask &#x3D; outputState_{128} <br>outputState_{1…128} \times Mask &#x3D; outputState_{129} <br>\cdots <br>outputState_{127…254} \times Mask &#x3D; outputState_{255}$</p>
<p>接下来就是简单的线性方程组求解了。</p>
<p>最终exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">outputState = [<span class="number">31</span>, <span class="number">66</span>, <span class="number">128</span>, <span class="number">222</span>, <span class="number">385</span>, <span class="number">664</span>, <span class="number">1143</span>, <span class="number">2000</span>, <span class="number">3458</span>, <span class="number">6003</span>, <span class="number">10379</span>, <span class="number">17942</span>, <span class="number">31047</span>, <span class="number">53687</span>, <span class="number">92924</span>, <span class="number">160797</span>, <span class="number">278304</span>, <span class="number">481638</span>, <span class="number">833479</span>, <span class="number">1442422</span>, <span class="number">2496163</span>, <span class="number">4319845</span>, <span class="number">7475835</span>, <span class="number">12937561</span>, <span class="number">22389578</span>, <span class="number">38746915</span>, <span class="number">67054735</span>, <span class="number">116043520</span>, <span class="number">200822710</span>, <span class="number">347539886</span>, <span class="number">601445745</span>, <span class="number">1040850538</span>, <span class="number">1801275628</span>, <span class="number">3117252874</span>, <span class="number">5394657302</span>, <span class="number">9335889442</span>, <span class="number">16156509611</span>, <span class="number">27960142496</span>, <span class="number">48387281659</span>, <span class="number">83738092531</span>, <span class="number">144915522009</span>, <span class="number">250787996657</span>, <span class="number">434008851435</span>, <span class="number">751087316130</span>, <span class="number">1299817167363</span>, <span class="number">2249438425629</span>, <span class="number">3892834588915</span>, <span class="number">6736864173067</span>, <span class="number">11658686709797</span>, <span class="number">20176297502410</span>, <span class="number">34916709837729</span>, <span class="number">60426182042628</span>, <span class="number">104572380769600</span>, <span class="number">180970937597032</span>, <span class="number">313184800936842</span>, <span class="number">541991553121913</span>, <span class="number">937960088661442</span>, <span class="number">1623215570164618</span>, <span class="number">2809105439634215</span>, <span class="number">4861383488449105</span>, <span class="number">8413016146818879</span>, <span class="number">14559402864389777</span>, <span class="number">25196220721365800</span>, <span class="number">43604091771673155</span>, <span class="number">75460397027739861</span>, <span class="number">130590302153314191</span>, <span class="number">225997048627046433</span>, <span class="number">391106116962451401</span>, <span class="number">676840674047358730</span>, <span class="number">1171327366605398299</span>, <span class="number">2027076463289970382</span>, <span class="number">3508019282374090135</span>, <span class="number">6070910253447116278</span>, <span class="number">10506199749411485204</span>, <span class="number">18181825882182859769</span>, <span class="number">31465115864423937634</span>, <span class="number">54452920337985370536</span>, <span class="number">94235169707018163674</span>, <span class="number">163081560265112209496</span>, <span class="number">282225790871820528073</span>, <span class="number">488414489680745790033</span>, <span class="number">845240659945376349091</span>, <span class="number">1462757121910708796880</span>, <span class="number">2531419155626961478438</span>, <span class="number">4380824981460105751921</span>, <span class="number">7581370898424646092677</span>, <span class="number">13120173698498971899800</span>, <span class="number">22705518590912550882405</span>, <span class="number">39293730885686099313323</span>, <span class="number">68000969928723717268434</span>, <span class="number">117681162033195064953557</span>, <span class="number">203656740661184789826464</span>, <span class="number">352444412513853856490154</span>, <span class="number">609933476834387348179796</span>, <span class="number">1055539066458205919344242</span>, <span class="number">1826695472762162772755920</span>, <span class="number">3161243819621244340994611</span>, <span class="number">5470787351316040252901913</span>, <span class="number">9467638673598260118507327</span>, <span class="number">16384512191330329194463349</span>, <span class="number">28354719587732695891973236</span>, <span class="number">49070128760035595469947547</span>, <span class="number">84919814815174884654495265</span>, <span class="number">146960587438213290271803310</span>, <span class="number">254327147405947343219170013</span>, <span class="number">440133637427387650641676733</span>, <span class="number">761686751771954639615932308</span>, <span class="number">1318160346062225166536927204</span>, <span class="number">2281182774793880566386854202</span>, <span class="number">3947770745464875128215489476</span>, <span class="number">6831935621711193478803584270</span>, <span class="number">11823215517979626989252654459</span>, <span class="number">20461027873324936552011726278</span>, <span class="number">35409458704049766870463574070</span>, <span class="number">61278923692217093991616774374</span>, <span class="number">106048118957748860598268928024</span>, <span class="number">183524821535095103500935105397</span>, <span class="number">317604503036094959823791626415</span>, <span class="number">549640204006492782256703506357</span>, <span class="number">951196695803666227643791343005</span>, <span class="number">1646122586216645151673646795131</span>, <span class="number">2848747878127492747395146497119</span>, <span class="number">4929987925010971381846789176787</span>, <span class="number">8531741656523753626888968333475</span>, <span class="number">14764866932914585711739993009471</span>, <span class="number">25551792860485990447357753377411</span>, <span class="number">44219438031623458174827090101591</span>, <span class="number">76525303351860239321171606062486</span>, <span class="number">132433208420836012247860425341878</span>, <span class="number">229186346534231007543300455047052</span>, <span class="number">396625454174562824696341867974807</span>, <span class="number">686392332170111774628387415187708</span>, <span class="number">1187857281228776953526538661167132</span>, <span class="number">2055682813511567389589959681437591</span>, <span class="number">3557524878237416677051445431119245</span>, <span class="number">6156583679200434562674367324375645</span>, <span class="number">10654464521349051207718915685250792</span>, <span class="number">18438410026033851006551039004948926</span>, <span class="number">31909155416202798852780253976608864</span>, <span class="number">55221366589513932226781115179478434</span>, <span class="number">95565027912492621164419094117570641</span>, <span class="number">165382987128929746587819720020389833</span>, <span class="number">286208595645816231325692474821432127</span>, <span class="number">495307054513959920117280296979778603</span>, <span class="number">857168799202977606481906830566592959</span>, <span class="number">1483399728776458203402121501599814357</span>, <span class="number">2567142851419860475561591348189292465</span>, <span class="number">4442647717774532025797522076302827645</span>, <span class="number">7688360128977964468508623330874749520</span>, <span class="number">13305327189541069887965447505836108943</span>, <span class="number">23025941637865784521234444191415083701</span>, <span class="number">39848248807227476288131461546822173104</span>, <span class="number">68960607908058729168472941626927516912</span>, <span class="number">119341892941264496254850267375680858596</span>, <span class="number">206530769418287872448439164819365157712</span>, <span class="number">357418151038572249261836365381689027787</span>, <span class="number">618540932431735991718001801386896334770</span>, <span class="number">1070434962471260463170389697079661487176</span>, <span class="number">1852474022011964581139009223827365513544</span>, <span class="number">3205855677870125101423860144920010424249</span>, <span class="number">5547991769498476629256700835469967207037</span>, <span class="number">9601247144996961660705018593534913225922</span>, <span class="number">16615732425220501988109900409620796156745</span>, <span class="number">28754864847988594478375696246052761203187</span>, <span class="number">49762612400465240380187427652132912229336</span>, <span class="number">86118213596547492163397334421181607606370</span>, <span class="number">149034513167786192667574788821667110253623</span>, <span class="number">257916243121530494722068502259305736264048</span>, <span class="number">446344856986474817826595353109273441918350</span>, <span class="number">772435768089263602359077702861161388353409</span>, <span class="number">1336762385595787378549468975393213339116484</span>, <span class="number">2313375104267880490155624917599100889633507</span>, <span class="number">4003482167596451918353914186255524345816532</span>, <span class="number">6928348730257112541629154203810355027525535</span>, <span class="number">11990066177033590775605142065871666200189459</span>, <span class="number">20749776393589512464840020374644649655647874</span>, <span class="number">35909161302935015278730531942138798319507636</span>, <span class="number">62143699335409560081369603141161471393159562</span>, <span class="number">107544682943462043814216772302622710407400704</span>, <span class="number">186114746194704481727730115452186541297539854</span>, <span class="number">322086576510057527551600558671512063007190557</span>, <span class="number">557396793585831655018738502556644467159583633</span>, <span class="number">964620099559052960425720416252526682882655111</span>, <span class="number">1669352868873354804885622348664567494237803783</span>, <span class="number">2888949755545809136243688064556192446919868175</span>, <span class="number">4999560515746991945989073252770067125902428535</span>, <span class="number">8652142635098861248148452777057412533362877977</span>, <span class="number">14973230535426489152060521332311783517581989420</span>, <span class="number">25912382876992006096351135796067625851883928825</span>, <span class="number">44843468133024591960270046213401958144446811548</span>, <span class="number">77605237763877474989955856305494246316739147127</span>, <span class="number">134302122006319171731632762048131880552676359659</span>, <span class="number">232420652202367984596938247872208285088912788686</span>, <span class="number">402222680946414142984184322215356821073359953948</span>, <span class="number">696078784456971603910909918744734815016448573082</span>, <span class="number">1204620468022900362280402553035290601874308600586</span>, <span class="number">2084692860035604927076197374205039877760447754956</span>, <span class="number">3607729103106034863624554004184342562208475089341</span>, <span class="number">6243466138784576918107250594832177417637788944304</span>, <span class="number">10804821623826866941723224844111388709787418308073</span>, <span class="number">18698615116609470739339911758664365362637188157227</span>, <span class="number">32359461308280335893458609544003265039362932173740</span>, <span class="number">56000657248244594858300036379967633467510318826268</span>, <span class="number">96913653239119041752111865895809664169241405330164</span>, <span class="number">167716892009274048794745102986623447430717183044189</span>, <span class="number">290247606246426020117292750048691625438809474898504</span>, <span class="number">502296888062545512718475829352732508523042936581530</span>, <span class="number">869265269816240261877029457458234318249621243667628</span>, <span class="number">1504333646627354107869007496936781479204707239575364</span>, <span class="number">2603370684363759081777877568090078592049534352669947</span>, <span class="number">4505342904082185194291963661562434728467247085801567</span>, <span class="number">7796859204598587173314308958000104480418858953375158</span>, <span class="number">13493093589225451977147040588861591346827624626553088</span>, <span class="number">23350886533928418622148518003626067086836308029229306</span>, <span class="number">40410592153292809121198774051487713973447271440824879</span>, <span class="number">69933788415571610361075397290260005189363125951186151</span>, <span class="number">121026060286409890014591649872661507384922097295622585</span>, <span class="number">209445356819655999941471437498154462693217873859873519</span>, <span class="number">362462079567824464738504374835340908769751488853277318</span>, <span class="number">627269857492024846036766185061792395514128412691597750</span>, <span class="number">1085541071185182881358902065797900004206275433304525877</span>, <span class="number">1878616361292087979017649753948129817575491489985996469</span>, <span class="number">3251097104102362704835900720328806405351210311448488910</span>, <span class="number">5626285705844227224482132571164442587287950705132698177</span>, <span class="number">9736741115435595736854097976874400909429981720207988487</span>, <span class="number">16850215667245180941552990697851306753178430167486844006</span>, <span class="number">29160657006948951882262364132481449161390275730087294685</span>, <span class="number">50464868454466647556267645846637274956572498586114427735</span>, <span class="number">87333524327649631040132103644841977096784627243509857937</span>, <span class="number">151137706390139040826448707126591974417399010694640174718</span>, <span class="number">261555988593488478677610370284679511774525269175612894617</span>, <span class="number">452643730033345117036459086235348615186246366652477694168</span>, <span class="number">783336475835524143955537154153262203019092265959952337070</span>, <span class="number">1355626939379487620769121922144227585175531097052439217983</span>, <span class="number">2346021735820790423533561047507688175516954900918138334291</span>, <span class="number">4059979796110323903393797058491537625611005518946149411026</span>, <span class="number">7026122432346967683382009847205881024752630926437218981740</span>, <span class="number">12159271452933065576710291263470354882115951853620136774055</span>, <span class="number">21042599768180623908382939506716338579508214228553692875423</span>, <span class="number">36415915765826987773364669427220163018133640081486671468436</span>, <span class="number">63020678797925209300085103082659626905494796721119527734083</span>, <span class="number">109062366622625198169859916735972641477602693706580750774247</span>, <span class="number">188741220186912829686057249397861922209555075583934877024777</span>, <span class="number">326631901551406455092777938653826814900794821912935940782874</span>, <span class="number">565262845103114204256414747869081614169923740442179762058936</span>, <span class="number">978232936025018959853100287323851115023773163216042197843195</span>, <span class="number">1692910980111501346802672231436092377546116455476214539222026</span>, <span class="number">2929718966760270262844895994547637314231078419236801672684198</span>, <span class="number">5070114923366815738216357619638190602226980891746062079428250</span>, <span class="number">8774242726964718704518978915749604855301897112378619823447909</span>, <span class="number">15184534590503864395968205111669668293209355696392197598100449</span>, <span class="number">26278061583779512058870924747917968681797893736357134971437061</span>, <span class="number">45476304623307832769415233578427592641287934525440233150419102</span>, <span class="number">78700412341998941621862709864667467345902574612843786168968091</span>, <span class="number">136197409928206718914848388530217366761295027423898231594892758</span>, <span class="number">235700600786468895717413188934153824796333855958950958366797470</span>]</span><br><span class="line"><span class="comment">#print(len(outputState))</span></span><br><span class="line">OOi = []</span><br><span class="line">Oi = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    OOi += outputState[i:i+<span class="number">128</span>]<span class="comment">#产生128行128列的元组</span></span><br><span class="line">    Oi += [outputState[i+<span class="number">128</span>]]<span class="comment">#产生一行,outputState后128位的元组</span></span><br><span class="line">OO = matrix(ZZ, <span class="number">128</span>, <span class="number">128</span>, OOi)<span class="comment">#定义在整数环上的128行128列的矩阵,值位OOi</span></span><br><span class="line">O = matrix(ZZ, <span class="number">128</span>, <span class="number">1</span>, Oi)<span class="comment">#定义在整数环上的128行1列的矩阵,值为0i</span></span><br><span class="line"></span><br><span class="line">Mask = OO.solve_right(O) <span class="comment">#使用OO.solve_right(O)函数求解线性方程组，求解OO*Mask = O的Mask向量。这相当于求解一个包含128个未知数的线性方程组，其中OO是系数矩阵，O是右侧向量。最终，我们得到一个128x1的向量Mask，其中每个元素都是一个整数，这些整数可以用来还原出输入状态。最后一行代码将Mask向量转化成一个字符串，方便输出或保存。总的来说求,OO*Mask = O中Mask的值</span></span><br><span class="line">M=Mask.<span class="built_in">str</span>().replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(M)</span><br></pre></td></tr></table></figure>

<h2 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h2><p>sage脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">p1= 1687218514918517855575434101578033845149036490224579822827979075465068557041497711556817903</span><br><span class="line">ct= 12064011747803325912866466307234048263037259126111461847199376361139809290978473</span><br><span class="line">n= 26586107738552331744426768003576033375514016341586948681114321820716869769637129058784596344443680415970416750346645932529974300034413034297623751845263127864060953411036172446629820353154963911058471787603315585163748222613808285619182911620989798439871267925818589173138174609487115705820373755843147870743656744828817669892447290611871396352856304511788788431155084959736143569107897238150780382118104265957616726382967416580492631684195794156545072739443492411595146502124172733052938025462196971690279010544099376358676523366221090956163001661252576520987961199693061525924047490066791349182088306086135244487701</span><br><span class="line">c= 25992754856891784830541737103300965001603312505803550734518867983331652067360506309102310176588597992224748887420092986253278784670112180320804675128016470823487185065679104749154630759655677907880519783931786545443195194633493636066961290374061101460605905742286720926706428992888162639167583009041683537389387626572890671903081606945109439086456633959124453951121109882867809787121816169622812075770013843303222379396455066440675945602006581202175212741733511637944875162087732203162858556879085424250668040085632974465833810588417710591745585567328127854775606696523042980479697923631249283800483158275251397607220# p0=n*invert(q0,mod)%mod</span><br><span class="line">pbar=(p1&lt;&lt;724)+ct</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">for i in range(32):</span><br><span class="line">f=pbar+x*mod*32</span><br><span class="line">f=f.monic()</span><br><span class="line">pp=f.small_roots(X=2^454,beta=0.4)</span><br><span class="line">if(pp):</span><br><span class="line">        break</span><br><span class="line">    pbar+=mod</span><br><span class="line">assert pp</span><br><span class="line">p=pbar+pp[0]*32*mod</span><br><span class="line">print(p,type(p))</span><br><span class="line">print(len(str(p)))</span><br><span class="line">print(n//Integer(p))</span><br><span class="line">q=n//Integer(p)</span><br><span class="line">e=65537</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line"># d = gmpy2.invert(e, (p - 1) *(q - 1))</span><br><span class="line"># m = powmod(c, d, n)</span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<h2 id="告诉你个秘密"><a href="#告诉你个秘密" class="headerlink" title="告诉你个秘密"></a>告诉你个秘密</h2><p>积累一下经验吧,这种东西一般就是混合加密了,虽然意义不大,但是记下密码特点终归是不错的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">636A56355279427363446C4A49454A7154534230526D684356445A31614342354E326C4B4946467A5769426961453067</span><br></pre></td></tr></table></figure>

<p>这个容易看出,数字字母,大概就是base</p>
<p>解出来后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cjV5RyBscDlJIEJqTSB0RmhCVDZ1aCB5N2lKIFFzWiBiaE0g</span><br></pre></td></tr></table></figure>

<p>base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r5yG lp9I BjM tFhBT6uh y7iJ QsZ bhM </span><br></pre></td></tr></table></figure>

<p>键盘密码</p>
<h2 id="你猜猜"><a href="#你猜猜" class="headerlink" title="你猜猜"></a>你猜猜</h2><p>内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504B03040A0001080000626D0A49F4B5091F1E0000001200000008000000666C61672E7478746C9F170D35D0A45826A03E161FB96870EDDFC7C89A11862F9199B4CD78E7504B01023F000A0001080000626D0A49F4B5091F1E00000012000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800AF150210CAF2D1015CAEAA05CAF2D1015CAEAA05CAF2D101504B050600000000010001005A000000440000000000</span><br></pre></td></tr></table></figure>

<p><code>504B0304</code>是zip文件头<img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230308200012396.png" alt="image-20230308200012396"></p>
<p>要在winhex中创建新的文件1.zip</p>
<p>放到ARCHPR</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">daczcasdqwdcsdzasd</span><br></pre></td></tr></table></figure>

<h2 id="flag-in-your-hand1"><a href="#flag-in-your-hand1" class="headerlink" title="flag_in_your_hand1"></a>flag_in_your_hand1</h2><p>之能说是积累经验吧</p>
<p>代码审计js.文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function checkToken(s) &#123;</span><br><span class="line">    return s === &quot;FAKE-TOKEN&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以为输入这个就能过了,但没想到不行,看WP说找ic</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function ck(s) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        ic</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    var a = [118, 104, 102, 120, 117, 108, 119, 124, 48,123,101,120];</span><br><span class="line">    if (s.length == a.length) &#123;</span><br><span class="line">        for (i = 0; i &lt; s.length; i++) &#123;</span><br><span class="line">            if (a[i] - s.charCodeAt(i) != 3)</span><br><span class="line">                return ic = false;</span><br><span class="line">        &#125;</span><br><span class="line">        return ic = true;</span><br><span class="line">    &#125;</span><br><span class="line">    return ic = false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是这个,变为字符应该就是token了</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309140719222.png" alt="image-20230309140719222"></p>
<p>竟然错了</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309140730870.png" alt="image-20230309140730870"></p>
<p>问题在这<code>if (a[i] - s.charCodeAt(i) != 3)</code></p>
<p>我们要让输入的字符ASCII码与元组a中数字相减等于3</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309141004551.png" alt="image-20230309141004551"></p>
<p>这个就可以了</p>
<h2 id="工业协议分析2"><a href="#工业协议分析2" class="headerlink" title="工业协议分析2"></a>工业协议分析2</h2><p>题目暗示说flag在异常流量中，那直接明文匹配查找flag,没有换成16进制查找</p>
<p>注意要选择分组字节流 字符串 <img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309142606415.png" alt="image-20230309142606415"></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309142614792.png" alt="image-20230309142614792"></p>
<p>将右下角的16进制转字符即可</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309142700244.png" alt="image-20230309142700244"></p>
<p>点as Printable复制</p>
<h2 id="sherlock"><a href="#sherlock" class="headerlink" title="sherlock"></a>sherlock</h2><p>刚开始就觉得有些大写字母很奇怪,还真是要收集大写字母</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">直接cat 1.txt | grep -o [A-Z]</span><br><span class="line">是这样的</span><br></pre></td></tr></table></figure>

<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309145915287.png" alt="image-20230309145915287"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat 1.txt | grep -o [A-Z] |tr -d &#x27;\n&#x27;</span><br></pre></td></tr></table></figure>

<p>可以删除换行符</p>
<p><code>grep -o</code> 只显示匹配到的字符串<br><code>tr -d</code> 删除指定字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZEROONEZEROZEROZEROZEROONEZEROZEROONEZEROZEROONEZEROZEROONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROONEZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROZEROZEROONEONEZEROZEROONEONEONEONEZEROONEONEZEROONEONEZEROONEZEROZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROZEROONEZEROZEROZEROZEROONEONEZEROZEROONEONEZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROONEONEONEZEROZEROZEROZEROZEROONEONEZEROONEONEZEROZEROZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROONEZEROONEZEROZEROONEONEZEROZEROZEROONEZEROZEROONEONEZEROONEONEONEZEROZEROONEONEZEROZEROONEONEZEROONEONEONEONEONEZEROONE</span><br></pre></td></tr></table></figure>

<p>接下来又两个思路,一个是二进制一个是摩斯电码</p>
<p>文章内容是福尔摩斯所以先试摩斯电码,但摩斯电码要有空格….</p>
<p>还是先试二进制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 开发时间：2023/2/26 15:53</span><br><span class="line">a=&#x27;010000100100100101010100010100110100001101010100010001100111101101101000001100010110010000110011010111110011000101101110010111110111000001101100001101000011000101101110010111110011010100110001001101110011001101111101&#x27;</span><br><span class="line">b = &#x27;&#x27;</span><br><span class="line">for i in range (0,len(a),8):</span><br><span class="line">    b+=&#x27;&#x27;.join(chr(int(a[i:i+8],2)))#将a中数字8个一组,以二进制转换为十进制,</span><br><span class="line">print(b)</span><br><span class="line">#BITSCTF&#123;h1d3_1n_pl41n_5173&#125;</span><br></pre></td></tr></table></figure>

<h2 id="safer-than-rot13"><a href="#safer-than-rot13" class="headerlink" title="safer-than-rot13"></a>safer-than-rot13</h2><p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309151154846.png" alt="image-20230309151154846"></p>
<p>词频分析网站<a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a></p>
<p>要小写补上<code>_</code></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309151912073.png" alt="image-20230309151912073"></p>
<h2 id="cr4-poor-rsa"><a href="#cr4-poor-rsa" class="headerlink" title="cr4-poor-rsa"></a>cr4-poor-rsa</h2><p>读取公钥脚本</p>
<p>公钥中有 e,n读取出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key.pub&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = f.read()</span><br><span class="line">pub = RSA.import_key(key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &quot;</span>,e)</span><br></pre></td></tr></table></figure>

<p>因为这里c是未知的,而flag.b64又不知道怎么打开,</p>
<p>好吧原来是代码写错了,是可以解开的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">n =  <span class="number">833810193564967701912362955539789451139872863794534923259743419423089229206473091408403560311191545764221310666338878019</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">p=<span class="number">863653476616376575308866344984576466644942572246900013156919</span></span><br><span class="line">q=<span class="number">965445304326998194798282228842484732438457170595999523426901</span></span><br><span class="line"></span><br><span class="line">phi=(q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">key = rsa.PrivateKey(n, e, d, p, q)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.b64&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line">    c = base64.b64decode(f)</span><br><span class="line">flag = rsa.decrypt(c, key).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="crypto垃圾邮件"><a href="#crypto垃圾邮件" class="headerlink" title="crypto垃圾邮件"></a>crypto垃圾邮件</h2><p>还真有垃圾邮件解密网站</p>
<h2 id="cat’s-gift"><a href="#cat’s-gift" class="headerlink" title="cat’s gift"></a>cat’s gift</h2><p>莱布尼兹π的莱布尼兹公式。</p>
<p><img src="https://pics4.baidu.com/feed/8d5494eef01f3a29ebf482c6810cea375c607cad.jpeg@f_auto?token=4e965bf2ab2b44ff7c3f797199f2b791&s=5AAC3C62C5F748331A7514CA0000E0B1" alt="img"></p>
<p>欧拉研究出的</p>
<p><img src="https://pics2.baidu.com/feed/b90e7bec54e736d1f6eefe05907919c4d46269e9.jpeg@f_auto?token=97508122bb1d593ed5104859fedfd82c&s=49243D728DA15D135E4144D2030080B1" alt="img"></p>
<p>根据脚本算出的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gift</span>(<span class="params">n=<span class="number">100</span></span>):</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        a += (-<span class="number">1</span>) ** i * <span class="number">1</span> / (<span class="number">2</span> * i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> a * <span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(gift(n=<span class="number">1000000</span>))</span><br><span class="line"><span class="comment">#3.1415916535897743</span></span><br></pre></td></tr></table></figure>

<p>就是π了</p>
<p>找个谐音还是事物的英语</p>
<p><em>pie</em></p>
<h3 id="二元一次方程"><a href="#二元一次方程" class="headerlink" title="二元一次方程"></a>二元一次方程</h3><p>还是第一次用python解一元二次方程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义已知条件</span></span><br><span class="line">eq1 = q * p - <span class="number">5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601</span></span><br><span class="line">eq2 = q + p - <span class="number">151271785827179519090153916262079069437668895377847660065517418507884817445750</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解方程组</span></span><br><span class="line">sol = solve((eq1, eq2), (p, q))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> sol:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;此方程组没有解。&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">len</span>(sol) &lt; <span class="number">2</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;找到的解不足两个。&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, sol[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, sol[<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601</span></span><br><span class="line">avg = <span class="number">75635892913589759545076958131039534718834447688923830032758709253942408722875</span></span><br><span class="line">c = <span class="number">888629627089650993173073530112503758717074884215641346688043288414489462472394318700014742820213053802180975816089493243275025049174955385229062207064503</span></span><br><span class="line">q= <span class="number">71087768052593510372666084538192216997254291933607002714885530754163087727843</span></span><br><span class="line">p= <span class="number">80184017774586008717487831723886852440414603444240657350631887753721729717907</span></span><br><span class="line">phi=(q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d= gmpy2.invert(e,phi)</span><br><span class="line">m= gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="built_in">print</span>(<span class="number">2</span>*avg)</span><br></pre></td></tr></table></figure>

<h2 id="babyFibo"><a href="#babyFibo" class="headerlink" title="babyFibo"></a>babyFibo</h2><p>已知c,s   <code>c = m^s</code></p>
<p>可以通过再次异或得到m</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">s=43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875</span><br><span class="line">c=43104378128345818181217961835377190975779804452524643191544804229536124095677294719566215359919831933542699064892141754715180028183150724886016542388159082125737677224886528142312511700711365919689756090950704</span><br><span class="line">m = c ^ s</span><br><span class="line">m = libnum.n2s(m)</span><br><span class="line"></span><br><span class="line">print(m)</span><br><span class="line">#b&#x27;HSCTF&#123;1d9cb42f-3302-46f3-a3a7-0ca30d631cc9&#125;\xf4\x8d\xc1\x8a\x86W\xeb\xe5&#123;4\xce\xa0\xddY\xa6\xb6@\x03\x82\x0e\xdc\xc2WbBn\x88\x9a\xc5]\xa4\x07S@\xa1u\xde\x11\xcdw\x91\x84&#123;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#b&#x27;8OcTbAfL6/kOMQnC9v8SNmmSzvQMeGTT8vANM1T+7vIce2fo0fc2RnScrNxTSmeSyuMjMF//w8BWaXX91dsGcnvmreg0NQTw96ceVVXj3sQ3Znn51OU1S0bOyaMtNHTj36AcWFqewN4zRUXD6agGbAPE+tQtd3XG0doAa1Ll9fhcQ1zk0McTM1bv8PIQOAnn3vQ3UgLD3PsONXLs4KkXMnjTyMEQOFn/0uYVUwOY1PsleEHCyNopRVDr+Kc0e2PH9v0XNXfprfIPU3nw7KYTNX/G7twLSkHoyaUlQHXi3v02UHmdy/4iNgme3Pc8bgPp+tYWV1+YzPkXYkXM4ulUc27DrM4SNUPT2fQlckj1qP4Fal+YoPYJMlyZ8qhXfF3Y0tUDdUXl3vg0dFTi++VVOFfH/dgMS1ru9N8WU0HF9cUCTgPe+qVdSn/u7Mkda0GTw/QDcWPZ9KYGN2jSzfk0OVrMzt0yRHD64KMrUgPF2sFWcmP56KZSTAD61PUGeXrd49MgU1bL8OsVNWj91vIsalXwqf0qaWbwzv0lWETA4eElS3L99cYmU1nv9dRQTWbDyclScQTN6NIhV2j//+ZWbH7Z68kwM3Dy4dcUc1PQy8kRTl/4zcU9WGWfoakOMXuf69MXZQTEz+kJT1Dar8UN&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="Xor很心疼你"><a href="#Xor很心疼你" class="headerlink" title="Xor很心疼你"></a>Xor很心疼你</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># b&#x27;8OcTbAfL6/kOMQnC9v8SNmmSzvQMeGTT8vANM1T+7vIce2fo0fc2RnScrNxTSmeSyuMjMF//w8BWaXX91dsGcnvmreg0NQTw96ceVVXj3sQ3Znn51OU1S0bOyaMtNHTj36AcWFqewN4zRUXD6agGbAPE+tQtd3XG0doAa1Ll9fhcQ1zk0McTM1bv8PIQOAnn3vQ3UgLD3PsONXLs4KkXMnjTyMEQOFn/0uYVUwOY1PsleEHCyNopRVDr+Kc0e2PH9v0XNXfprfIPU3nw7KYTNX/G7twLSkHoyaUlQHXi3v02UHmdy/4iNgme3Pc8bgPp+tYWV1+YzPkXYkXM4ulUc27DrM4SNUPT2fQlckj1qP4Fal+YoPYJMlyZ8qhXfF3Y0tUDdUXl3vg0dFTi++VVOFfH/dgMS1ru9N8WU0HF9cUCTgPe+qVdSn/u7Mkda0GTw/QDcWPZ9KYGN2jSzfk0OVrMzt0yRHD64KMrUgPF2sFWcmP56KZSTAD61PUGeXrd49MgU1bL8OsVNWj91vIsalXwqf0qaWbwzv0lWETA4eElS3L99cYmU1nv9dRQTWbDyclScQTN6NIhV2j//+ZWbH7Z68kwM3Dy4dcUc1PQy8kRTl/4zcU9WGWfoakOMXuf69MXZQTEz+kJT1Dar8UN&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">解题.py</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">pool = <span class="string">&#x27;qwertyuiopasdfghjklzxcvbnm1234567890QWERTYUIOPASDFGHJKLZXCVBNM&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;hsctf&#123;&#x27;</span></span><br><span class="line">enc=<span class="string">b&#x27;8OcTbAfL6/kOMQnC9v8SNmmSzvQMeGTT8vANM1T+7vIce2fo0fc2RnScrNxTSmeSyuMjMF//w8BWaXX91dsGcnvmreg0NQTw96ceVVXj3sQ3Znn51OU1S0bOyaMtNHTj36AcWFqewN4zRUXD6agGbAPE+tQtd3XG0doAa1Ll9fhcQ1zk0McTM1bv8PIQOAnn3vQ3UgLD3PsONXLs4KkXMnjTyMEQOFn/0uYVUwOY1PsleEHCyNopRVDr+Kc0e2PH9v0XNXfprfIPU3nw7KYTNX/G7twLSkHoyaUlQHXi3v02UHmdy/4iNgme3Pc8bgPp+tYWV1+YzPkXYkXM4ulUc27DrM4SNUPT2fQlckj1qP4Fal+YoPYJMlyZ8qhXfF3Y0tUDdUXl3vg0dFTi++VVOFfH/dgMS1ru9N8WU0HF9cUCTgPe+qVdSn/u7Mkda0GTw/QDcWPZ9KYGN2jSzfk0OVrMzt0yRHD64KMrUgPF2sFWcmP56KZSTAD61PUGeXrd49MgU1bL8OsVNWj91vIsalXwqf0qaWbwzv0lWETA4eElS3L99cYmU1nv9dRQTWbDyclScQTN6NIhV2j//+ZWbH7Z68kwM3Dy4dcUc1PQy8kRTl/4zcU9WGWfoakOMXuf69MXZQTEz+kJT1Dar8UN&#x27;</span></span><br><span class="line"></span><br><span class="line">enc = base64.b64decode(enc)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">length</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choices(pool, k=length))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    random.seed(x)</span><br><span class="line">    <span class="keyword">return</span> random.getrandbits(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    plaintext = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>, plaintext))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">        key = f(key)</span><br><span class="line">        tmp = (key * r) % <span class="number">251</span></span><br><span class="line">        <span class="comment">#assert tmp != 0 and key != 0</span></span><br><span class="line">        plaintext[i] = plaintext[i] ^ tmp</span><br><span class="line">    plaintext = <span class="built_in">bytes</span>(plaintext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">enc,key</span>):</span><br><span class="line">    enc = <span class="built_in">list</span>(enc)</span><br><span class="line">    <span class="comment"># key = f(key)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        key = f(key)</span><br><span class="line">        tmp = (key * r) % <span class="number">251</span></span><br><span class="line">        <span class="comment">#assert tmp != 0 and key != 0</span></span><br><span class="line">        enc[i] = enc[i] ^ tmp</span><br><span class="line">    enc = <span class="built_in">bytes</span>(enc)</span><br><span class="line">    <span class="built_in">print</span>(enc)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">251</span>):</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">        m = flag</span><br><span class="line">        c = encrypt(m, key)</span><br><span class="line">        <span class="keyword">if</span>(c <span class="keyword">in</span> enc):</span><br><span class="line">            <span class="built_in">print</span>(r)</span><br><span class="line">            <span class="built_in">print</span>(key)</span><br><span class="line">            <span class="built_in">print</span>(c)</span><br><span class="line">            <span class="built_in">print</span>(enc.index(c))</span><br><span class="line">r=<span class="number">187</span></span><br><span class="line">key=<span class="number">34</span></span><br><span class="line">mm = decrypt(enc[<span class="number">247</span>:],key)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br></pre></td></tr></table></figure>

<p>直接找的WP</p>
<p>核心部分在我看是这里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">for r in range(2,251):</span><br><span class="line">    for key in range(1,256):</span><br><span class="line">        m = flag</span><br><span class="line">        c = encrypt(m, key)</span><br><span class="line">        if(c in enc):</span><br><span class="line">            print(r)</span><br><span class="line">            print(key)</span><br><span class="line">            print(c)</span><br><span class="line">            print(enc.index(c))</span><br></pre></td></tr></table></figure>

<p>通过爆破的方式,求出r,key,与flag所在位置,因为加密代码中虽然有两个循环,但是他最终是有一个确定的r与key值的</p>
<h2 id="中等偏下-线性反馈移位寄存器"><a href="#中等偏下-线性反馈移位寄存器" class="headerlink" title="[中等偏下] 线性反馈移位寄存器"></a>[中等偏下] 线性反馈移位寄存器</h2><p>这个与之前那个LFSR类似,但是还是不会做,且看WP</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/figfig55/article/details/128632051">https://blog.csdn.net/figfig55/article/details/128632051</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from secret import secret</span><br><span class="line">for b in secret: assert(b == &#x27;0&#x27; or b == &#x27;1&#x27;)</span><br><span class="line">assert(len(secret) == 128)</span><br><span class="line"># a 01 string with length 128</span><br><span class="line"># your flag is flag&#123;md5(secret).hexdigest()&#125;</span><br><span class="line"></span><br><span class="line">def string2bits(s):</span><br><span class="line">    return [int(b) for b in s]</span><br><span class="line"></span><br><span class="line">def bits2string(bs):</span><br><span class="line">    s = [str(b) for b in bs]</span><br><span class="line">    return &#x27;&#x27;.join(s)</span><br><span class="line"></span><br><span class="line">def lfsr(state, mask):</span><br><span class="line">    assert(len(state) == 128)</span><br><span class="line">    assert(len(mask)  == 128)</span><br><span class="line"></span><br><span class="line">    output = 0</span><br><span class="line">    for i in range(128):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    return output</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    initState = [0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0]</span><br><span class="line">    mask = string2bits(secret)</span><br><span class="line"></span><br><span class="line">    for i in range(256):</span><br><span class="line">        state = initState[i:]</span><br><span class="line">        output = lfsr(state, mask)</span><br><span class="line">        initState += [output]</span><br><span class="line"></span><br><span class="line">    outputState = bits2string(initState[128:])</span><br><span class="line">    print(&#x27;outputState =&#x27;, outputState)</span><br><span class="line">    #</span><br><span class="line">    # outputState = 1010100001001011101000000100100001101011010100101011010101011010100100001110010010110111010111110000000000011011001110100011000111110100110011011011100111000000001100001000001011010011011010110110111100110101001110001001001000001110111011110001111001111111</span><br><span class="line">    #</span><br></pre></td></tr></table></figure>

<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309231629359.png" alt="image-20230309231629359"></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309231809137.png" alt="image-20230309231809137"></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230309232119418.png" alt="image-20230309232119418"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    outputState = string2bits(<span class="string">&#x27;1010100001001011101000000100100001101011010100101011010101011010100100001110010010110111010111110000000000011011001110100011000111110100110011011011100111000000001100001000001011010011011010110110111100110101001110001001001000001110111011110001111001111111&#x27;</span>)</span><br><span class="line">    states = initState + outputState</span><br><span class="line">    </span><br><span class="line">    ms = MatrixSpace(GF(<span class="number">2</span>), <span class="number">128</span>, <span class="number">128</span>)<span class="comment">#一个矩阵</span></span><br><span class="line">    mv = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        mv += states[i : i + <span class="number">128</span>]</span><br><span class="line">    m= ms(mv)</span><br><span class="line">    </span><br><span class="line">    vs = MatrixSpace(GF(<span class="number">2</span>), <span class="number">128</span>, <span class="number">1</span>)<span class="comment">#一个矩阵</span></span><br><span class="line">    vv = outputState[<span class="number">0</span>:<span class="number">128</span>]</span><br><span class="line">    v = vs(vv)</span><br><span class="line">    </span><br><span class="line">    secret = m.inverse() * v</span><br><span class="line">    M=secret.<span class="built_in">str</span>().replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="转轮机加密"><a href="#转轮机加密" class="headerlink" title="转轮机加密"></a>转轮机加密</h2><p>托马斯·杰斐逊- 轮转密码题</p>
<p>拿的别人的脚本稍微改了一下.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/12 8:52</span></span><br><span class="line"><span class="comment"># 秘钥</span></span><br><span class="line">key = <span class="string">&quot;2,3,7,5,13,12,9,1,8,10,4,11,6&quot;</span></span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line">cipher_text = <span class="string">&quot;NFQKSEVOQOFNP&quot;</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>)</span><br><span class="line">str_first_encry = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    line = line.strip()</span><br><span class="line">    str_first_encry.append(line)</span><br><span class="line"></span><br><span class="line">key_index = key.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">str_second_encry = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> key_index:</span><br><span class="line">    str_second_encry.append(str_first_encry[<span class="built_in">int</span>(k) - <span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(str_first_encry[<span class="built_in">int</span>(k) - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_text):</span><br><span class="line">    line = str_second_encry[i]</span><br><span class="line">    split_index = line.index(ch)</span><br><span class="line">    temp = []</span><br><span class="line">    temp[<span class="number">0</span>:<span class="built_in">len</span>(line) - split_index + <span class="number">1</span>] = line[split_index:<span class="built_in">len</span>(line)]</span><br><span class="line">    temp[<span class="built_in">len</span>(temp):] = line[<span class="number">0</span>:split_index]</span><br><span class="line">    str_second_encry[i] = <span class="string">&quot;&quot;</span>.join(temp)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-------------------------------------&quot;</span>)</span><br><span class="line">flag = []</span><br><span class="line">g=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> plain <span class="keyword">in</span> str_second_encry:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;第&#123;&#125;列: &#x27;</span>.<span class="built_in">format</span>(g), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br><span class="line">    g += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-------------------------------------&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_second_encry[<span class="number">0</span>])):</span><br><span class="line">    ans = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">        ans += str_second_encry[j][i]</span><br><span class="line">    flag.append(ans.lower())</span><br><span class="line"></span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> ans <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;第&#123;&#125;列: &#x27;</span>.<span class="built_in">format</span>(k),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>.lower(ans))</span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="best-rsa"><a href="#best-rsa" class="headerlink" title="best_rsa"></a>best_rsa</h2><p>共模攻击-扩展欧几里得算法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import binascii</span><br><span class="line">n=13060424286033164731705267935214411273739909173486948413518022752305313862238166593214772698793487761875251030423516993519714215306808677724104692474199215119387725741906071553437840256786220484582884693286140537492541093086953005486704542435188521724013251087887351409946184501295224744819621937322469140771245380081663560150133162692174498642474588168444167533621259824640599530052827878558481036155222733986179487577693360697390152370901746112653758338456083440878726007229307830037808681050302990411238666727608253452573696904083133866093791985565118032742893247076947480766837941319251901579605233916076425572961</span><br><span class="line">e1=117</span><br><span class="line">e2=65537</span><br><span class="line">c1=12847007370626420814721007824489512747227554004777043129889885590168327306344216253180822558098466760014640870748287016523828261890262210883613336704768182861075014368378609414255982179769686582365219477657474948548886794807999952780840981021935733984348055642003116386939014004620914273840048061796063413641936754525374790951194617245627213219302958968018227701794987747717299752986500496848787979475798026065928167197152995841747840050028417539459383280735124229789952859434480746623573241061465550303008478730140898740745999035563599134667708753457211761969806278000126462918788457707098665612496454640616155477050</span><br><span class="line">c2=6830857661703156598973433617055045803277004274287300997634648800448233655756498070693597839856021431269237565020303935757530559600152306154376778437832503465744084633164767864997303080852153757211172394903940863225981142502888126928982009493972076013486758460894416710122811249903322437742241269681934551237431668187006176418124934488775505816544733929241927900392924886649420943699356314278255683484998359663404611236056664149725644051300950988495549164517140159041907329062655574220869612072289849679613024196448446224406889484578310512232665571188351621585528255501546941332782446448144033997067917984719103068519</span><br><span class="line">d = gmpy2.gcdext(e1,e2)#扩展欧几里得算法</span><br><span class="line">m1 = gmpy2.powmod(c1,d[1],n)</span><br><span class="line">m2 = gmpy2.powmod(c2,d[2],n)</span><br><span class="line">m = (m1*m2)%n</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="RSA-gcd"><a href="#RSA-gcd" class="headerlink" title="RSA_gcd"></a>RSA_gcd</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line">phi_1=(q1-1)*(p-1)</span><br><span class="line">phi_2=(q2-1)*(p-1)</span><br><span class="line">d1=gmpy2.invert(e,phi_1)</span><br><span class="line">d2=gmpy2.invert(e,phi_2)</span><br><span class="line">m1=pow(c1,d1,n1)</span><br><span class="line">m2=pow(c2,d2,n2)</span><br><span class="line">print(libnum.n2s(int(m1)))</span><br><span class="line">print(libnum.n2s(int(m2)))</span><br></pre></td></tr></table></figure>

<h2 id="shanghai"><a href="#shanghai" class="headerlink" title="shanghai"></a>shanghai</h2><p>维吉利亚密码</p>
<h2 id="OldDriver"><a href="#OldDriver" class="headerlink" title="OldDriver"></a>OldDriver</h2><p>低加密指数广播攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from functools import reduce</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">e=10</span><br><span class="line">c=[7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042,</span><br><span class="line">   21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461,</span><br><span class="line">   6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983,</span><br><span class="line">   4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052,</span><br><span class="line">   22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672,</span><br><span class="line">   17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087,</span><br><span class="line">   1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639,</span><br><span class="line">   15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352,</span><br><span class="line">   8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797,</span><br><span class="line">   13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247]</span><br><span class="line">n = [25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803,</span><br><span class="line">     23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193,</span><br><span class="line">     18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623,</span><br><span class="line">     23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723,</span><br><span class="line">     31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493,</span><br><span class="line">     22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949,</span><br><span class="line">     25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043,</span><br><span class="line">     32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047,</span><br><span class="line">     52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553,</span><br><span class="line">     30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621]</span><br><span class="line"></span><br><span class="line"># 中国剩余定理</span><br><span class="line">def CRT(cipher, n):</span><br><span class="line">    N = reduce(lambda x, y: x * y, (i for i in n))#N = reduce(lambda x, y: x * y, (i for i in n))</span><br><span class="line">    print(N)</span><br><span class="line">    result = 0</span><br><span class="line">    data = zip(cipher, n)</span><br><span class="line">    for ci, ni in data:</span><br><span class="line">        Ni = N // ni#将N除以ni并向下取整，得到整数商Ni。</span><br><span class="line">        di = gmpy2.invert(Ni, ni)</span><br><span class="line">        result += ci * Ni * di</span><br><span class="line">    return result % N, N</span><br><span class="line">x, N = CRT(c, n)</span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(gmpy2.mpz(x), e)[0]</span><br><span class="line"></span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="easychallenge-1"><a href="#easychallenge-1" class="headerlink" title="easychallenge"></a>easychallenge</h2><p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230312114511338.png" alt="image-20230312114511338"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># uncompyle6 version 3.9.0</span><br><span class="line"># Python bytecode version base 2.7 (62211)</span><br><span class="line"># Decompiled from: Python 3.8.7 (tags/v3.8.7:6503f05, Dec 21 2020, 17:59:51) [MSC v.1928 64 bit (AMD64)]</span><br><span class="line"># Embedded file name: ans.py</span><br><span class="line"># Compiled at: 2018-08-09 11:29:44</span><br><span class="line">import base64</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">def decode1(final):</span><br><span class="line">    s = &#x27;&#x27;</span><br><span class="line">    for i in final:</span><br><span class="line">        x = ord(i) - 25</span><br><span class="line">        x = x ^ 36</span><br><span class="line">        s += chr(x)</span><br><span class="line">    return s</span><br><span class="line">def decode2(final):</span><br><span class="line">    s=&#x27;&#x27;</span><br><span class="line">    for i in final:</span><br><span class="line">        x = i^ 36</span><br><span class="line">        x = x - 36</span><br><span class="line">        s += chr(x)</span><br><span class="line">    return s</span><br><span class="line">def decode3(final):</span><br><span class="line">    return base64.b32decode(final)</span><br><span class="line">final=&#x27;UC7KOWVXWVNKNIC2XCXKHKK2W5NLBKNOUOSK3LNNVWW3E===&#x27;</span><br><span class="line"></span><br><span class="line">flag=decode1(decode2(decode3(final)))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Decrypt-the-Message"><a href="#Decrypt-the-Message" class="headerlink" title="Decrypt-the-Message"></a>Decrypt-the-Message</h2><h3 id="Poem-Codes"><a href="#Poem-Codes" class="headerlink" title="Poem Codes"></a>Poem Codes</h3><p>Poem Code 最显著的特点就是一首诗歌。</p>
<h4 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h4><p><strong>给出一首诗歌</strong></p>
<blockquote>
<p>for my purpose holds to sail beyond the sunset, and the baths of all the western stars until I die.</p>
</blockquote>
<p><strong>给出5个关键单词。</strong></p>
<blockquote>
<p>“for”, “sail”, “all”, “stars”, “die.”</p>
<p>对其进行拆散：</p>
<p>f o r s a i l a l l s t a r s d i e</p>
<p>接下来按照 字母表顺序 进行编号，若遇相同字母，则继续 +1</p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>f</strong></th>
<th><strong>o</strong></th>
<th><strong>r</strong></th>
<th><strong>s</strong></th>
<th><strong>a</strong></th>
<th><strong>i</strong></th>
<th><strong>l</strong></th>
<th><strong>a</strong></th>
</tr>
</thead>
<tbody><tr>
<td>6</td>
<td>12</td>
<td>13</td>
<td>15</td>
<td>1</td>
<td>7</td>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td><strong>l</strong></td>
<td><strong>l</strong></td>
<td><strong>s</strong></td>
<td><strong>t</strong></td>
<td><strong>a</strong></td>
<td><strong>r</strong></td>
<td><strong>s</strong></td>
<td><strong>d</strong></td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>16</td>
<td>18</td>
<td>3</td>
<td>14</td>
<td>17</td>
<td>4</td>
</tr>
<tr>
<td><strong>i</strong></td>
<td><strong>e</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>5</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<blockquote>
<p>We have run out of cigars, situation desperate。</p>
</blockquote>
<p>先对对其进行编码。因为给出的5个关键词，其长度为18.所以以18为一组。</p>
<p>若一组长度不满18，则用abc(不要求有序)进行补充。<img src="https://img-blog.csdnimg.cn/2020081519575793.png#pic_center" alt="img"></p>
<p>将排好的消息，按照之前给出的诗歌字母编号写下密文。</p>
<p>for my purpose holds to sail beyond the sunset, and the baths of all the western stars until I die.</p>
<p>如， for –&gt; eud tdk oek 那么得到的又可以按照5个（适当个数）为一组进行重新分组，得到最后密文。</p>
<p>————————————————<br>版权声明：本文为CSDN博主「J1ay」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45530599/article/details/108027293">https://blog.csdn.net/weixin_45530599/article/details/108027293</a></p>
<h4 id="审题解题"><a href="#审题解题" class="headerlink" title="审题解题"></a>审题解题</h4><p>首先我们得到一首诗歌</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">The life that I have</span><br><span class="line">Is all that I have</span><br><span class="line">And the life that I have</span><br><span class="line">Is yours.</span><br><span class="line"></span><br><span class="line">The love that I have</span><br><span class="line">Of the life that I have</span><br><span class="line">Is yours and yours and yours.</span><br><span class="line"></span><br><span class="line">A sleep I shall have</span><br><span class="line">A rest I shall have</span><br><span class="line">Yet death will be but a pause.</span><br><span class="line"></span><br><span class="line">For the peace of my years</span><br><span class="line">In the long green grass</span><br><span class="line">Will be yours and yours and yours.</span><br></pre></td></tr></table></figure>

<p>以及 <code>decrypted message</code> （解密消息）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emzcf sebt yuwi ytrr ortl rbon aluo konf ihye cyog rowh prhj feom ihos perp twnb tpak heoc yaui usoa irtd tnlu ntke onds goym hmpq</span><br></pre></td></tr></table></figure>

<h4 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h4><p>已知原理，我们可以运用网上大佬的 <a target="_blank" rel="noopener" href="https://github.com/abpolym/crypto-tools/tree/master/poemcode">解密工具</a> ，：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python poem.py poem msg</span><br></pre></td></tr></table></figure>

<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230312123306855.png" alt="image-20230312123306855"></p>
<h2 id="ecb-it’s-easy-as-123"><a href="#ecb-it’s-easy-as-123" class="headerlink" title="ecb,_it’s_easy_as_123"></a>ecb,_it’s_easy_as_123</h2><p>只有一个cry300放到winhex里面看看</p>
<p><code>504B0304</code>是zip文件头</p>
<p>解压得到<code>ecb.bmp</code>和<code>task.txt</code></p>
<p>BMP文件实际上不是有效的图像文件，因为它是加密的。它的前几个字节很有趣：加salt __前缀表示此文件<code>OpenSSL</code>加密的OpenSSL解码。紧接着8个字节(Ab31b5e5ca 3db94d)是用于加密文件的salt 。文件的其余部分是加密数据。</p>
<h3 id="原因分析："><a href="#原因分析：" class="headerlink" title="原因分析："></a>原因分析：</h3><p>因为标题和任务描述中有一些提示：ECB-ECB加密对于图像来说是出了名的不好，因为相同的明文块产生相同的密文。4K分辨率-这告诉我们图像要么是3840×2160像素，要么是4096×2160像素。黑白-我们很可能会看到很多只有白色的积木。</p>
<p>所以，考虑到这一点，让我们来看看十六进制转储：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Bash$xxd ecb.bmp|head-n 13 0000000：5361 6c74 6564 5f5f ab31 b5e5 </span><br><span class="line">ca3d b94d Salted__1...=.m 0000010：f409 1aa5 df88 b72c 0ebd 8a73 </span><br><span class="line">9815 ba69.，...s...i 0000020：a224 3e09 94cb 791e ea1 ad33 c817 </span><br><span class="line">6663.$&gt;...y...3.fc。0000040：fcd8 8e3d 452a 99b0 536b 500d 8a3d </span><br><span class="line">c4b7...=E*..SKP..=..。0000050：629c 6a54 f059 2013年224f b6e2 b6aa </span><br><span class="line">0a8b b.jT.Y.“O.。0000060：5e21 1a9d cf8c a2f6 4580 cb9b B737 </span><br><span class="line">da7f^！.E....7.。0000070：7350 88cb df63 ee22 d424 b3b9 f424 ad40 </span><br><span class="line">sp...c.“.$...$.@0000080：2F09 e681 9bb5 1388 01fa 0a47 7809 </span><br><span class="line">6523/.Gx.e#0000090：323f 8b1e b820 9c99 fcb5 4601 0bc9 4134 </span><br><span class="line">2？......f...a4 00000a0：323f 8b1e b820 923。F...A4 00000c0：323F </span><br><span class="line">8b1e b820 9c99 fcb5 4601 0bc9 4134 2？......F...A4。</span><br></pre></td></tr></table></figure>

<p>查阅wp后才发现，只需要改动文件头128位即可</p>
<p>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/12 13:25</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ecb.bmp&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read()</span><br><span class="line">pre = <span class="number">0x424d76483f00000000007600000028000000000f000070080000010004000000000000483f00000000000000000000000000000000000000000000008000008000000080800080000000800080008080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00ffff0000ffffff00ffffffffffffffffffff</span></span><br><span class="line"><span class="comment">#pre=0x424d76483f00000000007600000028000000000f000070080000010004000000000000483f00000000000000000000000000000000000000000000008000008000000080800080000000800080008080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00ffff0000ffffff00ffffffffffffffffffffL</span></span><br><span class="line">out=long_to_bytes(pre)+data[<span class="number">128</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.bmp&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">    g.write(out)</span><br></pre></td></tr></table></figure>

<p>还有一个更好的解决方案。我们只需删除前16个字节(Salted__和Salt)，然后用有效的BMP报头替换密文中的前几个字节。这是可行的，因为BMP存储原始数据，我们不会得到无效的块。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Bash$xxd sample.bmp|head-n 8 0000000：424d 7648 3f00 0000 0000 7600 </span><br><span class="line">0000 2800 bmvh？.v.。0000010：00000 000f 0000 7008 0000 0100 0400 </span><br><span class="line">0000.页.。0000020：0000 0048 3f00 0000 0000 0000...H？.。0000030：</span><br><span class="line">0000 0000 0000 8000 0080.。0000040：0000 0080 8000 8000 0000 8000 </span><br><span class="line">8000 8080.。0000050：0000 8080 8000 c0c0 c000 0000 ff00 00ff.。</span><br><span class="line">0000060：0000 00ff ff00 ff00 0000 ff00 ff00 ffff.。0000070：0000ffff </span><br><span class="line">ff00 ffff.。</span><br></pre></td></tr></table></figure>

<h2 id="enc"><a href="#enc" class="headerlink" title="enc"></a>enc</h2><p>解到</p>
<p>ALEXCTFTH15O1SO5UP3RO5ECR3TOTXT就不会了</p>
<p>要改为这种形式</p>
<p>ALEXCTF{TH15_1S_5UP3R_5ECR3T_TXT}</p>
<h2 id="wtc-rsa-bbq"><a href="#wtc-rsa-bbq" class="headerlink" title="wtc_rsa_bbq"></a>wtc_rsa_bbq</h2><p>读出两个文件信息后,还要再次读取信息内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/12 15:01</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x62D3D61C92452630147E89670FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = (<span class="number">2</span>**<span class="number">4244</span>)*<span class="number">699549860111847</span>+<span class="number">1</span></span><br><span class="line">q = (<span class="number">2</span>**<span class="number">4244</span>)*<span class="number">699549860111847</span>-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, Phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;cipher.bin&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = bytes_to_long(file.read())</span><br><span class="line">    res = long_to_bytes(<span class="built_in">pow</span>(data, d, n)).decode()</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>使用工具<a target="_blank" rel="noopener" href="https://github.com/Ganapati/RsaCtfTool">RSACTFTool</a>进行分解,将key.pem与cipher.bin移到与RsaCtfTool.py同目录下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 RsaCtfTool.py --publickey key.pem --uncipherfile cipher.bin --attack fermat</span><br><span class="line">python RsaCtfTool.py --publickey key.pem --uncipherfile cipher.bin --attack fermat</span><br><span class="line"><span class="comment">#只有这个可以</span></span><br><span class="line">python3 ./RsaCtfTool.py -n 135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789 -e 65537 --uncipher 110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span><br></pre></td></tr></table></figure>

<h2 id="工业协议分析1"><a href="#工业协议分析1" class="headerlink" title="工业协议分析1"></a>工业协议分析1</h2><p>找到最长的一条<img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230312163214712.png" alt="image-20230312163214712"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">&quot;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&quot;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;img.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(base64.b64decode(data))</span><br></pre></td></tr></table></figure>

<h2 id="简单流量分析"><a href="#简单流量分析" class="headerlink" title="简单流量分析"></a>简单流量分析</h2><p>流量分析题，分析的方法基本上有：binwalk、查找一些可疑字符串或16进制数据，排序流量包的长度(最长的流量包一般很可疑)；当我们对流量包的长度进行排序时，发现流量包最短90字节，最长也不过164字节，其中的data段数据长度从48到122，而ascii表中第48至122个字符为0123456789:;&lt;&#x3D;&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_&#96;abcdefghijklmnopqrstuvwxyz，于是将每个流量包的长度转换为对应字符，然后连接成一段长字符串，看上去像base64编码，对字符串进行base64解码即可!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -r 1.pcap | awk -F &#x27; &#x27; &#x27;&#123;print $14&#125;&#x27; &gt; 1.txt</span><br><span class="line">用这个命令将pcap里的长度字段找出来</span><br><span class="line">不知道什么情况,取出来的长度有重复的...还是去看了,官方WP,虽说耗时有点久了,但好在安装好了环境,</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># coding=utf8</span><br><span class="line">import pyshark</span><br><span class="line">import base64</span><br><span class="line">L_flag= []</span><br><span class="line">packets = pyshark.FileCapture(&#x27;fetus_pcap.pcap&#x27;)</span><br><span class="line">for packet in packets:</span><br><span class="line">    for pkt in packet:</span><br><span class="line">        if pkt.layer_name == &quot;icmp&quot;:</span><br><span class="line">            if int(pkt.type) != 0:</span><br><span class="line">             L_flag.append(int(pkt.data_len))</span><br><span class="line">c=len(L_flag)</span><br><span class="line">for i in range(0,c):</span><br><span class="line">    L_flag[i]=chr(L_flag[i])</span><br><span class="line">print(&#x27;&#x27;.join(L_flag))</span><br><span class="line">print(base64.b64decode(&#x27;&#x27;.join(L_flag)))</span><br><span class="line">#b&#x27;::\\nmongodb:!:17843:0:99999:7:::\\nubuntu:$6$LhHRomTE$M7C4n84UcFLAG&#123;xx2b8a_6mm64c_fsociety&#125;::&#x27;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码使用了 pyshark 库来读取一个名为 fetus_pcap.pcap 的数据包捕获文件。pyshark 是一个基于 tshark 的 Python 数据包分析库，它提供了一种简单的方法来解析和分析捕获文件和实时数据包。这个库可以用于网络分析，协议分析等领域。</p>
<p>这个脚本首先创建了一个空列表 L_flag 来存储数据包中 ICMP 层的 data_len 值，然后利用 pyshark.FileCapture() 函数读取指定的数据包捕获文件。之后，它遍历每个捕获到的数据包，遍历每个数据包的每个协议层。如果发现一个数据包包含 ICMP 层且其类型不是 0，则将该数据包的 data_len 值添加到 L_flag 列表中。</p>
<p>在此之后，代码将列表 L_flag 中的整数转换为相应的 ASCII 字符。最后，它将字符列表传递给 base64.b64decode() 函数，以解码 Base64 编码的字符串，并打印解码后的结果。</p>
</blockquote>
<h2 id="工控安全取证"><a href="#工控安全取证" class="headerlink" title="工控安全取证"></a>工控安全取证</h2><p>下载后是一个capture.log，考虑到都是流量，改成wireshark能识别的后缀，capture.pcapng</p>
<p>打开后发现大量的tcp流量，不难发现，192.168.0.99是靶机，使劲被人攻击。</p>
<p>开始我的策略是手工分析出四个攻击时段的节点，于是就将时间显示格式调整为比较友好的类型，如图：</p>
<p><img src="https://img-blog.csdnimg.cn/20200328180953620.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RjaHVhMTIz,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>想以时间来区分，后来发现图样图森破，时间都很接近，那么多tcp怎么搞。</p>
<p>于是想到了协议</p>
<p>在进行一次连续的tcp之前一般会发一个icmp包过去，把过滤协议设置为icmp</p>
<p>，排序后，发现ICMP协议貌似刚好分成了四段（去掉了不成功的），如下：</p>
<p><img src="https://img-blog.csdnimg.cn/2020032818125045.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RjaHVhMTIz,size_16,color_FFFFFF,t_70" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ICMP&spm=1001.2101.3001.7020">ICMP</a>请求第一组编号有发出也有回显正常的信息，我们认为该次扫描为一次正常的扫描；第二组和第三组同理！！！</p>
<p>第四组为什么是155989？第四次我们可以推测在155987到155990之间。</p>
<p>flag{155989}</p>
<h2 id="fanfie"><a href="#fanfie" class="headerlink" title="fanfie"></a>fanfie</h2><p>参考文章:<a target="_blank" rel="noopener" href="https://blog.csdn.net/l8947943/article/details/123397127">https://blog.csdn.net/l8947943/article/details/123397127</a></p>
<h4 id="1-找到加密信息"><a href="#1-找到加密信息" class="headerlink" title="1. 找到加密信息"></a>1. 找到加密信息</h4><p>题目给出的是一个txt文件，如下字符：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</span><br></pre></td></tr></table></figure>

<p>这个题目最难的是缺少提示，看到都懵了，原题提示有如下：</p>
<blockquote>
<p>任务描述告诉我们标志被转换为base32并以某种方式加密。</p>
</blockquote>
<p>假设明文是这样的：BITSCTF{<em><strong>}，那我们尝试将</strong>BITSCTF</em>*进行加密，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b32encode</span><br><span class="line"></span><br><span class="line">print(b32encode(b&#x27;BITSCTF&#x27;))</span><br></pre></td></tr></table></figure>

<p>加密结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IJEVIU2DKRDA====</span><br></pre></td></tr></table></figure>

<p>对比原始字符，我们选取前一段的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MZYVMIWLGBL7CIJO</span><br><span class="line">IJEVIU2DKRDA====</span><br></pre></td></tr></table></figure>

<p>可以看到M对应I，而且出现了两次，那么我们推测可能是一种单字母替换密码</p>
<p> 找到映射关系<br>我们构造一个简单的字母序表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P  Q  R  S  T  U  V  W  X  Y  Z  2  3  4  5  6  7</span><br><span class="line">0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31</span><br></pre></td></tr></table></figure>


<p>可以发现原始字符和base32加密后的对应索引关系：</p>
<table>
<thead>
<tr>
<th>映射</th>
<th>编号</th>
</tr>
</thead>
<tbody><tr>
<td>M -&gt; I</td>
<td>12 -&gt; 8</td>
</tr>
<tr>
<td>Z -&gt; J</td>
<td>25 -&gt; 9</td>
</tr>
<tr>
<td>Y -&gt; E</td>
<td>24 -&gt; 4</td>
</tr>
<tr>
<td>V -&gt; V</td>
<td>21 -&gt; 21</td>
</tr>
<tr>
<td>I -&gt; U</td>
<td>8 -&gt; 20</td>
</tr>
<tr>
<td>W -&gt; 2</td>
<td>22 -&gt; 26</td>
</tr>
</tbody></table>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230312171501228.png" alt="image-20230312171501228"></p>
<p>什么是仿射密码？<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/2250198?fr=aladdin">参考链接</a></p>
<p>举例第一列，A在原始字母表中的顺序为0，带入函数(13 * 0 + 4) mod 32 &#x3D; 4，在原始字母表中，对应字母E，因此原始字符则有如下对应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI IJEVIU2DKRDHWUZSKZ4VSMTUN5RDEWTNPU</span><br><span class="line">IJEVIU2DKRDHWUZSKZ4VSMTUN5RDEWTNPU======</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b32decode</span><br><span class="line"></span><br><span class="line">def solve():</span><br><span class="line">    s=&#x27;MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI&#x27;</span><br><span class="line">    dic=&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#x27;</span><br><span class="line">    msg=&#x27;&#x27;.join([dic[(5*dic.find(x)+12)%32] for x in s])</span><br><span class="line">    return b32decode(msg+&#x27;=&#x27;*(8-len(msg)%32))</span><br><span class="line"></span><br><span class="line">if __name__==&#x27;__main__&#x27;:</span><br><span class="line">    #python solve.py</span><br><span class="line">    print solve()</span><br></pre></td></tr></table></figure>

<h2 id="simpleRSA"><a href="#simpleRSA" class="headerlink" title="simpleRSA"></a>simpleRSA</h2><p>求E1</p>
<p>由<code>q = next_prime(getPrime(16) * p + 38219)</code>可知，<code>q</code>为<code>p*getPrime(16)+38219</code>的下一个素数，因此<code>getPrime(16)</code>较小，所以我们可以在其取值范围为遍历出符合题目的值,从而解出<code>q</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">for i in range(2 ** 15, 2 ** 16):</span><br><span class="line">    if isPrime(i):</span><br><span class="line">        q = next_prime(i * iroot(n // i, 2)[0] + 38219)</span><br><span class="line">        if n % q == 0:</span><br><span class="line">            print(q)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">p = n // q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">E1 = pow(c, d, n)</span><br><span class="line">print(E1)</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

<p>做到E2就麻了,Crypto先做其他简单的题吧</p>
<h2 id="onetimepad"><a href="#onetimepad" class="headerlink" title="onetimepad"></a>onetimepad</h2><p>Crypto先到这里吧</p>
<h2 id="cr2-many-time-secrets"><a href="#cr2-many-time-secrets" class="headerlink" title="cr2-many-time-secrets"></a>cr2-many-time-secrets</h2><p>尝试了几个编码不行</p>
<p>题目中提示是One Time Pad的重用导致的攻击。</p>
<p>一次性密码本 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/One-time_pad">one-time pad</a>（OTP）：</p>
<ul>
<li><code>key</code>的长度大于等于<code>message</code></li>
<li><code>key</code>必须是一次性的，且每次都要随机产生</li>
</ul>
<p>满足上述两个条件，即称为 OTP</p>
<blockquote>
<p>异或加密特性</p>
<ul>
<li>两个值相同时,返回flase,否则返回true</li>
<li>如果对一个值连续做两次XOR,会返回这个值本身.</li>
<li>假设原始信息是<code>message</code>，密钥是<code>key</code>，第一次 XOR 会得到加密文本<code>cipherText</code>。对方拿到以后，再用<code>key</code>做一次 XOR 运算，就会还原得到<code>message</code>。</li>
</ul>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_26227857/article/details/44488465">加密101-异或（xor）</a><br>工具<br><a target="_blank" rel="noopener" href="https://github.com/SpiderLabs/cribdrag">https://github.com/SpiderLabs/cribdrag</a></p>
<p>简单来说呢，就是利用一些用同个密钥生成的密文，猜对其中部分密文对应的明文，即可求出公共密钥，再用该可能的密钥去解其他的密文，若符合，则为密钥正确。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python cribdrag.py 0529242a631234122d2b36697f13272c207f2021283a6b0c79082f28202a302029142c653f3c7f2a2636273e3f2d653e25217908322921780c3a235b3c2c3f207f372e21733a3a2b37263b3130122f6c363b2b312b1e64651b6537222e37377f2020242b6b2c2d5d283f652c2b31661426292b653a292c372a2f20212a316b283c0929232178373c270f682c216532263b2d3632353c2c3c2a293504613c37373531285b3c2a72273a67212a277f373a243c20203d5d243a202a633d205b3c2d3765342236653a2c7423202f3f652a182239373d6f740a1e3c651f207f2c212a247f3d2e65262430791c263e203d63232f0f20653f207f332065262c31683137223679182f2f372133202f142665212637222220733e383f2426386b</span><br></pre></td></tr></table></figure>

<p>历时3个小时终于把这个脚本或者说python2的环境有搞好了.</p>
<p>若是明文中的则是message</p>
<p>若是flag则为key</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230313231929145.png" alt="image-20230313231929145"></p>
<p><code>ALEXCTF&#123;</code>是key</p>
<p>一点一点猜测下面的内容</p>
<h2 id="Decode-The-File"><a href="#Decode-The-File" class="headerlink" title="Decode_The_File"></a>Decode_The_File</h2><p>找到了python2的脚本改一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase, ascii_lowercase, digits</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encode&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        codes=f.read()</span><br><span class="line">    Lc=codes.split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    base=ascii_uppercase+ascii_lowercase+digits+<span class="string">&#x27;+/&#x27;</span></span><br><span class="line">    re2=[]</span><br><span class="line">    <span class="keyword">for</span> code <span class="keyword">in</span> Lc:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;==&#x27;</span> <span class="keyword">in</span> code:</span><br><span class="line">            re2.append(<span class="built_in">bin</span>(base.find(code[-<span class="number">3</span>]))[<span class="number">2</span>:].rjust(<span class="number">6</span>,<span class="string">&#x27;0&#x27;</span>)[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;=&#x27;</span> <span class="keyword">in</span> code:</span><br><span class="line">            re2.append(<span class="built_in">bin</span>(base.find(code[-<span class="number">2</span>]))[<span class="number">2</span>:].rjust(<span class="number">6</span>,<span class="string">&#x27;0&#x27;</span>)[<span class="number">4</span>:])</span><br><span class="line">    ret=<span class="string">&#x27;&#x27;</span>.join(re2)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(ret[:ret.rfind(<span class="string">&#x27;1&#x27;</span>)+<span class="number">1</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span> (solve())</span><br><span class="line"><span class="comment">#b&#x27;ROIS&#123;base_GA_caN_b3_d1ffeR3nT&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="streamgame1"><a href="#streamgame1" class="headerlink" title="streamgame1"></a>streamgame1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flag的长度为25字节，25-6=19个字节</span></span><br><span class="line"><span class="comment">#3&lt;&lt;2可以这么算，bin(3)=0b11向左移动2位变成1100，0b1100=12(十进制)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span>    <span class="comment">#将R向左移动1位，bin(0xffffff)=&#x27;0b111111111111111111111111&#x27;=0xffffff的二进制补码</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffff</span>             <span class="comment">#按位与运算符&amp;：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)    <span class="comment">#按位异或运算符：当两对应的二进位相异时，结果为1</span></span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line">R=<span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">mask  =  <span class="number">0b1010011000100011100</span></span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;ab&quot;</span>)   <span class="comment">#以二进制追加模式打开</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        (R,out)=lfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; <span class="number">1</span>)^out   <span class="comment">#按位异或运算符：当两对应的二进位相异时，结果为1</span></span><br><span class="line">    f.write(<span class="built_in">chr</span>(tmp))  <span class="comment">#chr() 用一个范围在 range（256）内的（就是0～255）整数作参数，返回一个对应的字符。</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>题目给的很详细了,但是现在确实做不出来,但总不能不做了吧,看WP</p>
<p>那么我们的任务很明确,就是通过分析lfsr函数,整理成数学表达式的形式求解即可,接下来我们对代码进行逐行解读</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span>    <span class="comment">#把R左移一位后低32位,(即抹去R的最高位,然后在R的最低位补0)的值赋给output变量</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffff</span>             <span class="comment">#把传入的R和mask做按位与运算，运算结果取低32位，将该值赋给i变量。</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="comment"># 从i的最低位向i的最高位依次做异或运算，将运算结果赋给lastbit变量。</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)    <span class="comment">#按位异或运算符：当两对应的二进位相异时，结果为1</span></span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output^=lastbit         <span class="comment">#将output变量的最后一位设置成lastbit变量的值。</span></span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)<span class="comment">#返回output变量和lastbit变量的值，output即经过一轮lfsr之后的新序列，lastbit即经过一轮lfsr之后输出的一位。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>通过上面的分析，我们可以看出在这道题的情境下，lfsr函数本质上就是一个<strong>输入R输出lastbit的函数</strong>，虽然我们现在已经清楚了<strong>R是如何经过一系列运算得到lastbit</strong>的，但是我们前面的反馈函数都是<strong>数学表达式</strong>的形式，我们能否将上述过程整理成一个表达式的形式呢？这就需要我们再进一步进行分析：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mask = 0b1010011000100011100</span><br><span class="line">mask 只有第3,5,8,9,13,17,18,19位是1,其余均为0.</span><br><span class="line">mask与R做按位与运算得到i,当且仅当R中的第3,5,8,9,13,17,18,19位也是1时,i中才可能出现1,否则i中将全为0.</span><br><span class="line">lastbit是由i的最低位向i的最高位一次做异或运算得到的,在这个过程中,所有为0的位我们可以忽略不计</span><br></pre></td></tr></table></figure>

<p>将其写成数学表示式的形式,即为:</p>
<p><strong>lastbit&#x3D;R3^R5^R8^R9^R13^R17^R18^R19</strong></p>
<p>显然lastbit和R之间满足线性关系,那么接下来我们就可以开始求解了</p>
<p>关键就在于这个key如何去解,一开始我是之间复制粘贴,取前19位,发现全都是0,后来直接看了一下key的全部值,发现在最后几位才出现1.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import os,sys</span><br><span class="line">os.chdir(sys.path[0])</span><br><span class="line">from Crypto.Util.number import*</span><br><span class="line">f = open(&#x27;key&#x27;,&#x27;rb&#x27;).read()</span><br><span class="line">key = bytes_to_long(f)</span><br><span class="line">bin_out = bin(key)[2:].zfill(100*8)</span><br><span class="line">print(bin_out[:19])</span><br></pre></td></tr></table></figure>

<p>正确的是这个脚本</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiao__1bai/article/details/120399710">https://blog.csdn.net/xiao__1bai/article/details/120399710</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xiao__1bai师傅:</span><br><span class="line">然后查了好些资料发些他们从文件中读取二进制数的代码还是不够简便，于是我吸取了我前面base64编码的代码写了一串从文件中读取对齐的二进制的代码，以后也直接拿来用即可。</span><br><span class="line">(在线转换都会省略最开头的0导致结果位数错误，进而导致结果错误，所以自己要注意。)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f = open(&#x27;5key&#x27;,&#x27;rb&#x27;)	#以二进制格式打开文件</span><br><span class="line">content = f.read()		#读取的是\xhh类型的十六进制</span><br><span class="line">#print(content)</span><br><span class="line">key=[&#x27;&#123;:0&gt;8&#125;&#x27;.format(str(bin(i)).replace(&#x27;0b&#x27;,&#x27;&#x27;)) for i in content]	#从base64编码汲取的经验，二进制8位对齐。#是将二进制数的字符串形式转换为8位长度，不足的位数用0补齐；</span><br><span class="line">#例如，如果读取的二进制数据是b&#x27;ABCD&#x27;，那么key的值为[&#x27;01000001&#x27;, &#x27;01000010&#x27;, &#x27;01000011&#x27;, &#x27;01000100&#x27;]。</span><br><span class="line">print(&#x27;&#x27;.join(key)[:19])#前19位就是key</span><br><span class="line">#0101010100111000111</span><br></pre></td></tr></table></figure>

<p>这里说的lastbit就是key的值(这里是之前一道题的图,也是跟着之前的思路做的)</p>
<p><img src="https://p2.ssl.qhimg.com/t0100384766078bfda8.png" alt="img"></p>
<p>这样我们就可以求出R的第1位，同样的方法，我们可以求出R的第2位：</p>
<p><img src="https://p4.ssl.qhimg.com/t01ef3d957b4726b14c.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/14 11:38</span></span><br><span class="line">maks = <span class="string">&#x27;0b1010011000100011100&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;0101010100111000111&#x27;</span></span><br><span class="line">tmp = key</span><br><span class="line"></span><br><span class="line">R = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    output = <span class="string">&#x27;?&#x27;</span> + key[ :<span class="number">18</span>]</span><br><span class="line">    ans = <span class="built_in">str</span>(<span class="built_in">int</span>(tmp[-<span class="number">1</span>-i])^<span class="built_in">int</span>(output[-<span class="number">3</span>])^<span class="built_in">int</span>(output[-<span class="number">4</span>])^<span class="built_in">int</span>(output[-<span class="number">5</span>])^<span class="built_in">int</span>(output[-<span class="number">9</span>])^<span class="built_in">int</span>(output[-<span class="number">13</span>])^<span class="built_in">int</span>(output[-<span class="number">14</span>])^<span class="built_in">int</span>(output[-<span class="number">17</span>]))</span><br><span class="line">    R += <span class="built_in">str</span>(ans)</span><br><span class="line">    key=<span class="built_in">str</span>(ans)+key[:<span class="number">18</span>]</span><br><span class="line">R=R[::-<span class="number">1</span>]</span><br><span class="line">flag=<span class="string">&quot;flag&#123;&quot;</span>+R+<span class="string">&quot;&#125;&quot;</span><span class="comment">#这里要不要进行进制转换可以需要参考RR=int(flag[5:-1],2)</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Normal-RSA"><a href="#Normal-RSA" class="headerlink" title="Normal_RSA"></a>Normal_RSA</h2><p>确实是普通的RSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/12 15:01</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">87924348264132406875276140514499937145050893665602592992418171647042491658461</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line"></span><br><span class="line">Phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, Phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = bytes_to_long(file.read())</span><br><span class="line">    res = long_to_bytes(<span class="built_in">pow</span>(data, d, n))</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h2 id="easy-ECC"><a href="#easy-ECC" class="headerlink" title="easy_ECC"></a>easy_ECC</h2><p>椭圆曲线加密算法</p>
<p><img src="https://img2020.cnblogs.com/blog/2165979/202010/2165979-20201025141323328-1581483437.png" alt="img"></p>
<p>要调整为10进制</p>
<p>点CALC R</p>
<h2 id="说我作弊需要证据"><a href="#说我作弊需要证据" class="headerlink" title="说我作弊需要证据"></a>说我作弊需要证据</h2><p>追踪数据流我们注意到从Alice（192.168.0.13）和Bob（192.168.0.37）的每个数据包都包含base64编码的有效负载。</p>
<p>看时间猜测是A给B发</p>
<p>解码几行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SEQ = 13; DATA = 0x3b04b26a0adada2f67326bb0c5d6L; SIG = 0x2e5ab24f9dc21df406a87de0b3b4L;</span><br><span class="line">SEQ = 0; DATA = 0x7492f4ec9001202dcb569df468b4L; SIG = 0xc9107666b1cc040a4fc2e89e3e7L;</span><br><span class="line">SEQ = 5; DATA = 0x94d97e04f52c2d6f42f9aacbf0b5L; SIG = 0x1e3b6d4eaf11582e85ead4bf90a9L;</span><br><span class="line">SEQ = 4; DATA = 0x2c29150f1e311ef09bc9f06735acL; SIG = 0x1665fb2da761c4de89f27ac80cbL;</span><br><span class="line">SEQ = 18; DATA = 0x181901c059de3b0f2d4840ab3aebL; SIG = 0x1b8bdf9468f81ce33a0da2a8bfbeL;</span><br></pre></td></tr></table></figure>

<p>实在搞不出来了.按着风二西师傅的wp做的,我只能说yyds</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa</span>(<span class="params">c,m</span>):</span><br><span class="line">    <span class="comment">#print(type(c),16)</span></span><br><span class="line">    c=<span class="built_in">int</span>(c,<span class="number">16</span>)</span><br><span class="line">    m=<span class="built_in">int</span>(m,<span class="number">16</span>)</span><br><span class="line">    n1 = <span class="number">1696206139052948924304948333474767</span></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    d1 = <span class="number">37191940763524230367308693117833</span></span><br><span class="line">    n2= <span class="number">3104649130901425335933838103517383</span></span><br><span class="line">    d2 = <span class="number">1427000713644866747260499795119265</span></span><br><span class="line"></span><br><span class="line">    a1 = <span class="built_in">pow</span>(m, e ,n1)</span><br><span class="line">    a2 = <span class="built_in">pow</span>(c, d2, n2)</span><br><span class="line">    a1 = libnum.n2s(a1)</span><br><span class="line">    a2 = libnum.n2s(a2)</span><br><span class="line">    <span class="keyword">return</span> a1,a2</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        a1=i.find(<span class="string">&quot;DATA = &quot;</span>)</span><br><span class="line">        a2=i.find(<span class="string">&quot;L;&quot;</span>,a1)</span><br><span class="line">        a3=i[a1+<span class="number">7</span>:a2]</span><br><span class="line">        <span class="comment">#print (a3)</span></span><br><span class="line">        b1=i.find(<span class="string">&quot;SIG = &quot;</span>)</span><br><span class="line">        b2=i.find(<span class="string">&quot;L;&quot;</span>,b1)</span><br><span class="line">        b3=i[b1+<span class="number">6</span>:b2]</span><br><span class="line">        <span class="comment">#print (b3)</span></span><br><span class="line">        <span class="comment">#print b3</span></span><br><span class="line">        a4=rsa(a3,b3)<span class="comment">#自己写了一个rsa函数</span></span><br><span class="line">        flag.append(a4)</span><br><span class="line">    <span class="comment">#print (flag)</span></span><br><span class="line">    flag1=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="keyword">if</span> i[<span class="number">0</span>]==i[<span class="number">1</span>]:</span><br><span class="line">            flag1 += <span class="built_in">chr</span>(bytes_to_long(i[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="comment">#flag&#123;n0th1ng_t0_533_h3r3_m0v3_0n&#125;</span></span><br></pre></td></tr></table></figure>

<p>第一部分不再赘述</p>
<p>看这个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        a1=i.find(<span class="string">&quot;DATA = &quot;</span>)</span><br><span class="line">        a2=i.find(<span class="string">&quot;L;&quot;</span>,a1)</span><br><span class="line">        a3=i[a1+<span class="number">7</span>:a2]</span><br><span class="line">        <span class="comment">#print (a3)</span></span><br><span class="line">        b1=i.find(<span class="string">&quot;SIG = &quot;</span>)</span><br><span class="line">        b2=i.find(<span class="string">&quot;L;&quot;</span>,b1)</span><br><span class="line">        b3=i[b1+<span class="number">6</span>:b2]</span><br><span class="line">        <span class="comment">#print (b3)</span></span><br><span class="line">        <span class="comment">#print b3</span></span><br><span class="line">        a4=rsa(a3,b3)</span><br><span class="line">        flag.append(a4)</span><br></pre></td></tr></table></figure>

<p><code>find()</code> 是 Python 字符串对象的方法之一，用于在一个字符串中查找子字符串，并返回第一次出现的位置</p>
<h2 id="Easy-Crypto"><a href="#Easy-Crypto" class="headerlink" title="Easy_Crypto"></a>Easy_Crypto</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">get buf unsign s[<span class="number">256</span>]</span><br><span class="line"></span><br><span class="line">get buf t[<span class="number">256</span>]</span><br><span class="line"></span><br><span class="line">we have key:hello world</span><br><span class="line"></span><br><span class="line">we have flag:????????????????????????????????</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i:<span class="number">0</span> to <span class="number">256</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">set</span> s[i]:i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i:<span class="number">0</span> to <span class="number">256</span></span><br><span class="line">    <span class="built_in">set</span> t[i]:key[(i)mod(key.lenth)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i:<span class="number">0</span> to <span class="number">256</span></span><br><span class="line">    <span class="built_in">set</span> j:(j+s[i]+t[i])mod(<span class="number">256</span>)</span><br><span class="line">        swap:s[i],s[j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m:<span class="number">0</span> to <span class="number">37</span></span><br><span class="line">    <span class="built_in">set</span> i:(i + <span class="number">1</span>)mod(<span class="number">256</span>)</span><br><span class="line">    <span class="built_in">set</span> j:(j + S[i])mod(<span class="number">256</span>)</span><br><span class="line">    swap:s[i],s[j]</span><br><span class="line">    <span class="built_in">set</span> x:(s[i] + (s[j]mod(<span class="number">256</span>))mod(<span class="number">256</span>))</span><br><span class="line">    <span class="built_in">set</span> flag[m]:flag[m]^s[x]</span><br><span class="line"></span><br><span class="line">fprint flagx to file</span><br></pre></td></tr></table></figure>

<p>前半部分是RC4</p>
<p>主要看这里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for m:0 to 37</span><br><span class="line">    set i:(i + 1)mod(256)</span><br><span class="line">    set j:(j + S[i])mod(256)</span><br><span class="line">    swap:s[i],s[j]</span><br><span class="line">    set x:(s[i] + (s[j]mod(256))mod(256))</span><br><span class="line">    set flag[m]:flag[m]^s[x]</span><br></pre></td></tr></table></figure>

<p>加密操作是异或,而我们又知道他加密的全部过程,所以再次用相同的步骤异或一次就可以得到明文</p>
<p>根据伪码逆着来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">t = []</span><br><span class="line">s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">&quot;E:\\filexz\IDMxz\enc\enc.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    t.append(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + s[i] + <span class="built_in">ord</span>(t[i])) % <span class="number">256</span></span><br><span class="line">    s[i], s[j] = s[j], s[i]</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> ci <span class="keyword">in</span> c:</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">    s[i], s[j] = s[j], s[i]</span><br><span class="line">    x = (s[i] + (s[j] % <span class="number">256</span>)) % <span class="number">256</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(ci ^ s[x])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Easy-one"><a href="#Easy-one" class="headerlink" title="Easy-one"></a>Easy-one</h2><p>加密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc, char **argv) &#123;</span><br><span class="line">	<span class="keyword">if</span> (argc != <span class="number">3</span>) &#123;</span><br><span class="line">		printf(<span class="string">&quot;USAGE: %s INPUT OUTPUT\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	FILE* <span class="built_in">input</span>  = fopen(argv[<span class="number">1</span>], <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">	FILE* output = fopen(argv[<span class="number">2</span>], <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">input</span> || !output) &#123;</span><br><span class="line">		printf(<span class="string">&quot;Error\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	char k[] = <span class="string">&quot;CENSORED&quot;</span>;</span><br><span class="line">	char c, p, t = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> ((p = fgetc(<span class="built_in">input</span>)) != EOF) &#123;</span><br><span class="line">		c = (p + (k[i % strlen(k)] ^ t) + i*i) &amp; <span class="number">0xff</span>;</span><br><span class="line">		t = p;</span><br><span class="line">		i++;</span><br><span class="line">		fputc(c, output);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">char k[] = &quot;CENSORED&quot;;    // 初始化一个密钥字符串,但真正的密钥不是它</span><br><span class="line">char c, p, t = 0;         // 定义加密后的字符，上一个字符，以及一个临时变量 t</span><br><span class="line">int i = 0;                // 定义计数器 i 并将其初始化为 0</span><br><span class="line"></span><br><span class="line">while ((p = fgetc(input)) != EOF) &#123; // 从输入流中读取字符，直到文件末尾</span><br><span class="line">  c = (p + (k[i % strlen(k)] ^ t) + i*i) &amp; 0xff; // 对当前字符进行加密</span><br><span class="line">  t = p;                 // 将上一个字符保存到临时变量 t 中</span><br><span class="line">  i++;                  // 递增计数器 i</span><br><span class="line">  fputc(c, output);      // 将加密后的字符写入输出流</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在循环中，每次读取一个字符 <code>p</code>，然后计算出一个加密后的字符 <code>c</code>。加密过程中，首先从密钥字符串中取出一个字节进行异或运算，然后加上上一个字符 <code>t</code> 和计数器 <code>i</code> 的平方。最后将结果与 0xff 做与运算（这是一个二进制掩码，用于确保加密后的字符只有一个字节），并将结果赋值给加密后的字符 <code>c</code>。</p>
<p>然后将当前字符 <code>p</code> 保存到临时变量 <code>t</code> 中，以备下一次加密使用。计数器 <code>i</code> 也会递增，以便在下一次循环中使用下一个密钥字节。最后，将加密后的字符 <code>c</code> 写入输出流中。</p>
<p>总体来说，这段代码使用简单的加密算法将输入流中的数据加密，并将加密后的数据写入输出流中。密钥字符串可以根据需要更改，以生成不同的加密输出。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">f1=open(<span class="string">&quot;msg001&quot;</span>,<span class="string">&#x27;rb+&#x27;</span>)</span><br><span class="line">f2=open(<span class="string">&quot;msg001.enc&quot;</span>,<span class="string">&#x27;rb+&#x27;</span>)</span><br><span class="line">p=f1.read()</span><br><span class="line">c=f2.read()</span><br><span class="line">p = p.decode()</span><br><span class="line">c = c.decode(<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line">key=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">print(p)</span></span><br><span class="line"><span class="string">print(c)</span></span><br><span class="line"><span class="string">p = p.replace(&#x27;</span> \\n<span class="number">&#x27;</span>,<span class="string">&#x27;&#x27;)</span></span><br><span class="line"><span class="string">p = [ord(i) for i in p]</span></span><br><span class="line"><span class="string">c = [ord(b) for b in c]</span></span><br><span class="line"><span class="string">print(p)</span></span><br><span class="line"><span class="string">print(c)</span></span><br><span class="line"><span class="string">t = 0</span></span><br><span class="line"><span class="string">key=&quot;&quot;</span></span><br><span class="line"><span class="string">for i in range(len(p)):</span></span><br><span class="line"><span class="string"> k=((c[i]-p[i]-i*i)^t)&amp;0xff</span></span><br><span class="line"><span class="string"> t=p[i]</span></span><br><span class="line"><span class="string"> key=key+chr(k)</span></span><br><span class="line"><span class="string">print(key)</span></span><br><span class="line"><span class="string">#VeryLongKeyYouWillNeverGuessVe</span></span><br><span class="line"><span class="string">#这里后面的Ve是多余的,因为明文的长度,比key的长度2个,</span></span><br></pre></td></tr></table></figure>

<p>接下来解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;msg002.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">f = f.decode(<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line">c = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> f]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">t = <span class="number">0</span></span><br><span class="line">key = <span class="string">&#x27;VeryLongKeyYouWillNeverGuess&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="comment"># c = (p + (k[i % len(k)] ^ t) + i * i) &amp; 0xff;</span></span><br><span class="line">    p = (c[i] - (<span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]) ^ t) - i * i) &amp; <span class="number">0xff</span></span><br><span class="line">    t = p</span><br><span class="line">    flag = flag+ <span class="built_in">chr</span>(p)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="x-xor-md5"><a href="#x-xor-md5" class="headerlink" title="x_xor_md5"></a>x_xor_md5</h2><p>放入HEX后就没思路了,</p>
<p>01780C4C109E3237120CFBBACB8F6A53</p>
<p>WP上说:怀疑 重复的内容就是 xor key</p>
<p>用 xor key 去和每一行的数据进行 异或运算，</p>
<p>再将其 转为字符：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_xor_key</span>(<span class="params">*m</span>):<span class="comment">#原始文件 16 进制 XOR 原始 key（每一行 XOR 原始 key 一行）</span></span><br><span class="line">    num0 = [<span class="string">&#x27;69&#x27;</span>,<span class="string">&#x27;35&#x27;</span>,<span class="string">&#x27;41&#x27;</span>,<span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;1C&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;75&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;5D&#x27;</span>,<span class="string">&#x27;48&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;F0&#x27;</span>,<span class="string">&#x27;84&#x27;</span>,<span class="string">&#x27;CD&#x27;</span>,<span class="string">&#x27;66&#x27;</span>,<span class="string">&#x27;79&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;55&#x27;</span>,<span class="string">&#x27;30&#x27;</span>,<span class="string">&#x27;49&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;56&#x27;</span>,<span class="string">&#x27;D2&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;70&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;45&#x27;</span>,<span class="string">&#x27;A8&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;85&#x27;</span>,<span class="string">&#x27;C0&#x27;</span>,<span class="string">&#x27;3E&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;1B&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;2A&#x27;</span>,<span class="string">&#x27;4B&#x27;</span>,<span class="string">&#x27;E9&#x27;</span>,<span class="string">&#x27;77&#x27;</span>,<span class="string">&#x27;26&#x27;</span>,<span class="string">&#x27;5E&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;BF&#x27;</span>,<span class="string">&#x27;AA&#x27;</span>,<span class="string">&#x27;85&#x27;</span>,<span class="string">&#x27;9C&#x27;</span>,<span class="string">&#x27;15&#x27;</span>,<span class="string">&#x27;6F&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;54&#x27;</span>,<span class="string">&#x27;2C&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;1B&#x27;</span>,<span class="string">&#x27;58&#x27;</span>,<span class="string">&#x27;8A&#x27;</span>,<span class="string">&#x27;66&#x27;</span>,<span class="string">&#x27;48&#x27;</span>,<span class="string">&#x27;5B&#x27;</span>,<span class="string">&#x27;19&#x27;</span>,<span class="string">&#x27;84&#x27;</span>,<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;80&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>,<span class="string">&#x27;33&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;5C&#x27;</span>,<span class="string">&#x27;52&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;89&#x27;</span>,<span class="string">&#x27;D5&#x27;</span>,<span class="string">&#x27;A2&#x27;</span>,<span class="string">&#x27;FC&#x27;</span>]</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    num_xor_key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num0)):</span><br><span class="line">        x = <span class="built_in">int</span>(num0[i],<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> j &gt;= <span class="number">16</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        y = <span class="built_in">int</span>(m[j],<span class="number">16</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        num_xor_key.append(<span class="built_in">hex</span>(x^y)[<span class="number">2</span>:])</span><br><span class="line">        s += <span class="built_in">chr</span>(x^y)</span><br><span class="line">    <span class="built_in">print</span>(num_xor_key)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">return</span>(num_xor_key)</span><br><span class="line">m = [<span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>]</span><br><span class="line">num = file_xor_key(*m)</span><br></pre></td></tr></table></figure>

<p>得到有ctf字样的乱码，说明思路没有出错，还需要进一步操作</p>
<p><img src="https://img-blog.csdnimg.cn/2019101514573253.png" alt="img"></p>
<p>审查得到的 16 进制列表数据，发现 不应该出现0x00，0x00是绝对意义上的空，而空格 是 0x20</p>
<p>所以猜测应该是 所有数据还要和 0x20 进行 异或运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">file_xor_20</span>(<span class="params">*n</span>):<span class="comment">#16 进制数组 XOR 0x20</span></span><br><span class="line">    m = <span class="string">&#x27;20&#x27;</span></span><br><span class="line">    y = <span class="built_in">int</span>(m,<span class="number">16</span>)<span class="comment">#将16进制转换为10进制,就是32</span></span><br><span class="line">    <span class="built_in">print</span>(y)</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    num =[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(n)):</span><br><span class="line">        x = <span class="built_in">int</span>(n[i],<span class="number">16</span>)</span><br><span class="line">        num.append(<span class="built_in">hex</span>(x^y)[<span class="number">2</span>:])</span><br><span class="line">        s += <span class="built_in">chr</span>(x^y)</span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">file_xor_20(*num)</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/2019101515015935.png" alt="img"></p>
<p>这里只需要跟假key异或即可,并得到疑似的key&#x3D;21582c6c30be1217322cdb9aebaf4a73</p>
<p>疑似的 flag 为 RCTF{We1l_d0n3_ut_wh4t_i5_<em>key }，但 FLAG 中最后一列的字符还有非可显示 字符（</em>key 后面是个空格，还有 ut 前面,并且这两个位置都是每次key循环完成后的第16位），说明最后一列的KEY不正确，猜测 key 被两个<em>包括，即</em>key*，所以就是 0x00^0x2a，尝试调整后得到真正的 key： 21582c6c30be1217322cdb9aebaf4a59</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getkey</span>():</span><br><span class="line">    m = [<span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>]</span><br><span class="line">    y = <span class="number">32</span><span class="comment">#将16进制的0x20转换为10进制,就是32</span></span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    r_key =[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(m)):</span><br><span class="line">        x = <span class="built_in">int</span>(m[i],<span class="number">16</span>)</span><br><span class="line">        r_key.append(<span class="built_in">hex</span>(x^y)[<span class="number">2</span>:])</span><br><span class="line">    <span class="built_in">print</span>(r_key)</span><br><span class="line">    <span class="keyword">return</span>  r_key</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_xor_key</span>(<span class="params">m</span>):<span class="comment">#原始文件 16 进制 XOR 原始 key（每一行 XOR 原始 key 一行）</span></span><br><span class="line">    num0 = [<span class="string">&#x27;69&#x27;</span>,<span class="string">&#x27;35&#x27;</span>,<span class="string">&#x27;41&#x27;</span>,<span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;1C&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;75&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;5D&#x27;</span>,<span class="string">&#x27;48&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;F0&#x27;</span>,<span class="string">&#x27;84&#x27;</span>,<span class="string">&#x27;CD&#x27;</span>,<span class="string">&#x27;66&#x27;</span>,<span class="string">&#x27;79&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;55&#x27;</span>,<span class="string">&#x27;30&#x27;</span>,<span class="string">&#x27;49&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;56&#x27;</span>,<span class="string">&#x27;D2&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;70&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;45&#x27;</span>,<span class="string">&#x27;A8&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;85&#x27;</span>,<span class="string">&#x27;C0&#x27;</span>,<span class="string">&#x27;3E&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;1B&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;2A&#x27;</span>,<span class="string">&#x27;4B&#x27;</span>,<span class="string">&#x27;E9&#x27;</span>,<span class="string">&#x27;77&#x27;</span>,<span class="string">&#x27;26&#x27;</span>,<span class="string">&#x27;5E&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;BF&#x27;</span>,<span class="string">&#x27;AA&#x27;</span>,<span class="string">&#x27;85&#x27;</span>,<span class="string">&#x27;9C&#x27;</span>,<span class="string">&#x27;15&#x27;</span>,<span class="string">&#x27;6F&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;54&#x27;</span>,<span class="string">&#x27;2C&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,<span class="string">&#x27;1B&#x27;</span>,<span class="string">&#x27;58&#x27;</span>,<span class="string">&#x27;8A&#x27;</span>,<span class="string">&#x27;66&#x27;</span>,<span class="string">&#x27;48&#x27;</span>,<span class="string">&#x27;5B&#x27;</span>,<span class="string">&#x27;19&#x27;</span>,<span class="string">&#x27;84&#x27;</span>,<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;80&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>,<span class="string">&#x27;33&#x27;</span>,<span class="string">&#x27;73&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;5C&#x27;</span>,<span class="string">&#x27;52&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;BA&#x27;</span>,<span class="string">&#x27;CB&#x27;</span>,<span class="string">&#x27;8F&#x27;</span>,<span class="string">&#x27;6A&#x27;</span>,<span class="string">&#x27;53&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;01&#x27;</span>,<span class="string">&#x27;78&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;4C&#x27;</span>,<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;9E&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;0C&#x27;</span>,<span class="string">&#x27;89&#x27;</span>,<span class="string">&#x27;D5&#x27;</span>,<span class="string">&#x27;A2&#x27;</span>,<span class="string">&#x27;FC&#x27;</span>]</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    m = m[:<span class="number">15</span>]+[<span class="string">&#x27;59&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m: &quot;</span>,m)</span><br><span class="line">    num_xor_key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num0)):</span><br><span class="line">        x = <span class="built_in">int</span>(num0[i],<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> j &gt;= <span class="number">16</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        y = <span class="built_in">int</span>(m[j],<span class="number">16</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        num_xor_key.append(<span class="built_in">hex</span>(x^y)[<span class="number">2</span>:])</span><br><span class="line">        s += <span class="built_in">chr</span>(x^y)</span><br><span class="line">    <span class="built_in">print</span>(num_xor_key)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">return</span>(num_xor_key)</span><br><span class="line">key =  getkey()</span><br><span class="line">file_xor_key(key)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>,<span class="number">99</span>):</span><br><span class="line">    <span class="built_in">print</span>(ii)</span><br><span class="line">    m = m[:<span class="number">15</span>] + [<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ii)]</span><br><span class="line">    <span class="comment"># m = m[:15]+[&#x27;&#123;&#125;&#x27;.format(ii)]</span></span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    num_xor_key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num0)):</span><br><span class="line">        x = <span class="built_in">int</span>(num0[i],<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> j &gt;= <span class="number">16</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        y = <span class="built_in">int</span>(m[j],<span class="number">16</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        num_xor_key.append(<span class="built_in">hex</span>(x^y)[<span class="number">2</span>:])</span><br><span class="line">        s += <span class="built_in">chr</span>(x^y)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    math = <span class="built_in">str</span>.find(s,<span class="string">&#x27;RCTF&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(s[math:math+<span class="number">33</span>])</span><br><span class="line">    s =<span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>也可以爆破一下</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io">Jinmu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/">https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jinmu1108.github.io" target="_blank">J1Nmu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/%E5%88%B7%E9%A2%98/">刷题</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Web/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">序列化与反序列化</div></div></a></div><div class="next-post pull-right"><a href="/Crypto/RSA/Crypto-RSA/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info"></div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Crypto%E9%A2%98%E7%9B%AE/BUU-crypto/BUU-Crypto/" title="BUU-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-18</div><div class="title">BUU-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-18</div><div class="title">Crypto-AES题目</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/ctfs-crypto/" title="ctf-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">ctf-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/qsn-crypto/qsn-crypto/" title="qsn-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">qsn-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/" title="风二西RSA"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-10</div><div class="title">风二西RSA</div></div></a></div><div><a href="/Crypto/Crypto/" title="Crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-05</div><div class="title">Crypto</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jinmu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto"><span class="toc-number">1.</span> <span class="toc-text">攻防世界-Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95-%E5%88%9D%E8%AF%86RSA"><span class="toc-number">1.1.</span> <span class="toc-text">[简单] 初识RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hidden-key"><span class="toc-number">1.2.</span> <span class="toc-text">hidden key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easychallenge"><span class="toc-number">1.3.</span> <span class="toc-text">easychallenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84LFSR"><span class="toc-number">1.4.</span> <span class="toc-text">简单的LFSR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#matrix"><span class="toc-number">1.4.1.</span> <span class="toc-text">matrix()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B1%82%E7%9F%A9%E9%98%B5X%E6%BB%A1%E8%B6%B3XA-x3D-B"><span class="toc-number">1.4.1.0.1.</span> <span class="toc-text">求矩阵X满足XA&#x3D;B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B1%82%E7%9F%A9%E9%98%B5X%E6%BB%A1%E8%B6%B3AX-x3D-B"><span class="toc-number">1.4.1.0.2.</span> <span class="toc-text">求矩阵X满足AX&#x3D;B</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsarsa"><span class="toc-number">1.5.</span> <span class="toc-text">rsarsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%8A%E8%AF%89%E4%BD%A0%E4%B8%AA%E7%A7%98%E5%AF%86"><span class="toc-number">1.6.</span> <span class="toc-text">告诉你个秘密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E7%8C%9C%E7%8C%9C"><span class="toc-number">1.7.</span> <span class="toc-text">你猜猜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-in-your-hand1"><span class="toc-number">1.8.</span> <span class="toc-text">flag_in_your_hand1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%B8%9A%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%902"><span class="toc-number">1.9.</span> <span class="toc-text">工业协议分析2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sherlock"><span class="toc-number">1.10.</span> <span class="toc-text">sherlock</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#safer-than-rot13"><span class="toc-number">1.11.</span> <span class="toc-text">safer-than-rot13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cr4-poor-rsa"><span class="toc-number">1.12.</span> <span class="toc-text">cr4-poor-rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto%E5%9E%83%E5%9C%BE%E9%82%AE%E4%BB%B6"><span class="toc-number">1.13.</span> <span class="toc-text">crypto垃圾邮件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cat%E2%80%99s-gift"><span class="toc-number">1.14.</span> <span class="toc-text">cat’s gift</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%85%83%E4%B8%80%E6%AC%A1%E6%96%B9%E7%A8%8B"><span class="toc-number">1.14.1.</span> <span class="toc-text">二元一次方程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyFibo"><span class="toc-number">1.15.</span> <span class="toc-text">babyFibo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Xor%E5%BE%88%E5%BF%83%E7%96%BC%E4%BD%A0"><span class="toc-number">1.16.</span> <span class="toc-text">Xor很心疼你</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%AD%89%E5%81%8F%E4%B8%8B-%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">1.17.</span> <span class="toc-text">[中等偏下] 线性反馈移位寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E8%BD%AE%E6%9C%BA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.18.</span> <span class="toc-text">转轮机加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#best-rsa"><span class="toc-number">1.19.</span> <span class="toc-text">best_rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA-gcd"><span class="toc-number">1.20.</span> <span class="toc-text">RSA_gcd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shanghai"><span class="toc-number">1.21.</span> <span class="toc-text">shanghai</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OldDriver"><span class="toc-number">1.22.</span> <span class="toc-text">OldDriver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easychallenge-1"><span class="toc-number">1.23.</span> <span class="toc-text">easychallenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Decrypt-the-Message"><span class="toc-number">1.24.</span> <span class="toc-text">Decrypt-the-Message</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Poem-Codes"><span class="toc-number">1.24.1.</span> <span class="toc-text">Poem Codes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.24.1.1.</span> <span class="toc-text">加密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A1%E9%A2%98%E8%A7%A3%E9%A2%98"><span class="toc-number">1.24.1.2.</span> <span class="toc-text">审题解题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-number">1.24.1.3.</span> <span class="toc-text">解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecb-it%E2%80%99s-easy-as-123"><span class="toc-number">1.25.</span> <span class="toc-text">ecb,_it’s_easy_as_123</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">1.25.1.</span> <span class="toc-text">原因分析：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enc"><span class="toc-number">1.26.</span> <span class="toc-text">enc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wtc-rsa-bbq"><span class="toc-number">1.27.</span> <span class="toc-text">wtc_rsa_bbq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%B8%9A%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%901"><span class="toc-number">1.28.</span> <span class="toc-text">工业协议分析1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">1.29.</span> <span class="toc-text">简单流量分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8%E5%8F%96%E8%AF%81"><span class="toc-number">1.30.</span> <span class="toc-text">工控安全取证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fanfie"><span class="toc-number">1.31.</span> <span class="toc-text">fanfie</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%89%BE%E5%88%B0%E5%8A%A0%E5%AF%86%E4%BF%A1%E6%81%AF"><span class="toc-number">1.31.0.1.</span> <span class="toc-text">1. 找到加密信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simpleRSA"><span class="toc-number">1.32.</span> <span class="toc-text">simpleRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#onetimepad"><span class="toc-number">1.33.</span> <span class="toc-text">onetimepad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cr2-many-time-secrets"><span class="toc-number">1.34.</span> <span class="toc-text">cr2-many-time-secrets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Decode-The-File"><span class="toc-number">1.35.</span> <span class="toc-text">Decode_The_File</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#streamgame1"><span class="toc-number">1.36.</span> <span class="toc-text">streamgame1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Normal-RSA"><span class="toc-number">1.37.</span> <span class="toc-text">Normal_RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-ECC"><span class="toc-number">1.38.</span> <span class="toc-text">easy_ECC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E6%88%91%E4%BD%9C%E5%BC%8A%E9%9C%80%E8%A6%81%E8%AF%81%E6%8D%AE"><span class="toc-number">1.39.</span> <span class="toc-text">说我作弊需要证据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-Crypto"><span class="toc-number">1.40.</span> <span class="toc-text">Easy_Crypto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-one"><span class="toc-number">1.41.</span> <span class="toc-text">Easy-one</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x-xor-md5"><span class="toc-number">1.42.</span> <span class="toc-text">x_xor_md5</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Crypto/RC4/Crypto-RC4/" title="Crypto-RC4"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Crypto-RC4"/></a><div class="content"><a class="title" href="/Crypto/RC4/Crypto-RC4/" title="Crypto-RC4">Crypto-RC4</a><time datetime="2023-03-18T02:58:31.381Z" title="发表于 2023-03-18 10:58:31">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CTF%E5%A5%97%E8%B7%AF/%E4%B8%80%E4%BA%9B%E5%A7%BF%E5%8A%BF/%E6%96%B0%E5%A7%BF%E5%8A%BF/" title="CTF一些做题姿势"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF一些做题姿势"/></a><div class="content"><a class="title" href="/CTF%E5%A5%97%E8%B7%AF/%E4%B8%80%E4%BA%9B%E5%A7%BF%E5%8A%BF/%E6%96%B0%E5%A7%BF%E5%8A%BF/" title="CTF一些做题姿势">CTF一些做题姿势</a><time datetime="2023-03-18T02:57:00.016Z" title="发表于 2023-03-18 10:57:00">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Crypto%E9%A2%98%E7%9B%AE/BUU-crypto/BUU-Crypto/" title="BUU-crypto"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU-crypto"/></a><div class="content"><a class="title" href="/Crypto%E9%A2%98%E7%9B%AE/BUU-crypto/BUU-Crypto/" title="BUU-crypto">BUU-crypto</a><time datetime="2023-03-18T02:53:53.611Z" title="发表于 2023-03-18 10:53:53">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/catf1ag-Web/catf1ag-Web/" title="catf1ag-Web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="catf1ag-Web"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/catf1ag-Web/catf1ag-Web/" title="catf1ag-Web">catf1ag-Web</a><time datetime="2023-03-18T02:53:10.734Z" title="发表于 2023-03-18 10:53:10">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Crypto-AES题目"/></a><div class="content"><a class="title" href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目">Crypto-AES题目</a><time datetime="2023-03-18T02:50:47.035Z" title="发表于 2023-03-18 10:50:47">2023-03-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jinmu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>