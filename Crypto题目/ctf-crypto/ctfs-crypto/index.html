<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ctf-crypto | J1Nmu</title><meta name="author" content="Jinmu"><meta name="copyright" content="Jinmu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ctf-misc萌新赛抱我分析源码 12345678910111213cstring &amp;#x3D; &amp;amp;#x27;abcdefghijklmnopqrstuvwxyz&amp;amp;#123;&amp;amp;#125;_0123456789&amp;amp;#x27;key &amp;#x3D; &amp;amp;#x27;flag&amp;amp;#123;********&amp;amp;#125;&amp;amp;#x27;le"><link rel="shortcut icon" href="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg"><link rel="canonical" href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/ctfs-crypto/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ctf-crypto',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-18 10:14:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">J1Nmu</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ctf-crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-03-03T14:58:19.945Z" title="发表于 2023-03-03 22:58:19">2023-03-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-18T02:14:51.588Z" title="更新于 2023-03-18 10:14:51">2023-03-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/">Crypto题目</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/">ctf-crypto</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ctf-crypto"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ctf-misc"><a href="#ctf-misc" class="headerlink" title="ctf-misc"></a>ctf-misc</h1><h2 id="萌新赛"><a href="#萌新赛" class="headerlink" title="萌新赛"></a>萌新赛</h2><h3 id="抱我"><a href="#抱我" class="headerlink" title="抱我"></a>抱我</h3><p>分析源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cstring = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#123;&#125;_0123456789&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;flag&#123;********&#125;&#x27;</span></span><br><span class="line">length = <span class="number">300</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>():</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, length):</span><br><span class="line">        c = random.randint(<span class="number">0</span>, <span class="number">36</span>)</span><br><span class="line">        res += cstring[c]</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            c = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(key) - <span class="number">1</span>)</span><br><span class="line">            res += key[c]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#qdfl33&#123;6&#123;6gs3afa6&#123;3&#125;agf&#123;&#125;aagdf&#125;6fl36d&#123;dfl&#123;6ay6gafddfg&#125;&#123;j3f&#125;&#125;6la&#123;3&#125;bfdf3&#125;gla&#125;65&#125;lg6g6dflf0&#123;dfgd3fdfgc&#123;g6a&#125;a3&#123;6&#125;mfa&#123;&#125;f&#125;f&#125;&#125;&#125;3363&#125;&#125;f6a6a7g&#123;a&#125;g66&#123;d3xgfffg&#125;a&#125;3&#125;_&#123;lad&#125;a33ga5fd33&#125;&#123;&#123;dl&#125;&#123;&#125;f&#123;3da&#125;g&#125;3egfal&#123;a3l&#125;3f33&#125;dfdda&#123;3sa&#123;d6g&#123;ff&#125;6vgl33d6g333h&#123;gd&#123;&#123;lg6ldg&#123;ad&#123;3333a6oalf6a&#123;33&#123;de3&#123;fa&#125;ggl&#123;abfd&#125;6&#125;6&#125;&#125;l33fa&#125;f&#123;&#123;3&#123;3fla&#125;a6&#125;af&#125;&#123;amg&#125;&#123;&#123;d&#125;&#125;a6gallfg36&#123;g3dh&#123;&#123;&#123;a&#123;lfg3&#123;sll6g6gfaggid6d&#123;3afl&#125;3rff3gfad3d&#125;1dlllff6&#125;6&#125;h3g66gla336b&#123;6d3gf&#125;f&#123;30d63l&#125;3dfl6a3llfgld3&#123;&#125;qg&#125;gf&#125;dg&#123;6l&#125;3gal&#125;agdl6&#123;lg&#123;g&#125;ddfaaealf&#123;f3llgge3ad3&#123;3adf&#123;c&#125;fllf6f&#125;3at&#123;aag&#125;a66d3&#125;ad&#123;dfg&#123;&#125;dlz6gld&#125;6&#123;3flxgf&#123;3g3ald&#125;3g&#125;g63f6ggf3&#125;gfd&#125;f3ga3efllf6&#125;363fu6366fdlggfx6&#125;6l3&#125;&#125;a&#123;afg&#123;&#123;&#125;&#125;3fdaluaa&#125;al&#123;dg3dpfga&#125;&#125;l&#125;d3l4afg&#125;f&#123;d&#123;lgcfgffglal&#125;dq6l&#125;fgflldavdad6&#125;df&#123;&#125;dw&#125;l6g&#125;&#125;&#123;l3gf6fdaa66aadt&#125;f6lg&#123;dg33h&#123;fa3d&#123;&#125;laao3l6aal&#123;lfdv&#123;3dlf6af36bddg&#125;3ggad3o&#125;&#123;&#125;3g3fgddyffd3lddgdd6&#123;gdfl&#123;&#123;la3ild&#125;dg&#123;g&#125;dgef&#123;a3&#123;d6dfgq3adll&#123;fdadt&#125;66fdflg&#123;3x&#123;l3ll&#125;3&#123;&#123;g4a3af6lag3gdaf66dadg6dfglaf66l3f&#123;2&#125;6&#123;afaf&#125;3l6all&#125;&#123;l&#125;lfdla6&#123;fgff&#123;&#125;g13dl&#123;a&#123;6&#123;l6rd6&#125;&#125;l3dgg3_f&#123;66gll&#123;f6a3d3dga6&#123;lg&#125;&#123;g&#125;d&#123;6&#123;d36lll3dd6&#123;3dg3afal&#125;d&#125;gff26&#125;l&#125;al&#125;&#125;&#123;a6&#125;g66gaaff&#125;0fga&#123;g6dfld&#123;&#123;&#125;fglf&#123;af&#125;iddf6g6&#125;l361&#123;ag&#125;&#123;&#123;dlfak&#125;&#123;d3fa&#123;6&#123;godgg&#123;l36a&#123;gmllgfa3fa&#123;&#125;f&#125;&#125;3&#123;a6&#123;a3&#123;nafg&#123;l3d6&#125;g2lf6&#123;gg&#125;&#123;g&#125;sg&#123;ga&#123;63g&#123;&#125;la6g&#123;g6&#123;&#123;63o6&#123;l&#125;&#123;3&#125;l3ag36&#123;af33g3dw6d33f3lfdan&#123;dddad&#123;&#123;6l6&#125;&#125;fad63lgd1ffaa&#125;g&#125;3flkg3d&#125;aalf3lbgf&#123;g&#125;f&#125;&#125;d3agf&#123;ld&#123;dl3l4fl&#123;&#123;3fla&#125;&#125;r3g&#125;&#123;&#125;gda&#123;&#125;_df3g&#125;fa36gq&#125;la&#123;f&#123;6l&#125;66fgdg&#125;6ag6feaal6all3&#123;d&#125;lfgl&#125;&#125;&#123;&#123;6lal&#125;gf&#125;&#125;gfgd4d&#123;g36daff&#125;l6fd63ag6&#125;f7&#125;l3&#123;&#123;d&#125;&#123;al6lff66gda&#125;f7dfaf6&#125;fd3ldfgfl36gf337a6al663afd&#123;dff&#125;6&#125;df&#123;lt&#125;66&#125;ag6a3&#123;na&#125;3la&#123;6daa&#125;63fgldf3ggcl6dd&#123;3fg&#123;&#125;&#125;gfgaf&#123;633lpfadalldgglg&#123;l&#125;&#123;6&#125;gf&#123;agf6&#123;3l3a366wa6l6&#125;fdla&#125;wfl&#125;33&#125;d&#123;6d6aa&#125;laldag&#125;bgaa3gff&#125;3db&#123;gd&#125;lfga3&#123;&#125;ffddd6&#125;&#123;la4&#125;3&#123;agdg3&#123;&#125;bf33adg3a632d&#125;66f&#125;dgd67&#125;&#123;333dfg&#125;&#125;mgg3all3l&#125;fd6dd3&#123;g&#125;&#123;&#125;&#125;v6&#125;a6f6lgd3nfgg6aff3a&#125;d3da&#123;l3ldldz&#123;&#125;&#123;&#125;g3&#125;6fdg6f&#123;gd&#123;g3adx&#123;gll6&#123;fg3dc63lf&#125;6dl&#123;d63f3g&#123;3adda5f3dgfla3&#123;6&#125;gd&#123;3&#123;d6dlldal6g66&#125;&#123;ddp&#125;lalafd&#125;d&#123;lgl&#125;g6g33agjg&#125;33dgf&#125;lg0adlda6gfdlx&#123;3g&#125;&#123;g3a&#123;a76&#125;gdf3la&#125;lh&#125;l&#123;l&#123;&#125;&#125;a6gm&#123;gdd&#123;agg&#125;6xfgg&#125;&#123;336&#125;d_a&#123;df3&#125;df33jgf&#125;6d3&#125;&#125;f&#125;h3l&#123;6ga6fll2&#125;dd&#123;l36d66&#125;ldafdlga3gbgd&#125;d6df&#125;ff1gf6a&#123;ll3a3w&#123;3g&#125;allfafldal&#125;aal&#125;dlra33l3f&#125;3dff&#123;6&#123;6&#125;f&#125;la&#125;lgf&#125;&#125;&#125;gd&#123;f3z3l3&#123;d3636dpl3fag3&#123;faa1&#123;3ga33l&#125;6ll6&#123;gg6&#125;ddf&#125;t6g&#125;&#123;gl6ggl&#123;d&#125;aafalf&#123;lw6a&#123;dad&#125;&#125;a3x&#123;ada&#123;fg6d&#125;a3g&#123;d&#123;fggdawdfal&#123;&#123;3dlfndl636&#125;36alv633ada6gf6hd&#123;3l66ddlfpglda&#125;&#123;g3fdogdfa3&#125;3g&#125;3k3d3gda33&#125;dvd&#125;laa&#123;fa&#123;a&#123;&#123;&#125;a&#125;36&#125;&#125;&#125;&#123;r6d6&#123;a6&#125;&#125;6&#123;0laa36gd&#123;36kf63a&#123;3&#125;gga4af6&#125;f3gfgf0lf&#123;6g&#125;&#123;&#123;6&#125;pafg6dg&#125;g6&#123;b&#125;3d36ad6d&#123;h6f3agff&#125;63p&#125;&#123;l3ag3&#125;lf1f3dgd&#123;66a37&#125;&#125;&#125;d6gglaftaf3l6a3&#123;&#123;a7&#123;lgd3d&#125;fl6tlfl663lgg3wa&#125;33gl&#125;d&#123;3i6aaagl6&#123;&#123;&#125;n3gd&#125;l3l6&#125;l7a&#123;gf&#123;a&#125;l&#125;f3al&#123;alg63fln&#123;&#123;dd&#125;3l&#123;ll1&#125;&#123;3g&#125;6&#123;6&#125;&#123;u63&#123;f3&#123;g6lgf&#123;3d&#125;&#123;636&#125;&#123;u3&#125;&#123;f6d&#123;&#123;d3lg&#123;3l6aldf&#123;i&#123;f366&#123;f3l&#123;eg&#123;d&#123;gll&#123;3dhgdgfgaf&#123;&#125;&#125;g&#125;&#123;lg3&#123;a&#123;flm&#125;fa3ldf&#123;d32fagllf&#123;&#123;66q363&#125;dl66gg2fa6af6d6g37lffl&#123;d&#123;3lltgl33&#125;&#125;&#123;&#125;d3o&#123;lfld3d&#123;&#125;a6a663a66&#123;fabfd6ld333g3rafa&#125;&#125;fddfgt&#123;ggad3ag&#125;lr63af6lgg&#125;gy&#123;6&#123;&#123;6&#125;6dd626&#123;gl6a&#123;ad3b3df&#125;alf3afdaf66ll&#125;lf6jd&#125;3&#123;6dldfgg&#125;f3lg63l&#123;lr3ff3l&#123;gafaa&#125;f&#125;agl6l33xglfggg&#123;&#123;&#123;fq66&#125;g6lfa3&#123;736lllflalglf&#125;&#123;&#125;gf&#123;aggdg3&#123;a&#125;&#125;da&#123;fp6fglla3l&#125;65gf36&#123;l6dl&#125;g&#125;f&#123;la6&#123;l&#123;fpf&#123;&#125;63&#123;f6gdfaalf6&#123;dffgdgf&#123;lgaf&#123;f&#123;56&#125;g6af63l6a&#125;a&#125;&#123;lfa&#123;3gblda&#125;l&#125;&#123;fl&#123;s&#123;g&#125;&#125;6&#123;g6la56g6g3&#123;f&#125;ddfaa&#123;l&#125;dg6g&#125;0glda6&#123;6d&#125;ff&#125;f&#123;6laadd6zaag&#123;l3l&#125;6dc&#125;f3gg&#125;lffgsag&#125;l3l6d3apd3gd3fd&#125;&#125;aga3ga&#125;a3&#123;6f1f3df&#123;&#123;d&#125;&#125;av3laf&#125;6adf3_d&#123;afa6f&#125;adt&#123;faf&#123;d33aaol3&#125;&#123;l&#125;ld&#125;3yl3a6a&#123;fa6&#125;_d33gf3fll&#125;of&#123;6lad&#125;&#125;fdx&#125;6d&#123;f&#125;ll63ugag66d&#123;6f3&#125;33&#125;al6l&#123;ffwf&#123;&#125;&#123;fl3a36ogg3&#123;&#125;&#125;g6&#125;3hl&#125;6dg6ld&#123;digaa&#125;g&#125;&#123;&#123;l&#125;da&#123;ddg3&#123;&#123;d&#125;w3&#125;ld&#125;adgg3m&#123;lad&#123;gd&#123;a&#123;7afff&#125;&#123;d6&#125;fsf3&#123;f&#125;gflgavfldg6a6&#123;ldqf&#125;fd&#123;f3f3&#125;73ddad&#123;666fz6&#125;d&#123;3&#123;l36a1d6fal3fl6lrl&#123;&#125;aga&#123;fdlsa&#125;&#123;6l6ag3gtgdg&#123;6lgf3f</span></span><br></pre></td></tr></table></figure>

<p>可知会循环300边且打乱顺序</p>
<p>flag中的每一个字符会生成11个字符</p>
<p>还可以在统计一下字词频率</p>
<p>flag{36d}</p>
<h3 id="妈呀-完了"><a href="#妈呀-完了" class="headerlink" title="妈呀,完了"></a>妈呀,完了</h3><p>可以用CTF工具,二进制转ASCII</p>
<p>也可以写一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;01000100010100110111100100110011010010100111100101001011011101100101000001000011010100000110110101001000001101000101011101000011011110100010101101010100011010000101011101101001001100100100011001100111010010110110111100111001011001010101001101010000010101010011010001100101001101010110011100101011011010100101101001010101001100110100011001110010010101110100111001110110010011000100110100110101001101010110101101000101011001100011000101101000010001010110110101001110011100100111010100101011010011100100010100110011&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">8</span>):</span><br><span class="line">    b+=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(a[i:i+<span class="number">8</span>],<span class="number">2</span>)))<span class="comment">#将a中数字8个一组,以二进制转换为十进制,</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DSy3JyKvPCPmH4WCz+ThWi2FgKo9eSPU4e5g+jZU3FrWNvLM55kEf1hEmNru+NE3</span><br></pre></td></tr></table></figure>

<p>刚开始还以为是base64,后来发现是谐音 玛雅,完了 </p>
<p>玛雅人预言世界末日那天是2012年12月21日</p>
<p>那么这道题的密钥就是</p>
<p>20121221,找一个在线网站解密</p>
<p><a target="_blank" rel="noopener" href="http://tool.chacuo.net/cryptaes">http://tool.chacuo.net/cryptaes</a></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230226153913097.png" alt="image-20230226153913097"></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h3><p>利用charset插件,改为unicode编码即可</p>
<h3 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h3><p>求d要知道 </p>
<p>p(prime1) </p>
<p>q(prime2)</p>
<p>e(Public Exponent)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">求N</span><br><span class="line">首先随便找两个素数，比如3、11(这边自己实验就取小数展示)</span><br><span class="line"></span><br><span class="line">p = 3</span><br><span class="line">q = 11</span><br><span class="line"></span><br><span class="line">得到 N</span><br><span class="line"></span><br><span class="line">N = 3*11 = 33</span><br><span class="line"></span><br><span class="line">求φ</span><br><span class="line">φ = 2*10= 20</span><br><span class="line"></span><br><span class="line">求e</span><br><span class="line">gcd(φ,e)=1</span><br><span class="line"></span><br><span class="line">满足条件的有很多，3，7，11，13，17，19… 这边我们选择3来作为 e。</span><br><span class="line">至此，e = 3 ，N = 33，这就是公钥</span><br><span class="line"></span><br><span class="line">求d</span><br><span class="line">e*d mod φ=1</span><br><span class="line"></span><br><span class="line">容易得 d = 7</span><br><span class="line">至此，d = 7 ，N = 33，这就是私钥</span><br></pre></td></tr></table></figure>

<p>用工具,不知到为什么E要填11才对,(因为软件的e是16进制)</p>
<h3 id="crypto5"><a href="#crypto5" class="headerlink" title="crypto5"></a>crypto5</h3><p>先求d<img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230227134249051.png" alt="image-20230227134249051"></p>
<p>n&#x3D;911934970359<br>d&#x3D;53616899001</p>
<p>然后求m</p>
<p>m&#x3D; c^d mod n</p>
<p>使用工具big integer calculate</p>
<h3 id="crypto6"><a href="#crypto6" class="headerlink" title="crypto6"></a>crypto6</h3><p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230227113407450.png" alt="image-20230227113407450"></p>
<p><a target="_blank" rel="noopener" href="http://www.jsons.cn/rabbitencrypt/">http://www.jsons.cn/rabbitencrypt/</a></p>
<h3 id="crypto7"><a href="#crypto7" class="headerlink" title="crypto7"></a>crypto7</h3><p>ook在线解密</p>
<p><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p>
<h3 id="crypto8"><a href="#crypto8" class="headerlink" title="crypto8"></a>crypto8</h3><p>Brainfuck在线解密</p>
<p><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p>
<h3 id="crypto9"><a href="#crypto9" class="headerlink" title="crypto9"></a>crypto9</h3><p><a target="_blank" rel="noopener" href="http://serpent.online-domain-tools.com/">http://serpent.online-domain-tools.com/</a></p>
<p>得到了一个.dat文件,  文件名就是一个对称密码</p>
<p>解密网站<img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230227182256672.png" alt="image-20230227182256672"></p>
<table>
<thead>
<tr>
<th>f</th>
<th>l</th>
<th>a</th>
<th>g</th>
<th>{</th>
<th>c</th>
<th>9</th>
<th>6</th>
<th>0</th>
<th>a</th>
<th>0</th>
<th>f</th>
<th>3</th>
<th>b</th>
<th>f</th>
<th>8</th>
</tr>
</thead>
<tbody><tr>
<td>7</td>
<td>1</td>
<td>d</td>
<td>7</td>
<td>d</td>
<td>a</td>
<td>2</td>
<td>a</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>3</td>
<td>a</td>
<td>e</td>
<td>7</td>
<td>8</td>
</tr>
<tr>
<td>f</td>
<td>7</td>
<td>b</td>
<td>5</td>
<td>f</td>
<td>}</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>flag{c960a0f3bf871d7da2a8413ae78f7b5f}</p>
<h3 id="crypto10"><a href="#crypto10" class="headerlink" title="crypto10"></a>crypto10</h3><p>Quoted-printable编码</p>
<p>解码格式为utf8</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/charsetquotedprintable">http://web.chacuo.net/charsetquotedprintable</a></p>
<h3 id="crypto0"><a href="#crypto0" class="headerlink" title="crypto0"></a>crypto0</h3><p>密文为gmbh{ifmmp_dug}</p>
<p>移位密码</p>
<h3 id="crypto12"><a href="#crypto12" class="headerlink" title="crypto12"></a>crypto12</h3><p>Atbash cipher(埃特巴什码)加密</p>
<h3 id="crypto13"><a href="#crypto13" class="headerlink" title="crypto13"></a>crypto13</h3><p>base混加密</p>
<h3 id="crypto14"><a href="#crypto14" class="headerlink" title="crypto14"></a>crypto14</h3><p>解出来这个东西.</p>
<p>3EP&#x2F;3VNFFmNEAnlHD5dCMmVHD5ad9uG</p>
<p>没思路了,看WP</p>
<p>flag经过base64编码后是ZmxhZw&#x3D;&#x3D;</p>
<p>现在把前四位对比一下 Zmxh和3EP&#x2F;，他们在base64的编码表中相差30，这一串也都是相差30个之后的结果</p>
<p>找到羽师傅的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#author 羽</span></span><br><span class="line">s= <span class="string">&#x27;3EP/3VNFFmNEAnlHD5dCMmVHD5ad9uG&#x27;</span></span><br><span class="line">t = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">l=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    l += t[(t.index(i)-<span class="number">30</span>)%<span class="number">64</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(l)%<span class="number">4</span>!=<span class="number">0</span>:</span><br><span class="line">    l=l+<span class="string">&quot;=&quot;</span>*(<span class="number">4</span>-(<span class="built_in">len</span>(l)%<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(l)</span><br></pre></td></tr></table></figure>

<h3 id="萌新-密码5"><a href="#萌新-密码5" class="headerlink" title="萌新_密码5"></a>萌新_密码5</h3><p>当铺密码</p>
<h3 id="easyrsa1-因式分解"><a href="#easyrsa1-因式分解" class="headerlink" title="easyrsa1-因式分解"></a>easyrsa1-因式分解</h3><p>利用<a target="_blank" rel="noopener" href="http://www.factordb.com/">factordb</a>在线分解n，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">q = 1201147059438530786835365194567</span><br><span class="line">p = 1212112637077862917192191913841</span><br></pre></td></tr></table></figure>

<h3 id="easyrsa2-欧几里得算法"><a href="#easyrsa2-欧几里得算法" class="headerlink" title="easyrsa2-欧几里得算法"></a>easyrsa2-欧几里得算法</h3><p>已知e,n1,c1,n2,c2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">23686563925537577753047229040754282953352221724154495390687358877775380147605152455537988563490716943872517593212858326146811511103311865753018329109314623702207073882884251372553225986112006827111351501044972239272200616871716325265416115038890805114829315111950319183189591283821793237999044427887934536835813526748759612963103377803089900662509399569819785571492828112437312659229879806168758843603248823629821851053775458651933952183988482163950039248487270453888288427540305542824179951734412044985364866532124803746008139763081886781361488304666575456680411806505094963425401175510416864929601220556158569443747</span></span><br><span class="line">c1 = <span class="number">1627484142237897613944607828268981193911417408064824540711945192035649088104133038147400224070588410335190662682231189997580084680424209495303078061205122848904648319219646588720994019249279863462981015329483724747823991513714172478886306703290044871781158393304147301058706003793357846922086994952763485999282741595204008663847963539422096343391464527068599046946279309037212859931303335507455146001390326550668531665493245293839009832468668390820282664984066399051403227990068032226382222173478078505888238749583237980643698405005689247922901342204142833875409505180847943212126302482358445768662608278731750064815</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">22257605320525584078180889073523223973924192984353847137164605186956629675938929585386392327672065524338176402496414014083816446508860530887742583338880317478862512306633061601510404960095143941320847160562050524072860211772522478494742213643890027443992183362678970426046765630946644339093149139143388752794932806956589884503569175226850419271095336798456238899009883100793515744579945854481430194879360765346236418019384644095257242811629393164402498261066077339304875212250897918420427814000142751282805980632089867108525335488018940091698609890995252413007073725850396076272027183422297684667565712022199054289711</span></span><br><span class="line">c2 = <span class="number">2742600695441836559469553702831098375948641915409106976157840377978123912007398753623461112659796209918866985480471911393362797753624479537646802510420415039461832118018849030580675249817576926858363541683135777239322002741820145944286109172066259843766755795255913189902403644721138554935991439893850589677849639263080528599197595705927535430942463184891689410078059090474682694886420022230657661157993875931600932763824618773420077273617106297660195179922018875399174346863404710420166497017196424586116535915712965147141775026549870636328195690774259990189286665844641289108474834973710730426105047318959307995062</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n1,n2) <span class="comment"># 欧几里得算法</span></span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="gmpy2-gcd-n1-n2"><a href="#gmpy2-gcd-n1-n2" class="headerlink" title="gmpy2.gcd(n1,n2)"></a>gmpy2.gcd(n1,n2)</h4><p><code>gmpy2.gcd(n1, n2)</code> 是求 n1 和 n2 的最大公约数的函数。</p>
<p>由此说来,p是n1,n2的最大公约数</p>
<h3 id="easyrsa3-欧几里得算法拓展"><a href="#easyrsa3-欧几里得算法拓展" class="headerlink" title="easyrsa3-欧几里得算法拓展"></a>easyrsa3-欧几里得算法拓展</h3><p>已知e,n1,c1,n2,c2且n相同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">e = 797</span><br><span class="line">n = 15944475431088053285580229796309956066521520107276817969079550919586650535459242543036143360865780730044733026945488511390818947440767542658956272380389388112372084760689777141392370253850735307578445988289714647332867935525010482197724228457592150184979819463711753058569520651205113690397003146105972408452854948512223702957303406577348717348753106868356995616116867724764276234391678899662774272419841876652126127684683752880568407605083606688884120054963974930757275913447908185712204577194274834368323239143008887554264746068337709465319106886618643849961551092377843184067217615903229068010117272834602469293571</span><br><span class="line">c = 11157593264920825445770016357141996124368529899750745256684450189070288181107423044846165593218013465053839661401595417236657920874113839974471883493099846397002721270590059414981101686668721548330630468951353910564696445509556956955232059386625725883038103399028010566732074011325543650672982884236951904410141077728929261477083689095161596979213961494716637502980358298944316636829309169794324394742285175377601826473276006795072518510850734941703194417926566446980262512429590253643561098275852970461913026108090608491507300365391639081555316166526932233787566053827355349022396563769697278239577184503627244170930</span><br><span class="line"></span><br><span class="line">e = 521</span><br><span class="line">n = 15944475431088053285580229796309956066521520107276817969079550919586650535459242543036143360865780730044733026945488511390818947440767542658956272380389388112372084760689777141392370253850735307578445988289714647332867935525010482197724228457592150184979819463711753058569520651205113690397003146105972408452854948512223702957303406577348717348753106868356995616116867724764276234391678899662774272419841876652126127684683752880568407605083606688884120054963974930757275913447908185712204577194274834368323239143008887554264746068337709465319106886618643849961551092377843184067217615903229068010117272834602469293571</span><br><span class="line">c = 6699274351853330023117840396450375948797682409595670560999898826038378040157859939888021861338431350172193961054314487476965030228381372659733197551597730394275360811462401853988404006922710039053586471244376282019487691307865741621991977539073601368892834227191286663809236586729196876277005838495318639365575638989137572792843310915220039476722684554553337116930323671829220528562573169295901496437858327730504992799753724465760161805820723578087668737581704682158991028502143744445435775458296907671407184921683317371216729214056381292474141668027801600327187443375858394577015394108813273774641427184411887546849</span><br></pre></td></tr></table></figure>

<p>观察到n相同,但e,c不同,为共模攻击.</p>
<p>共模攻击</p>
<p>使用相同的模数n,用不同的密钥e加密同一信息m</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = m^e1%n</span><br><span class="line">c2 = m^e2%n</span><br></pre></td></tr></table></figure>

<p>根据拓展的欧几里得算法,可以得到</p>
<p>e1s1 + e2s2 &#x3D; gcd(e1, e2) &#x3D; 1，s1、s2皆为整数，但是一正一负。(应该是相乘或者幂)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">所以(c1^s1*c2^s2)%n </span><br><span class="line">= ((m^e1%n)^s1*(m^e2%n)^s2)%n</span><br><span class="line">化简为</span><br><span class="line">((m^e1)^s1*(m^e2)^s2)%n</span><br><span class="line">=(m^(e1^s1+e2^s2))%n</span><br><span class="line">因为前面提到e1s1 + e2s2 = 1</span><br><span class="line">所以(c1^s1*c2^s2)%n = m%n</span><br><span class="line">最后得到c1^s1*c2^s2 = m</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">797</span></span><br><span class="line">n = <span class="number">15944475431088053285580229796309956066521520107276817969079550919586650535459242543036143360865780730044733026945488511390818947440767542658956272380389388112372084760689777141392370253850735307578445988289714647332867935525010482197724228457592150184979819463711753058569520651205113690397003146105972408452854948512223702957303406577348717348753106868356995616116867724764276234391678899662774272419841876652126127684683752880568407605083606688884120054963974930757275913447908185712204577194274834368323239143008887554264746068337709465319106886618643849961551092377843184067217615903229068010117272834602469293571</span></span><br><span class="line">c1 = <span class="number">11157593264920825445770016357141996124368529899750745256684450189070288181107423044846165593218013465053839661401595417236657920874113839974471883493099846397002721270590059414981101686668721548330630468951353910564696445509556956955232059386625725883038103399028010566732074011325543650672982884236951904410141077728929261477083689095161596979213961494716637502980358298944316636829309169794324394742285175377601826473276006795072518510850734941703194417926566446980262512429590253643561098275852970461913026108090608491507300365391639081555316166526932233787566053827355349022396563769697278239577184503627244170930</span></span><br><span class="line">e2 = <span class="number">521</span></span><br><span class="line">c2 = <span class="number">6699274351853330023117840396450375948797682409595670560999898826038378040157859939888021861338431350172193961054314487476965030228381372659733197551597730394275360811462401853988404006922710039053586471244376282019487691307865741621991977539073601368892834227191286663809236586729196876277005838495318639365575638989137572792843310915220039476722684554553337116930323671829220528562573169295901496437858327730504992799753724465760161805820723578087668737581704682158991028502143744445435775458296907671407184921683317371216729214056381292474141668027801600327187443375858394577015394108813273774641427184411887546849</span></span><br><span class="line"></span><br><span class="line">s = gmpy2.gcdext(e1,e2)<span class="comment"># 扩展欧几里得算法</span></span><br><span class="line">m1 = gmpy2.powmod(c1,s[<span class="number">1</span>],n)</span><br><span class="line">m2 = gmpy2.powmod(c2,s[<span class="number">2</span>],n)</span><br><span class="line"></span><br><span class="line">m = (m1*m2)%n   <span class="comment">#这里要注意,%是取余的意思</span></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>不是很理解<code>m = (m1*m2)%n</code>为什么%n,这是chatgpt给出的答案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在计算中，我们需要使用模运算符“%”来获得两个数相除的余数。在RSA算法中，我们需要进行大数运算，因此需要使用gmpy2库来处理大数。当使用gmpy2.powmod（）函数时，我们需要对结果进行取模操作，以确保结果在模数n范围内，因此要在最后一行代码中加上“%n”。</span><br></pre></td></tr></table></figure>

<h4 id="binascii-unhexlify"><a href="#binascii-unhexlify" class="headerlink" title="binascii.unhexlify()"></a>binascii.unhexlify()</h4><p><code>binascii.unhexlify()</code> 函数的返回值是一个字节串对象，表示由输入的十六进制字符串转换而来的二进制数据。</p>
<p>在 Python3 中，<code>binascii.unhexlify()</code> 函数还支持一个可选参数 <code>bytes</code>，它用于指定字节顺序。当 <code>bytes</code> 的值为 <code>&quot;big&quot;</code> 时，高位字节排在前面；当 <code>bytes</code> 的值为 <code>&quot;little&quot;</code> 时，低位字节排在前面。如果不指定 <code>bytes</code> 参数，则默认采用大端字节序。</p>
<h3 id="easyrsa4-低加密指数小明文攻击"><a href="#easyrsa4-低加密指数小明文攻击" class="headerlink" title="easyrsa4-低加密指数小明文攻击"></a>easyrsa4-低加密指数小明文攻击</h3><p>e很小，为低加密指数攻击<br>①m3&lt;n,也就是说m3&#x3D;c。<br>②m3&gt;n，即(m3+i·n)mod n&#x3D;c（爆破i）</p>
<p>已知e,n,c(低加密指数小明文攻击)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line">e = 3</span><br><span class="line">n = 18970053728616609366458286067731288749022264959158403758357985915393383117963693827568809925770679353765624810804904382278845526498981422346319417938434861558291366738542079165169736232558687821709937346503480756281489775859439254614472425017554051177725143068122185961552670646275229009531528678548251873421076691650827507829859299300272683223959267661288601619845954466365134077547699819734465321345758416957265682175864227273506250707311775797983409090702086309946790711995796789417222274776215167450093735639202974148778183667502150202265175471213833685988445568819612085268917780718945472573765365588163945754761</span><br><span class="line">c = 150409620528139732054476072280993764527079006992643377862720337847060335153837950368208902491767027770946661</span><br><span class="line">k=0</span><br><span class="line">while(gmpy2.iroot(c+k*n,e)[1]==False):</span><br><span class="line">    k += 1</span><br><span class="line">m=gmpy2.iroot(c+k*n,e)[0]</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<h4 id="gmpy2-iroot"><a href="#gmpy2-iroot" class="headerlink" title="gmpy2.iroot()"></a>gmpy2.iroot()</h4><p>求一个数开x次方</p>
<h3 id="easyrsa5"><a href="#easyrsa5" class="headerlink" title="easyrsa5"></a>easyrsa5</h3><p>已知e,n,c</p>
<p>e和n都很大，根据加密的过程，可以很容易爆破出d，为低解密指数攻击<br>爆破d脚本<a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> RSAwienerHacker</span><br><span class="line"></span><br><span class="line">e = <span class="number">284100478693161642327695712452505468891794410301906465434604643365855064101922252698327584524956955373553355814138784402605517536436009073372339264422522610010012877243630454889127160056358637599704871937659443985644871453345576728414422489075791739731547285138648307770775155312545928721094602949588237119345</span></span><br><span class="line">n = <span class="number">468459887279781789188886188573017406548524570309663876064881031936564733341508945283407498306248145591559137207097347130203582813352382018491852922849186827279111555223982032271701972642438224730082216672110316142528108239708171781850491578433309964093293907697072741538649347894863899103340030347858867705231</span></span><br><span class="line">c = <span class="number">350429162418561525458539070186062788413426454598897326594935655762503536409897624028778814302849485850451243934994919418665502401195173255808119461832488053305530748068788500746791135053620550583421369214031040191188956888321397450005528879987036183922578645840167009612661903399312419253694928377398939392827</span></span><br><span class="line"></span><br><span class="line">d = RSAwienerHacker.hack_RSA(e,n)</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<h3 id="easyrsa6"><a href="#easyrsa6" class="headerlink" title="easyrsa6"></a>easyrsa6</h3><p>由函数gmpy2.next_prime()可以看出两个质数挨得很近,，使用yafu分解n</p>
<p>当然<a target="_blank" rel="noopener" href="http://www.factordb.com/%E4%B9%9F%E8%83%BD%E8%B7%91%E5%87%BA%E6%9D%A5">http://www.factordb.com/也能跑出来</a></p>
<h4 id="gmpy2-next-prime"><a href="#gmpy2-next-prime" class="headerlink" title="gmpy2.next_prime()"></a>gmpy2.next_prime()</h4><p>‘’’生成两个挨得近的素数p，q’’’</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230302210214168.png" alt="image-20230302210214168"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2,libnum</span><br><span class="line">from Crypto.Util.number import getPrime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">p = 163515803000813412334620775647541652549604895368507102613553057136855632963322853570924931001138446030409251690646645635800254129997200577719209532684847732809399187385176309169421205833279943214621695444496660249881675974141488357432373412184140130503562295159152949524373214358417567189638680209172147385801</span><br><span class="line">q = 163515803000813412334620775647541652549604895368507102613553057136855632963322853570924931001138446030409251690646645635800254129997200577719209532684847732809399187385176309169421205833279943214621695444496660249881675974141488357432373412184140130503562295159152949524373214358417567189638680209172147385163</span><br><span class="line">n = p * q</span><br><span class="line">c=18343406988553647441155363755415469675162952205929092244387144604220598930987120971635625205531679665588524624774972379282080365368504475385813836796957675346369136362299791881988434459126442243685599469468046961707420163849755187402196540739689823324440860766040276525600017446640429559755587590377841083082073283783044180553080312093936655426279610008234238497453986740658015049273023492032325305925499263982266317509342604959809805578180715819784421086649380350482836529047761222588878122181300629226379468397199620669975860711741390226214613560571952382040172091951384219283820044879575505273602318856695503917257</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br><span class="line"># m = libnum.s2n(flag)</span><br><span class="line"># c = pow(m,e,n)</span><br><span class="line"># print(&quot;c =&quot;, c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="easyrsa7"><a href="#easyrsa7" class="headerlink" title="easyrsa7"></a>easyrsa7</h3><p>下载sagemath,要Linux,windows双系统</p>
<p>p损失掉了低位数据，用sagemath恢复p</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230303145613184.png" alt="image-20230303145613184"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import Crypto</span><br><span class="line">import binascii</span><br><span class="line">e = 0x10001</span><br><span class="line">p = 147305526294483975294006704928271118039370615054437206404408410848858740256154476278591035455064149531353089038270283281541411458250950936656537283482331598521457077465891874559349872035197398406708610440618635013091489698011474611145014167945729411970665381793142591665313979405475889978830728651549052207969</span><br><span class="line">n = 0x79e0bf9b916e59286163a1006f8cefd4c1b080387a6ddb98a3f3984569a4ebb48b22ac36dff7c98e4ebb90ffdd9c07f53a20946f57634fb01f4489fcfc8e402865e152820f3e2989d4f0b5ef1fb366f212e238881ea1da017f754d7840fc38236edba144674464b661d36cdaf52d1e5e7c3c21770c5461a7c1bc2db712a61d992ebc407738fc095cd8b6b64e7e532187b11bf78a8d3ddf52da6f6a67c7e88bef5563cac1e5ce115f3282d5ff9db02278859f63049d1b934d918f46353fea1651d96b2ddd874ec8f1e4b9d487d8849896d1c21fb64029f0d6f47e560555b009b96bfd558228929a6cdf3fb6d47a956829fb1e638fcc1bdfad4ec2c3590dea1ed3</span><br><span class="line">c = 0x1b2b4f9afed5fb5f9876757e959c183c2381ca73514b1918d2f123e386bebe9832835350f17ac439ac570c9b2738f924ef49afea02922981fad702012d69ea3a3c7d1fc8efc80e541ca2622d7741090b9ccd590906ac273ffcc66a7b8c0d48b7d62d6cd6dd4cd75747c55aac28f8be3249eb255d8750482ebf492692121ab4b27b275a0f69b15baef20bf812f3cbf581786128b51694331be76f80d6fb1314d8b280eaa16c767821b9c2ba05dfde5451feef22ac3cb3dfbc88bc1501765506f0c05045184292a75c475486b680f726f44ef8ddfe3c48f75bb03c8d44198ac70e6b7c885f53000654db22c8cee8eb4f65eaeea2da13887aaf53d8c254d2945691</span><br><span class="line">q = n//p</span><br><span class="line">phi = (q-1)*(p-1)#因为ed≡1(mod φ(n)),所以可以根据e,与φ(n)/*n的欧拉函数*/求e对于模φ(n)的逆元就是d</span><br><span class="line">#得到了d,我们就可以根据,m = c^d(mod n)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<h3 id="easyrsa8-公钥解析"><a href="#easyrsa8-公钥解析" class="headerlink" title="easyrsa8-公钥解析"></a>easyrsa8-公钥解析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A1E4D93618B8B240530853E87738403851E15BBB77421F9B2377FB0B4F1C6FC235EAEC92EA25BB76AC221DCE90173A2E232FE1511909C76B15251D4059B288E709C1EF86BCF692757AAD736882DD1E98BEDFED9311A3C22C40657C9A52880BDC4B9E539041D44D52CB26AD13AB086F7DC294D144D6633A62EF91CA1775EB9A09</span><br><span class="line"></span><br><span class="line">e=65537 </span><br></pre></td></tr></table></figure>

<h4 id="libnum-invmod-a-m"><a href="#libnum-invmod-a-m" class="headerlink" title="libnum.invmod(a,m)"></a>libnum.invmod(a,m)</h4><p><code>libnum.invmod(a, m)</code> 是一个函数，用于计算 $a$ 在模 $m$ 意义下的乘法逆元。</p>
<h4 id="RSA-importKey"><a href="#RSA-importKey" class="headerlink" title="RSA.importKey()"></a>RSA.importKey()</h4><p><code>RSA.importKey()</code>是<code>Crypto.PublicKey.RSA</code>模块中的一个方法，用于导入RSA密钥。该方法接收一个密钥字符串作为参数，返回一个<code>Crypto.PublicKey.RSA</code>对象，可以用于加密、解密、签名和验证操作。</p>
<h4 id="RSA-construct"><a href="#RSA-construct" class="headerlink" title="RSA.construct()"></a>RSA.construct()</h4><p><code>RSA.construct()</code> 是 PyCryptodome 库中用于构建 RSA 密钥对象的函数。它可以用来从给定的参数中创建一个新的 RSA 密钥对象。</p>
<p>也就是生成私钥,</p>
<h4 id="rsa-decrypt"><a href="#rsa-decrypt" class="headerlink" title="rsa.decrypt()"></a>rsa.decrypt()</h4><p><code>rsa.decrypt()</code> 是一个 RSA 解密函数，用于解密使用 RSA 公钥加密的数据。在 Python 中，通常使用 <code>pycryptodome</code> 模块的 <code>RSA</code> 类创建 RSA 密钥对，然后使用其中的 <code>decrypt()</code> 方法进行解密</p>
<h3 id="funnyrsa1"><a href="#funnyrsa1" class="headerlink" title="funnyrsa1"></a>funnyrsa1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e1 = 14606334023791426</span><br><span class="line">p1 = 121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span><br><span class="line">q1 = 130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span><br><span class="line">c1 = 11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span><br><span class="line"> </span><br><span class="line">e2 = 13813369129257838</span><br><span class="line">p2 = 121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span><br><span class="line">q2 = 94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span><br><span class="line">c2 = 7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span><br></pre></td></tr></table></figure>

<p>由题干可以发现,p相同,n和c不同,是N不互素的题型,但现在e也不同，则现在就应该联想到，我们可能需要去化简e，使两个e相同，进而不断的改变c。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">e1=<span class="number">14606334023791426</span></span><br><span class="line">e2=<span class="number">13813369129257838</span></span><br><span class="line">e3=math.gcd(<span class="number">14606334023791426</span>,<span class="number">13813369129257838</span>)</span><br><span class="line"><span class="built_in">print</span>(e3)</span><br></pre></td></tr></table></figure>

<p>运行该代码,可以发现他们的公因数是14,也就是2*7,分别约取14后,我们得到新的e1和e2.那么我们要开始对c进行转换成与e1,e2相应的数字,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line"> </span><br><span class="line">p1=<span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q1=<span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">e=<span class="number">1043309573127959</span></span><br><span class="line">c1=<span class="number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span></span><br><span class="line">n1=p1*q1</span><br><span class="line">phi_n=(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(e,phi_n)</span><br><span class="line">c1_14=<span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"> </span><br><span class="line">e2 = <span class="number">986669223518417</span></span><br><span class="line">p2 = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q2 = <span class="number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span></span><br><span class="line">c2 = <span class="number">7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span></span><br><span class="line">n2=p2*q2</span><br><span class="line">phi_n2=(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2=gmpy2.invert(e2,phi_n2)</span><br><span class="line">c2_14=<span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1_14)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2_14)</span><br></pre></td></tr></table></figure>

<p>这样我们就得到n&#x3D;14的c1,c2,此时由</p>
<p>m的14次&#x3D;c1(mod q1)</p>
<p>m的14次&#x3D;c2(mod q2)</p>
<p>根据中国剩余定理,得到m的14次&#x3D;c3(mod q1*q2)</p>
<p>这我们需要求解c3,就需要使用代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c3=libnum.solve_crt([c1,c2],[q1,q2])</span><br><span class="line">#m^14=c3(mod q1*q2)</span><br></pre></td></tr></table></figure>

<p>之后即可得到c3，因为此时的e&#x3D;14&#x3D;2<em>7，且7与（q1-1）</em>（q2-1）是互素的，因此可以再进行化简，重复第一个步骤的操作，就有e&#x3D;2的c&#x3D;1468508928650711840448592864366550012730179472363882262465351327446412035872207980397128114769992338577161</p>
<p>则现在e&#x3D;2，p&#x3D;q1，q&#x3D;q2，c也已知，即可求解m,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span>  libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line">c = <span class="number">1468508928650711840448592864366550012730179472363882262465351327446412035872207980397128114769992338577161</span></span><br><span class="line">p = <span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">q = <span class="number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="comment">#这里由于e太小了,不存在d = gmpy2.invert(e,phi),那么就可以对c进行的低加密指数攻击</span></span><br><span class="line"><span class="comment">#①m3&lt;n,也就是说m3=c。</span></span><br><span class="line"><span class="comment">#②m3&gt;n，即(m3+i·n)mod n=c（爆破i）</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(c, <span class="number">2</span>)[<span class="number">0</span>]).decode())</span><br></pre></td></tr></table></figure>

<h4 id="libnu-solve-crt"><a href="#libnu-solve-crt" class="headerlink" title="libnu.solve_crt()"></a>libnu.solve_crt()</h4><p><code>libnum.solve_crt()</code> 是一个 Python 库 <code>libnum</code> 中的函数，用于使用中国剩余定理（CRT）求解一组同余方程。给定一组模数和余数，该函数可以计算满足这些<strong>同余方程的唯一解</strong>。中国剩余定理在密码学中经常用于加速 RSA 加密和解密操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c3 = libnum.solve_crt([c1,c2],[q1,q2])#给定一组模数和余数，该函数可以计算满足这些**同余方程的唯一解**。</span><br></pre></td></tr></table></figure>

<h3 id="funnyrsa2"><a href="#funnyrsa2" class="headerlink" title="funnyrsa2"></a>funnyrsa2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.manongjc.com/detail/29-gzpftvniwvywcef.html</span><br></pre></td></tr></table></figure>

<p>发现n很小可以将n分解.因为常规rsa只有p和q，则phi &#x3D; (p -1) * (q - 1)，而现在有3个因子，所以phi &#x3D; (p - 1) * (q - 1) * (r - 1)。</p>
<h4 id="phi-x3D-p-1-q-1-r-1-的原因："><a href="#phi-x3D-p-1-q-1-r-1-的原因：" class="headerlink" title="phi &#x3D; (p - 1) * (q - 1) * (r - 1)的原因："></a>phi &#x3D; (p - 1) * (q - 1) * (r - 1)的原因：</h4><p> 根据欧拉函数，如果存在n可以分解成两个互质的整数之积，即</p>
<p>　　n &#x3D; p1 * q1</p>
<p>则存在这样的关系：</p>
<p>　　phi(n) &#x3D; phi(p1<em>q1) &#x3D; phi(p1) * phi(q1) &#x3D; （p1 - 1）</em> (q1 - 1)</p>
<p>举个例子：</p>
<p>n &#x3D; 56，则phi(56) &#x3D; phi(8 * 7) &#x3D; phi(8) * phi(7) &#x3D; 4 * 6 &#x3D;24</p>
<p>求解phi(8) 即是求1到8之中有多少个与8互质的数？分别为1,3,5,7。同理得到phi(7)&#x3D;6，即1,2,3,4,5,6都与7互质。</p>
<p>根据以上即知原因</p>
<p>而且网站分解出来的也是,3个</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230304200102083.png" alt="image-20230304200102083"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">r = getPrime(<span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">q1 = <span class="number">876391552113414716726089</span></span><br><span class="line">p1 = <span class="number">932470255754103340237147</span></span><br><span class="line">r1 = <span class="number">1098382268985762240184333</span></span><br><span class="line">n = <span class="number">897607935780955837078784515115186203180822213482989041398073067996023639</span></span><br><span class="line"><span class="comment">#n = p * q * r</span></span><br><span class="line"><span class="comment">#m = libnum.s2n(flag)</span></span><br><span class="line">c = <span class="number">490571531583321382715358426750276448536961994273309958885670149895389968</span></span><br><span class="line">phi = (q1-<span class="number">1</span>)*(p1-<span class="number">1</span>)*(r1-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(phi)</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="comment">#print(d)</span></span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="comment">#print(m)</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#c = pow(m,e,n)</span></span><br></pre></td></tr></table></figure>

<h3 id="funnyrsa3-dp泄露"><a href="#funnyrsa3-dp泄露" class="headerlink" title="funnyrsa3-dp泄露"></a>funnyrsa3-dp泄露</h3><p>已知e,n,dp,c,</p>
<p>刚开始还以为dp&#x3D;d*p.看了WP后发现<code>dp=d%(p-1)</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?dp=d%25(p-1)%5Crightarrow%20dp*e=d*e%25(p-1)%5Crightarrow%20dp*e=k*(p-1)&plus;d*e" alt="dp=d%(p-1)\rightarrow dp*e=d*e%(p-1)\rightarrow dp*e=k*(p-1)+d*e"></p>
<p>变换一下得到<img src="https://latex.codecogs.com/gif.latex?d*e=dp*e&plus;k*(p-1)" alt="d*e=dp*e+k*(p-1)"></p>
<p>在rsa中定义 <img src="https://latex.codecogs.com/gif.latex?d*e%5Cequiv%201%25%5Cvarphi%20(n)%5Crightarrow%20d*e%5Cequiv%201%25(p-1)*(q-1)" alt="d*e\equiv 1%\varphi (n)\rightarrow d*e\equiv 1%(p-1)*(q-1)"></p>
<p>所以 <img src="https://latex.codecogs.com/gif.latex?k*(p-1)&plus;dp*e=1%25(p-1)*(q-1)" alt="k*(p-1)+dp*e=1%(p-1)*(q-1)"></p>
<p>变换得到</p>
<p><img src="https://latex.codecogs.com/gif.latex?k1*(p-1)&plus;dp*e=k2*(p-1)*(q-1)&plus;1" alt="k1*(p-1)+dp*e=k2*(p-1)*(q-1)+1"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%5CRightarrow%20dp*e=(p-1)%5Bk2*(q-1)-k1%5D&plus;1" alt="\Rightarrow dp*e=(p-1)[k2*(q-1)-k1]+1"></p>
<p>我们令<code>X=[k2*(q-1)-k1]+1</code>,所以该式即为<code>dp*e=X*(p-1)+1</code></p>
<p>根据 <code>dp=d%(p-1)</code>可知，<code>dp</code>是余数，所以<code>dp&lt;p-1</code>,相应的<code>e&gt;X</code></p>
<p>所以我们爆破X在<code>(1，e)</code>之间，当X满足<code>(dp*e-1)%X==0</code>时，<code>p=(dp*e-1)//X+1</code></p>
<p>因为符合条件的x有很多，求出来的p不一定符合条件，所以需要进一步验证n%p&#x3D;0</p>
<p>上代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">13851998696110232034312408768370264747862778787235362033287301947690834384177869107768578977872169953363148442670412868565346964490724532894099772144625540138618913694240688555684873934424471837897053658485573395777349902581306875149677867098014969597240339327588421766510008083189109825385296069501377605893298996953970043168244444585264894721914216744153344106498382558756181912535774309211692338879110643793628550244212618635476290699881188640645260075209594318725693972840846967120418641315829098807385382509029722923894508557890331485536938749583463709142484622852210528766911899504093351926912519458381934550361</span></span><br><span class="line">dp = <span class="number">100611735902103791101540576986246738909129436434351921338402204616138072968334504710528544150282236463859239501881283845616704984276951309172293190252510177093383836388627040387414351112878231476909883325883401542820439430154583554163420769232994455628864269732485342860663552714235811175102557578574454173473</span></span><br><span class="line">c = <span class="number">6181444980714386809771037400474840421684417066099228619603249443862056564342775884427843519992558503521271217237572084931179577274213056759651748072521423406391343404390036640425926587772914253834826777952428924120724879097154106281898045222573790203042535146780386650453819006195025203611969467741808115336980555931965932953399428393416196507391201647015490298928857521725626891994892890499900822051002774649242597456942480104711177604984775375394980504583557491508969320498603227402590571065045541654263605281038512927133012338467311855856106905424708532806690350246294477230699496179884682385040569548652234893413</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):<span class="comment">#与上面说的一样,爆破X,使X满足(dp*e-1)%X==0时，p=(dp*e-1)//X+1</span></span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % x == <span class="number">0</span>:</span><br><span class="line">        p = (dp * e - <span class="number">1</span>) // x + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:<span class="comment">#因为符合条件的x有很多,所以还需要验证n%p=0</span></span><br><span class="line">            q = n // p</span><br><span class="line">            phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = gmpy2.invert(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="unusualrsa1-低位数据缺失"><a href="#unusualrsa1-低位数据缺失" class="headerlink" title="unusualrsa1-低位数据缺失"></a>unusualrsa1-低位数据缺失</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/ZBDX2113/article/details/123748836</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/919444c6e8b8488ea6e3c612f0721903.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAemFpZHVvemh1YW5saWFuZ3F1YW4=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>从文件中可以看出.它丢失了明文的后315位,而且部分信息条件已知,那我们就可以用上次在easyrsa7中用到的<strong>sagemath解题，</strong>脚本与上次的类似，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = 14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span><br><span class="line">mbar = 1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span><br><span class="line">c = 6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span><br><span class="line">e = 3</span><br><span class="line">kbits = 315</span><br><span class="line">PR. &lt; x &gt;= PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x) ^ e - c</span><br><span class="line">x0 = f.small_roots(X=2 ^ kbits, beta=1)[0]  # find root &lt; 2^kbits with factor = n</span><br><span class="line">print(x0)</span><br></pre></td></tr></table></figure>

<p>虽然去掉e一样出,但还是想知道e是怎么来的,因为去掉e之后会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">m2 = 61514818447540079794645696540635377371238400473636364474100415817811801375393480494308563648125</span><br><span class="line">m1= 1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span><br><span class="line">m =  m1+m2</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="unusualrsa2"><a href="#unusualrsa2" class="headerlink" title="unusualrsa2"></a>unusualrsa2</h3><p>已知c1,c2,n,得到了改题目中x,y的条件</p>
<h4 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h4><p><code>assert</code>是Python中的一个断言语句，用于检查代码逻辑是否正确，如果断言失败则会抛出一个<code>AssertionError</code>异常。</p>
<p>题目中的assert语句的作用是检查列表x中的每个元素i是否满足$(i-5)*i+6&#x3D;0$，如果每个元素都满足，则返回True，否则返回False。</p>
<p>在题目中的assert语句中得知，x&amp;y需要满足后面的方程，对后面的方程求解可得到第一组的x&amp;y为[2,3],第二组为[4,11]。</p>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reduce(function, iterable[, initializer])</span><br></pre></td></tr></table></figure>

<ul>
<li>function – 函数，有两个参数</li>
<li>iterable – 可迭代对象</li>
<li>initializer – 可选，初始参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, x, y</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(i-<span class="number">5</span>)*i+<span class="number">6</span>==<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> x]))</span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(j-<span class="number">15</span>)*j+<span class="number">44</span>==<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> y]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,x),<span class="number">17</span>,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,y),<span class="number">17</span>,n))</span><br><span class="line"><span class="comment">#23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span></span><br><span class="line"><span class="comment">#10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span></span><br><span class="line"><span class="comment">#17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x27;.&#x27; c1 = (2m+3)^17 mod n</span><br><span class="line">	c2 = (4m+11)^17 mod n</span><br><span class="line"></span><br><span class="line">令(2m+3)=x</span><br><span class="line"></span><br><span class="line">.&#x27;. c1 = x^17 mod n</span><br><span class="line">	c2 = (2x+5)^17 mod n</span><br></pre></td></tr></table></figure>

<p>从最后得到的c1,c2的公式可知，有一定的线性关系，是Related Message Attack。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io">Jinmu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/ctfs-crypto/">https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/ctfs-crypto/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jinmu1108.github.io" target="_blank">J1Nmu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/%E5%88%B7%E9%A2%98/">刷题</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Crypto%E9%A2%98%E7%9B%AE/qsn-crypto/qsn-crypto/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">qsn-crypto</div></div></a></div><div class="next-post pull-right"><a href="/%E9%9D%B6%E5%9C%BA/pikachu/pikachu/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">pikachu</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-18</div><div class="title">Crypto-AES题目</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/qsn-crypto/qsn-crypto/" title="qsn-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">qsn-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/" title="攻防世界-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-15</div><div class="title">攻防世界-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/" title="风二西RSA"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-10</div><div class="title">风二西RSA</div></div></a></div><div><a href="/Crypto/Crypto/" title="Crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-05</div><div class="title">Crypto</div></div></a></div><div><a href="/Python/Sage/sagemath%E7%9A%84%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/" title="sagemath的初步学习"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-09</div><div class="title">sagemath的初步学习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jinmu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-misc"><span class="toc-number">1.</span> <span class="toc-text">ctf-misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%90%8C%E6%96%B0%E8%B5%9B"><span class="toc-number">1.1.</span> <span class="toc-text">萌新赛</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%B1%E6%88%91"><span class="toc-number">1.1.1.</span> <span class="toc-text">抱我</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%88%E5%91%80-%E5%AE%8C%E4%BA%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">妈呀,完了</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto3"><span class="toc-number">1.2.1.</span> <span class="toc-text">crypto3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto4"><span class="toc-number">1.2.2.</span> <span class="toc-text">crypto4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto5"><span class="toc-number">1.2.3.</span> <span class="toc-text">crypto5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto6"><span class="toc-number">1.2.4.</span> <span class="toc-text">crypto6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto7"><span class="toc-number">1.2.5.</span> <span class="toc-text">crypto7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto8"><span class="toc-number">1.2.6.</span> <span class="toc-text">crypto8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto9"><span class="toc-number">1.2.7.</span> <span class="toc-text">crypto9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto10"><span class="toc-number">1.2.8.</span> <span class="toc-text">crypto10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto0"><span class="toc-number">1.2.9.</span> <span class="toc-text">crypto0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto12"><span class="toc-number">1.2.10.</span> <span class="toc-text">crypto12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto13"><span class="toc-number">1.2.11.</span> <span class="toc-text">crypto13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto14"><span class="toc-number">1.2.12.</span> <span class="toc-text">crypto14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%90%8C%E6%96%B0-%E5%AF%86%E7%A0%815"><span class="toc-number">1.2.13.</span> <span class="toc-text">萌新_密码5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa1-%E5%9B%A0%E5%BC%8F%E5%88%86%E8%A7%A3"><span class="toc-number">1.2.14.</span> <span class="toc-text">easyrsa1-因式分解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa2-%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.15.</span> <span class="toc-text">easyrsa2-欧几里得算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gmpy2-gcd-n1-n2"><span class="toc-number">1.2.15.1.</span> <span class="toc-text">gmpy2.gcd(n1,n2)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa3-%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%E6%8B%93%E5%B1%95"><span class="toc-number">1.2.16.</span> <span class="toc-text">easyrsa3-欧几里得算法拓展</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#binascii-unhexlify"><span class="toc-number">1.2.16.1.</span> <span class="toc-text">binascii.unhexlify()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa4-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B0%8F%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.17.</span> <span class="toc-text">easyrsa4-低加密指数小明文攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gmpy2-iroot"><span class="toc-number">1.2.17.1.</span> <span class="toc-text">gmpy2.iroot()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa5"><span class="toc-number">1.2.18.</span> <span class="toc-text">easyrsa5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa6"><span class="toc-number">1.2.19.</span> <span class="toc-text">easyrsa6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gmpy2-next-prime"><span class="toc-number">1.2.19.1.</span> <span class="toc-text">gmpy2.next_prime()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa7"><span class="toc-number">1.2.20.</span> <span class="toc-text">easyrsa7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa8-%E5%85%AC%E9%92%A5%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.21.</span> <span class="toc-text">easyrsa8-公钥解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#libnum-invmod-a-m"><span class="toc-number">1.2.21.1.</span> <span class="toc-text">libnum.invmod(a,m)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-importKey"><span class="toc-number">1.2.21.2.</span> <span class="toc-text">RSA.importKey()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-construct"><span class="toc-number">1.2.21.3.</span> <span class="toc-text">RSA.construct()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa-decrypt"><span class="toc-number">1.2.21.4.</span> <span class="toc-text">rsa.decrypt()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funnyrsa1"><span class="toc-number">1.2.22.</span> <span class="toc-text">funnyrsa1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#libnu-solve-crt"><span class="toc-number">1.2.22.1.</span> <span class="toc-text">libnu.solve_crt()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funnyrsa2"><span class="toc-number">1.2.23.</span> <span class="toc-text">funnyrsa2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#phi-x3D-p-1-q-1-r-1-%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%9A"><span class="toc-number">1.2.23.1.</span> <span class="toc-text">phi &#x3D; (p - 1) * (q - 1) * (r - 1)的原因：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funnyrsa3-dp%E6%B3%84%E9%9C%B2"><span class="toc-number">1.2.24.</span> <span class="toc-text">funnyrsa3-dp泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unusualrsa1-%E4%BD%8E%E4%BD%8D%E6%95%B0%E6%8D%AE%E7%BC%BA%E5%A4%B1"><span class="toc-number">1.2.25.</span> <span class="toc-text">unusualrsa1-低位数据缺失</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unusualrsa2"><span class="toc-number">1.2.26.</span> <span class="toc-text">unusualrsa2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#assert"><span class="toc-number">1.2.26.1.</span> <span class="toc-text">assert()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reduce"><span class="toc-number">1.2.26.2.</span> <span class="toc-text">reduce()</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Crypto-AES题目"/></a><div class="content"><a class="title" href="/Crypto%E9%A2%98%E7%9B%AE/Crypto-AES/Crypto-AES%E9%A2%98%E7%9B%AE/" title="Crypto-AES题目">Crypto-AES题目</a><time datetime="2023-03-18T02:50:47.035Z" title="发表于 2023-03-18 10:50:47">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/QSN-Web/QSNCTF-Web/" title="QSN-Web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="QSN-Web"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/QSN-Web/QSNCTF-Web/" title="QSN-Web">QSN-Web</a><time datetime="2023-03-18T02:50:03.099Z" title="发表于 2023-03-18 10:50:03">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/Bugku-Web/Bugku-Web/" title="Bugku-Web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Bugku-Web"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/Bugku-Web/Bugku-Web/" title="Bugku-Web">Bugku-Web</a><time datetime="2023-03-18T02:49:01.086Z" title="发表于 2023-03-18 10:49:01">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/%E5%88%86%E7%B1%BB%E7%BB%83%E4%B9%A0/%E8%A7%A3%E9%A2%98/" title="分类练习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分类练习"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/%E5%88%86%E7%B1%BB%E7%BB%83%E4%B9%A0/%E8%A7%A3%E9%A2%98/" title="分类练习">分类练习</a><time datetime="2023-03-18T02:48:08.158Z" title="发表于 2023-03-18 10:48:08">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB/" title="攻防世界-Web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="攻防世界-Web"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB/" title="攻防世界-Web">攻防世界-Web</a><time datetime="2023-03-18T01:41:31.101Z" title="发表于 2023-03-18 09:41:31">2023-03-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jinmu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>