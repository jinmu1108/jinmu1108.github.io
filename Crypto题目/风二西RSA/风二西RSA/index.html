<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>风二西RSA | J1Nmu</title><meta name="author" content="Jinmu"><meta name="copyright" content="Jinmu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RSA_基础篇P01 N分解12345678910111213import libnumimport gmpy2import uuidflag &amp;#x3D; &amp;quot;flag&amp;amp;#123;&amp;quot; + str(uuid.uuid4()) + &amp;quot;&amp;amp;#125;&amp;quot;m &amp;#x3D; libnum.s2"><link rel="shortcut icon" href="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg"><link rel="canonical" href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '风二西RSA',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-18 10:14:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">J1Nmu</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">风二西RSA</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-03-10T08:07:34.651Z" title="发表于 2023-03-10 16:07:34">2023-03-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-18T02:14:15.015Z" title="更新于 2023-03-18 10:14:15">2023-03-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/">Crypto题目</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/">风二西RSA</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="风二西RSA"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="RSA-基础篇"><a href="#RSA-基础篇" class="headerlink" title="RSA_基础篇"></a>RSA_基础篇</h1><h2 id="P01-N分解"><a href="#P01-N分解" class="headerlink" title="P01 N分解"></a>P01 N分解</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br></pre></td></tr></table></figure>

<p>根据题目可知,q,p比较接近</p>
<p>可以使用yafu,分解n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n= <span class="number">31053655688975728239712994649090225240109024940243383563826508010233960701069770671371348238309525292279456387515566802542866184341149632663574399720480909157492997307731713436047873091415054222937406703750090491664835804100715197923071558480475090014728034513880639613496006866653954863914038272001458697811100567202613806812996755863209463378421341292335427916257871121511087625749458477260088230838235493287353550411013727053910530147273578080056972432340954517480745186740940233088308868262262129821090823386435620976400039338951557000127838025702923288855027431123118908389003893783643127891695528860681290507259</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">19641035537751736017787370670604178798225996867402530732052760333544888635421970665848969371367176317395782572689469388329441307325394753138674846428101666766500288675725190951422506626638145409656569026566246273061806177385902529006762617916137192503005182989210537863828588049691967750671639546098470249778561847320994525378260739977823476134959988499440081301864155932100382747073636021100318117729717878523694751475759986650022796108226518124278098575013504113131892499915135953988363721277279583141172746979338143387363346820711004104840712948915400538980259501841140915011655057450194131796565530911341138910145</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">176220474658808385130335384102558685675760321798763558230157048455553667202409856516940822250343992640169172898123874907556515689733450365366821915070440936034741263082386320905452462907735277367406065154346047178105742269778534584180252814679837006336152991714091630332228634187688428481261118042909580367351</span></span><br><span class="line">p=<span class="number">176220474658808385130335384102558685675760321798763558230157048455553667202409856516940822250343992640169172898123874907556515689733450365366821915070440936034741263082386320905452462907735277367406065154346047178105742269778534584180252814679837006336152991714091630332228634187688428481261118042909580366109</span></span><br><span class="line">phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)<span class="comment">#求n的欧拉函数</span></span><br><span class="line">d = gmpy2.invert(e,phi)<span class="comment">#求e的模逆元</span></span><br><span class="line">m = gmpy2.powmod(c,d,n)<span class="comment">#求明文</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))<span class="comment">#因为libnum.n2s()的参数应该是数字,所以要用到int()</span></span><br></pre></td></tr></table></figure>

<h2 id="P02-密钥-OAEP"><a href="#P02-密钥-OAEP" class="headerlink" title="P02 密钥-OAEP"></a>P02 密钥-OAEP</h2><p>这个脚本好像哪里出了点问题</p>
<h2 id="P03-共模攻击"><a href="#P03-共模攻击" class="headerlink" title="P03-共模攻击"></a>P03-共模攻击</h2><p>n1,n2相同,共模攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发时间：2023/3/6 10:26</span></span><br><span class="line">n= <span class="number">29730698199679468499727430224118054548799367331860713421907882096049656912277332638835863514392073135178065305592966091814593295859358331779968774007105437630307076323413666842531442536798127016109750825423898658066140021050425117506684115383964302227347567240515985841826723205510646548962825764709886420739917525904566489242197398368608697539211704354293358946458701029743551034767761565758193520177113073883225984972843852401733996444018978419160288785568937281805301200857076931370053765104859058003879616859724686888220439987906381811433560266031380144673406256968550055935020639723861858325259316615729497707597</span></span><br><span class="line">e1= <span class="number">2333</span></span><br><span class="line">e2= <span class="number">23333</span></span><br><span class="line">c1= <span class="number">29159838828650245691952957202249689270789461475114899393172562644798252636618216794773514767042975659543741735950462104270847963311665686993810598455113030443458403735499757968408125256908327040233863481263807324291133926989394822384691881813949337754787183997070240045292065700405843431454009402275816914022525890969226680645907373255893658542825388777605571031385436034811017536640708402082488322821025081805184899129366104287437569914587905927293771649726537133959568244032171464556832604707827308847604383429960439270749962977428013222074613463068008912760347539379013399663989197438938045877837173015887101814406</span></span><br><span class="line">c2= <span class="number">9250699068088515744334081835958586397649097018262452822908391919263001154278644946652445934374332535470905356844628346425680198143991543461515656134853896910383559717696594801016429671600148279089995134607624420582073644908451120396771630122566808433851598543184447425840628953423277818634598203944695303532854662252506267771105779942429818544965335414589925680916744943687127414487610557214239135434403728258599058140046350678919400404025641934859141154951579391893120200778469811309734016993716689648243645499351995723472748868312808089756026026759557639000341729799076492486579271644202631207394793072389710570087</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">s = gmpy2.gcdext(e1,e2)<span class="comment">#扩展欧几里得算法</span></span><br><span class="line">m1 = gmpy2.powmod(c1,s[<span class="number">1</span>],n)</span><br><span class="line">m2 = gmpy2.powmod(c2,s[<span class="number">2</span>],n)</span><br><span class="line">m = (m1*m2)%n</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<h2 id="P04-维纳攻击脚本"><a href="#P04-维纳攻击脚本" class="headerlink" title="P04-维纳攻击脚本"></a>P04-维纳攻击脚本</h2><p>直接丢脚本</p>
<h2 id="P05-小e"><a href="#P05-小e" class="headerlink" title="P05-小e"></a>P05-小e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">1585551231667997674482398624956715920479587611424666886907613892881617614947917731473884589718717725889337506810009498700328132170825783083762862969236391315314925895194318222628193801325803591874368677445382852070090937059186832856162586394884332302923250699551313650886241</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">611225336238052629613097600790197795062812520487617492553504214302569103583606098328430752123205562839883760800517721221481625584618966378257921647376321867818163844290640646415167126783537625066322197443463089971241250910454496764525356579142703109323111393498946922350818</span></span><br><span class="line"></span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> Ture:</span><br><span class="line">    m1 = c*k+c</span><br><span class="line">    m,t = gmpy2.iroot(m1,e)</span><br><span class="line">    <span class="keyword">if</span> t:</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">     k += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>给的exp.py中的n,e,c直接就能跑出来,但题目中的要跑好久</p>
<h2 id="P06-广播攻击"><a href="#P06-广播攻击" class="headerlink" title="P06-广播攻击"></a>P06-广播攻击</h2><p>如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信息，那么可以进行广播攻击得到明文。</p>
<p>在CTF中，n、c不同，明文m，e相同，其e比较小。使用中国剩余定理求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">n1 = <span class="number">16655230929893303490818415854457831426545038662809855283873228642358207995734291242944120042612699642460820594813654718158395826755230956722936107927889550129166619245152453353908373751380196656611349200623414836128383308653618062999595622747482867683840133843768870236300348203389275090871132570173650238774275209757683812077533989960172822335488251744796657926473009279723460304257252876756936524918018903158795894385111046938638194925881670388700872760201130485273663156422785999102754192840209476417602399017445296045070405343876349687582470436774316410697773759057621576657298096301937899052773787116133124199739</span></span><br><span class="line">n2 = <span class="number">17197151926745749646602149115445210421300330711044282276861045275221683290586877554048509794473112203880585601275129330843554946888863132721219683639579200702355880529569042889789589005950061966309684759066705732225014741164779016525568884409690021988879475589545329149547046975086877521757237117008484775731784935960191717287332176327498377273179740487245459081737196777751408106728622513560888261855065717079007065635401835089216224111969668029246916986663313301660909538148574652809266532053889578734157117390082522831069594417637550812101652367765364077901612478983024721669687150628356918237152414368862535409859</span></span><br><span class="line">n3 = <span class="number">18719461901666732419189610536735130974364055134601694187780706398369536769336080321122034942831217438281120989017698755904233940669427542442488330152862658754609065361849067002424120904308655036927580582916373684567047102601602588472175947665724244201887952599804681827419266055359412641159981152796138695901074514583606207162167385730873921563442166111892785482387108299191119048884993267729877797586421940344366636285656854837470348603688925980178978612114344024951042846249621559376348599687263736342957456838732355009637030035658212442442824658869094581324944034490700706979663405137522294780606800571433058912041</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">3530761236149189046680124371485374220252032991305088864647979778627799354583229731576585900490173357726425570018182390597284149666834264690795437972634538596441103368165128688664787322126097802985602065455316693754513332761284857157982201975554297034291092099307950246864758375115838291339394148547902128382917596947095456178572561422004708150053706114994560773293625641699691472764190426577272488084620105693964419578988589192873196530900413833531923536786853211065167782657153004342018675666293830194703777994380600060782651326623229047839109994778831432598543154184891096335217588164509636922274833553782288823349</span></span><br><span class="line">c2 = <span class="number">7557835478962501903223351987016911891266554255050134264644805724502475848487138948948076311894495847429608136390014902405718084026208891531815323418707377349405409096779206918831458396991602033494429461919844309109113047361743133772636443322195238900874786548606687215969337920658068807801603115402783849082788527952834594443136756890747461628705174983562847145588532659589787532039981477468881131005056101092222499397893730056830156407331988257383965698358904379729558105489119604343081747549319382873235286788453435066434264212954607441597606413293491628299838317713381567250093086011058119721189087729804152444980</span></span><br><span class="line">c3 = <span class="number">8471234074077377509408346140986116360421840978074779990698043926601850838824365885362094731657766299393262223086536737448516669969503891677808275285733096884405583100485903641986516527279324847718603091709062689898441711907846902050004165404073776422495381050861998133576074526490209080137421773440295749900582039873013319584167081936219517593826232230971430937112005615502869367413205660317010303160932970748420125111225082886082306332340892549579826854620461821084886193470846195356695313518639669516456574134135244251956477677377976434266541164893562226872334598362396368708087248848222008201970781942468960022694</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCRT</span>(<span class="params">m, a</span>):</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">len</span>(m) == <span class="built_in">len</span>(a))</span><br><span class="line">    curm, cura = m[<span class="number">0</span>], a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> m, a <span class="keyword">in</span> <span class="built_in">zip</span>(m[<span class="number">1</span>:], a[<span class="number">1</span>:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>)</span><br><span class="line">        K = c // d * gmpy2.invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">    <span class="keyword">return</span> cura % curm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [n1, n2, n3]</span><br><span class="line">c = [c1, c2, c3]</span><br><span class="line">mm = libnum.solve_crt(c, n)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>, <span class="number">20</span>):</span><br><span class="line">    m, t = gmpy2.iroot(mm, e)</span><br><span class="line">    <span class="keyword">if</span> t:</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># import libnum</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># e = 13</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # def phase5(n1, c1, n2, c2, n3, c3):</span></span><br><span class="line"><span class="comment"># #     r = CRT([c1, c2, c3], [n1, n2, n3])</span></span><br><span class="line"><span class="comment"># #     m = int(r) ^ (1 / 13)</span></span><br><span class="line"><span class="comment"># #     print(libnum.n2s(int(m))</span></span><br><span class="line"><span class="comment"># # phase5(n1, c1, n2, c2, n3, c3)</span></span><br></pre></td></tr></table></figure>

<h2 id="P07-N不互素"><a href="#P07-N不互素" class="headerlink" title="P07-N不互素"></a>P07-N不互素</h2><h3 id="题目一"><a href="#题目一" class="headerlink" title="题目一"></a>题目一</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q1 = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q2 = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1=&quot;</span>, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2=&quot;</span>, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>, c2)</span><br><span class="line"><span class="comment"># n1= 14333488130902901156035897492560764192366312863448854688345982467428019886252404061181525914129813822680284970130688170385052559594255059651096385056272208541523069827892343813872258770322371250830933001289365306724557427658848710372970412684133003905153705052964699537685544310551986417565653504425612994578898919971245494211231237054614895483661693909720064120402733231043230092975822433465435830927095668806287564758790215107177578177832729188339696118541063553238015850571935777354075185938393392606083110479008997425365835860392602574976901797080985946268093476278046422404334251684235376484351608521231647383949</span></span><br><span class="line"><span class="comment"># n2= 20947788705608879441525321933647419276298098489388639921018312164918311682781189225111888544507711801833599660898569248229243166764093437986863857219496610373763523790744462002390131188080070615554953230710012503260768752866874323657152108203208472995118505362576931204548898507201951574846546573753619710080551883719750892606014821239300983933787920827834064795867594894393011958937902982578462921883682529050170551234429109908565660373287055152902793269631143251289394439478467993856087360573469317457272724324422787726094174936544331448491968028714741077391640460372254764836098786242517029108958831039832454796099</span></span><br><span class="line"><span class="comment"># c1= 13563732668248102338221174020700003296958765176782672417406335980283100524153649730699083068460866712054196296056195138082794923310538024640125566191236784530016919701811859147123325285371624792099087932367957781856681208602987032813983455797078061298455774825785153034420321321964705279345359060568625778913514284748723756772811815677010754623887077003224690208654032554500619946367271220155982138480852422480507289758266266573621759275833058082175842453989746033177226545566093811937786020011471336141681886876279670500224398280931659438377228872575936344194417276100347008373282914761604321503525556980300469135876</span></span><br><span class="line"><span class="comment"># c2= 6724353938813326886625873903895246013508024041165291557686897821599702213368470619731270608339555076289893859805758904458772079007822115548446181305082697920777630653160310859015508886280158457721010926396608499502645581741424013921508110367712961830705509139805939288233428282561834053875258817063669821650371570942432108716307498027108036577554240186209148714300797405705975219319832168530130952015912621447004460329178531634912614133585505034296585902787444390438674418163929681469661712754193739564875699217958317677222101879174347684739525352387846201954847546735174169195938215360959678474267085727371972677347</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>已知n1.n2,c1,c2,e’</p>
<p>通过n1,n2的最大公约数求p.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p=gmpy2.gcd(n1,n2)<span class="comment">#求n1n2最大公约数</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">q1=n1//p</span><br><span class="line">phi=(q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h4 id="为什么p是n1-n2的最大公约数呢"><a href="#为什么p是n1-n2的最大公约数呢" class="headerlink" title="为什么p是n1,n2的最大公约数呢?"></a>为什么p是n1,n2的最大公约数呢?</h4><p>由于p和q是质数，因此它们没有除了1和它们自身以外的公因子。因此，如果p是n1和n2的最大公约数，那么q1和q2必须是互质的，否则p就不可能同时是n1和n2的最大公约数。</p>
<p>因此，在RSA算法中，如果两个不同的质数p和q被用来构造n1和n2，那么p必须是n1和n2的最大公约数，否则无法正确解密加密的信息。这也是为什么p&#x3D;gmpy2.gcd(n1,n2)的原因。</p>
<h3 id="题目二"><a href="#题目二" class="headerlink" title="题目二"></a>题目二</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m1 = libnum.s2n(flag[:<span class="number">21</span>])</span><br><span class="line">m2 = libnum.s2n(flag[<span class="number">21</span>:])</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q1 = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q2 = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1=&quot;</span>, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2=&quot;</span>, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>, c2)</span><br><span class="line"><span class="comment"># n1= 19639688685700695943620271451175391701573647748342127825369582257930058915059338994885845859229863596184973920303646940575402907721897727987266714193753223057437605679742372709930541352792702658784848211369044064071540934030577757865529574000929584959299468945749005978527106144963464000680829288669705311136095411695446004026078618858830688221093639818709315228722943404520049290897534060403513468598254184530766156517276509099290255633067299007912053690793552521066094308569388744229757232445274006738190636174849625956743225900539736611380440362152304730227383628413854084520245848941045286583500040538179315372919</span></span><br><span class="line"><span class="comment"># n2= 18617433081545400126323473302253791488613209593998797962470914259762631925727385159434067903281611275841497831993421467080916899739741777356774394082725574949953045670868633826852222253561053584180748596654762990119577412949706451630867293784902084603002904525379677263953666121366484938203449707831527308394991173622217345153016817804382584787092362515679384275396405251953956268446163564143316170236292535797151100990593024818443293818693723604328087714095349065352542650782723592179090220366803960304539000417162739042766484189799311834806890204020023680433106416513759917653715887154448375102462144516041950631757</span></span><br><span class="line"><span class="comment"># c1= 12644725828813202228479096368147210787917639386581938723972412778986245956128260566101578135326644477135947001672712232656083693304338414411333912593263936045019314363320983057285470739682013957624397569456773901114136426854753890801266122471962530785473113865021209054608090078831462275798505440369369145060112147299353762092532068651270919566529509530066537118815951623006608539235722703934217558025273331053644223326578558365499543297794559569478507351633175546347532602006966788221525635971742249463542811772868468304329554506559777431305592261777732289652880726595058385487439807826658502172989415216749823414640</span></span><br><span class="line"><span class="comment"># c2= 14745359453761453819833400635671733791509739139425965285473046462021582882164910239223212519141341987067943344941188855518281715193670437838824185544831189338593226496470901500198181792389759346405619523582983052188039847841205580425101095385089072007366571879956030100859351215645675680123428236276599415684738829307825368206734653015568531205411153205204903826637250330829543900041296223113694457069153659283128958989416291825389677831368482464595746348198147197735825591852153753264339417946658532599475370323318993913452200949955693903431091543592391495589354570821048856987603021030175044062998690008452089357858</span></span><br></pre></td></tr></table></figure>

<p>就是明文变为两段了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n1= <span class="number">19639688685700695943620271451175391701573647748342127825369582257930058915059338994885845859229863596184973920303646940575402907721897727987266714193753223057437605679742372709930541352792702658784848211369044064071540934030577757865529574000929584959299468945749005978527106144963464000680829288669705311136095411695446004026078618858830688221093639818709315228722943404520049290897534060403513468598254184530766156517276509099290255633067299007912053690793552521066094308569388744229757232445274006738190636174849625956743225900539736611380440362152304730227383628413854084520245848941045286583500040538179315372919</span></span><br><span class="line">n2= <span class="number">18617433081545400126323473302253791488613209593998797962470914259762631925727385159434067903281611275841497831993421467080916899739741777356774394082725574949953045670868633826852222253561053584180748596654762990119577412949706451630867293784902084603002904525379677263953666121366484938203449707831527308394991173622217345153016817804382584787092362515679384275396405251953956268446163564143316170236292535797151100990593024818443293818693723604328087714095349065352542650782723592179090220366803960304539000417162739042766484189799311834806890204020023680433106416513759917653715887154448375102462144516041950631757</span></span><br><span class="line">c1= <span class="number">12644725828813202228479096368147210787917639386581938723972412778986245956128260566101578135326644477135947001672712232656083693304338414411333912593263936045019314363320983057285470739682013957624397569456773901114136426854753890801266122471962530785473113865021209054608090078831462275798505440369369145060112147299353762092532068651270919566529509530066537118815951623006608539235722703934217558025273331053644223326578558365499543297794559569478507351633175546347532602006966788221525635971742249463542811772868468304329554506559777431305592261777732289652880726595058385487439807826658502172989415216749823414640</span></span><br><span class="line">c2= <span class="number">14745359453761453819833400635671733791509739139425965285473046462021582882164910239223212519141341987067943344941188855518281715193670437838824185544831189338593226496470901500198181792389759346405619523582983052188039847841205580425101095385089072007366571879956030100859351215645675680123428236276599415684738829307825368206734653015568531205411153205204903826637250330829543900041296223113694457069153659283128958989416291825389677831368482464595746348198147197735825591852153753264339417946658532599475370323318993913452200949955693903431091543592391495589354570821048856987603021030175044062998690008452089357858</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line">phi_1=(q1-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">phi_2=(q2-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(e,phi_1)</span><br><span class="line">d2=gmpy2.invert(e,phi_2)</span><br><span class="line">m1=<span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">m2=<span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m1)))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m2)))</span><br></pre></td></tr></table></figure>

<h2 id="P08-dp泄露"><a href="#P08-dp泄露" class="headerlink" title="P08-dp泄露"></a>P08-dp泄露</h2><p>已知</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c= m^e mod n</span><br><span class="line">m= c^d mod n</span><br><span class="line">ϕ(n)=phi= (q-1)*(p-1)</span><br><span class="line">d*e ≡d mod (p-1)</span><br><span class="line">dp=d mod (p-1)</span><br></pre></td></tr></table></figure>

<p>得:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dp*e=d*e mod (p-1)</span><br></pre></td></tr></table></figure>

<p>得:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">式1: d*e=k+(p-1)+dp*e</span><br><span class="line">式2: d*e=1 mod ϕ(n)</span><br></pre></td></tr></table></figure>

<p>式1带入式2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=&gt; k∗(p−1)+dp∗e ≡1 mod ϕ(n)</span><br><span class="line"></span><br><span class="line">=&gt; k∗(p−1)+dp∗e ≡1 mod (p−1)∗(q−1)</span><br><span class="line"></span><br><span class="line">=&gt; k1∗(p−1)+dp∗e = k2*(p−1)∗(q−1)+1</span><br><span class="line"></span><br><span class="line">=&gt; dp*e =  k2*(p−1)∗(q−1)+1-k1∗(p−1)+dp∗e</span><br><span class="line"></span><br><span class="line">=&gt; dp*e = (p-1)*[k2*(p-1)-k1]+1</span><br></pre></td></tr></table></figure>

<p>‘.’ dp&lt;p−1</p>
<p>.’. e &gt; k2∗(q−1)−k1</p>
<p>假设 x&#x3D;k2∗(q−1)−k1</p>
<p>x的范围为 (0,e)</p>
<p>x∗(p−1)+1&#x3D;dp∗e</p>
<p>求出p-1方法，遍历(0,e)的范围，其中肯定有一个p可以被n整除，那么就能求出p和q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">15490329974794812647207350945845678224681604428642220566423366180973839697096441619340018253695472604335938643849069014103520861300713053955205392905536446156153192076633656788424185734898016745641378430506574498111680248029123341493733599302123100131134215957579162168779228208387783035893621162016993340603475960735061572761512755519616410410615413820180757126318567325096339342686253738778178380191340135516056457473854126752188188261914055391966730674861017432904735293451031131827880629989269835970170038295168392442835892108945315382078025510997711116410638765048886317360842562784200384045644008789130370444983</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">dp= <span class="number">92421914522602787051376990773545034723755500322946639408033747477366773088952064561196722681757327451210117825346237003629597066505402384880737033044776720946764227004188812078355462119361676746112866393394866072449432108301690846327127554699521545673830710939287951837844749172755258073462248214264511338895</span></span><br><span class="line">c= <span class="number">11917967705200196530423914441613144297148147672566202863977167024519218321836386637302409557947445841293888462405994683655441879000427977086221906497225533946193332303182079068462781262341197088906792898634398410298474823088739257515556595214077227746604247505450334512424047100626106474291190033258919062850451435841454816600402372026810570127115167968899329724894556092798669018218440148846597174016217159034241427361756697433952800424383010684502324285145303400856470193420837017178412747680690628590204528459258189973779463979907863227915782407651254796209362605706066438960631045833533860845111845422613428738602</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">65535</span>):</span><br><span class="line">    p=(dp*e-<span class="number">1</span>)//i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">        q=n//p</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">phi_n= (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag=libnum.n2s(<span class="built_in">int</span>(m)).decode()</span><br><span class="line"><span class="built_in">print</span>(flag) </span><br><span class="line"></span><br><span class="line">作者：风二西 https://www.bilibili.com/read/cv13406755/?<span class="keyword">from</span>=readlist 出处：bilibili</span><br></pre></td></tr></table></figure>



<h2 id="P09-dp-dq"><a href="#P09-dp-dq" class="headerlink" title="P09-dp,dq"></a>P09-dp,dq</h2><p>首先根据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m=c^d mod n</span><br><span class="line"></span><br><span class="line">gcd(p,q)=1</span><br><span class="line">n=p∗q</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>利用中国剩余定理,得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m1=c^d mod p</span><br><span class="line">m2=c^d mod q </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">已知条件</span><br><span class="line">c = m^e mod n</span><br><span class="line">m = c^d mod n</span><br><span class="line">ϕ(n)= (p−1)*(q−1)</span><br><span class="line">d*e≡1 mod ϕ(n)</span><br><span class="line">dp=d mod (p-1)</span><br><span class="line">dq=d mod (q-1)</span><br><span class="line"></span><br><span class="line">m=c^d mod n</span><br><span class="line">m=c^d+k*n</span><br><span class="line"></span><br><span class="line">&#x27;.&#x27; n=q*p</span><br><span class="line">m=c^d+p*q*k</span><br><span class="line"></span><br><span class="line">同时取余q和p</span><br><span class="line"></span><br><span class="line">&#x27;.&#x27; m1=c^d mod q 所以</span><br><span class="line">式1 c^d=kp+m1</span><br><span class="line"></span><br><span class="line">式2 m2=c^d mod p</span><br><span class="line"></span><br><span class="line">式1带入式2</span><br><span class="line">m2=(kp+m1) mod q</span><br><span class="line"></span><br><span class="line">等式两边同时减去m1</span><br><span class="line">(m2-m1)*p≡kp mod q</span><br><span class="line"></span><br><span class="line">因为gcd(p,q)=1</span><br><span class="line">所以可以求p的逆元,得到</span><br><span class="line">(m2-m1)*p-1≡k mod q</span><br><span class="line"></span><br><span class="line">得到如下两个式子</span><br><span class="line">k≡(m2-m1)*p-1 mod q</span><br><span class="line"></span><br><span class="line">c^d=kp+m1</span><br><span class="line">m≡c^d mod n</span><br><span class="line"></span><br><span class="line">上下两个式子合并</span><br><span class="line"></span><br><span class="line">c^d = ((m2−m1)*p−1 mod q)p+m1</span><br><span class="line">m ≡ c^d mod n</span><br><span class="line"></span><br><span class="line">最后可以有</span><br><span class="line"></span><br><span class="line">m≡(((m2−m1)*p−1 mod q)p+m1) mod n</span><br><span class="line"></span><br><span class="line">只剩最后一步了</span><br><span class="line"></span><br><span class="line">m1≡cd mod q</span><br><span class="line">m2≡cd mod p</span><br><span class="line"></span><br><span class="line">m1和m2怎么求</span><br><span class="line"></span><br><span class="line">d≡dp mod (p−1)</span><br><span class="line">d≡dq mod (q−1)</span><br><span class="line"></span><br><span class="line">那么分别带入</span><br><span class="line"></span><br><span class="line">m1≡cdq mod (q−1) mod q</span><br><span class="line">m2≡cdp mod (p−1) mod p</span><br><span class="line"></span><br><span class="line">费马小定理即假如p是质数，且gcd(a,p)=1</span><br><span class="line">a^(p−1)≡1 mod p</span><br><span class="line"></span><br><span class="line">所以如果我们有等式</span><br><span class="line"></span><br><span class="line">d=dp+k*(p−1)</span><br><span class="line"></span><br><span class="line">直接带入</span><br><span class="line">m2≡c^dp+k*(p−1) mod p</span><br><span class="line"></span><br><span class="line">这里的指数，我们拆开，为</span><br><span class="line">m2≡c^dp*ck*(p−1) mod p</span><br><span class="line"></span><br><span class="line">ck*(p−1)≡1 mod p</span><br><span class="line"></span><br><span class="line">因为p是大素数，显然和c互素所以可以直接得到</span><br><span class="line">m2≡cd^p mod p</span><br><span class="line"></span><br><span class="line">那么m1根据对称性也可以同理得到</span><br><span class="line"></span><br><span class="line">m1≡cd^q mod q</span><br><span class="line"></span><br><span class="line">故此，我们现在拥有了所有条件，下面归纳一下为</span><br><span class="line"></span><br><span class="line">m1≡cd^q mod q</span><br><span class="line">m2≡cd^p mod p</span><br><span class="line">m≡(((m2−m1)*p−1 mod q)p+m1) mod n</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">d= 7712186834153480308296034244826109114172403535762371556490883045629263724578659598244169384301206881145065736399216186565624521914661049384360186335639125</span><br><span class="line">p= 87865868602275656708871983687147210697166615184581778200336563325268969447743</span><br><span class="line">q= 112041668981330609440547894795721203169209651817980071558573082325848473964143</span><br><span class="line">c= 155687336266245927541891535611088239250506292753980975572030793447786087776191305895656693036702395382793086947958293399040386519071417581343610960602528</span><br><span class="line">dp= 68963250517476467183285122860360990338905600681516052109021043751242584348581</span><br><span class="line">dq= 26596155520432126753842922308574313101048179705087446377416138086015910240935</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decrypt(dp, dq, p, q, c):</span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = pow(c, dp, p)</span><br><span class="line">    mq = pow(c, dq, q)</span><br><span class="line">    m = (((mp - mq) * InvQ) % p) * q + mq</span><br><span class="line">    print(mp - mq)</span><br><span class="line">    print(libnum.n2s(int(m)).decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decrypt(dp, dq, p, q, c)</span><br><span class="line">#</span><br><span class="line"># m=pow(c,dp,p)</span><br><span class="line"># m=pow(c,dq,q)</span><br><span class="line"># #前提就是 m&lt;p,m&lt;q</span><br><span class="line"># print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<p>第一遍确实看不下去,就像早八上高数一样,越看越困,还想要看,这时不妨睡一觉,(但是上课实在是不敢睡啊,)</p>
<h2 id="P10-N是p的r次方"><a href="#P10-N是p的r次方" class="headerlink" title="P10-N是p的r次方"></a>P10-N是p的r次方</h2><h3 id="题目一-1"><a href="#题目一-1" class="headerlink" title="题目一"></a>题目一</h3><p>先看</p>
<p><img src="https://i0.hdslb.com/bfs/article/b6423b7a5d301c5bc141a453312c914fa8d73386.png@942w_671h_progressive.webp" alt="img"></p>
<p>先用yafu分解n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n= <span class="number">164794610894847732199962035704828357808895629332543800925670463107161053012888244002459861064458618880609591532051973390145417523020751828811842128620974619752132819410952026223453296586513137434477453400587571269458421538422073093945823066479835378033936687531855545943436883278879745566018879520048718927516864991774600223643927207338305608999726840411406302352268242118272599035029560365796747685127556215813777919949660663180259645089239105326214860312329155390022643671801372546302194410638800418846353671201721562086571624958247788512739149868122630034903783870319438956073985413058467647752763953499296274711245502478111343128338945469680953333210957636363472448638367455247254996937053596025267221639466776784325633015548289120382452059574874118797763005586865201</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">135489041003481716094510287327457660165958881619943381022668568884712513305206132660182378301663013228764247829089434558372725262269414899148029611056642349951724895842241782384069215028690346607585181649721997297256346787569106679387766043877750232083584272328827785026094081119480160178409445473108720642330458699310836818128130716425471180749052344392739942700864344506197825859349521845476770469142365143298808273900947314817194823408216442767054281460680789550415587153091355568826781171583633239882034919920194772230452251929713750811805711323425276623022537801317558885218853488138903768918278758957128370027218488263433200272294652994401349538318523628900818309390617929993002284488119230166163344128006431802487839082370713102815372547537722417255057044597161073</span></span><br><span class="line"><span class="comment"># n=p**5</span></span><br><span class="line">p=<span class="number">11050669772340945995391805522879944871406511054003410484264044524754506425936799132821144573587752207787582773236736338627483886104512759591893920105033841</span></span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>) * p ** <span class="number">4</span></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h3 id="题目二-1"><a href="#题目二-1" class="headerlink" title="题目二"></a>题目二</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">n = p ** <span class="number">3</span> * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">q= 12310008438726879514213245958868805289802288650741316549643300996451724899358706526821240605880270693780630242586490929068009217096678603311116233819524251</span><br><span class="line">n= 16477187428593265303147360050581542947524313037926797987623812382570748242904554097857438896867586227421553129827621780871358019802226910727733328697113639962560876704624345222929372305919350416174089544566779936499951756312501180113458459963177284162761765229049275081842403441758415788668756862325730723716789232361150218976645213867627191327548652256716395651879284502079858300184150104944453497610412735140508863395065138709317282349906258374744970922883723480097676285968924304534323077576054282353508152920218129054654590781728990812075876817204161522883045593830596003537843105755379040498301786127078862584301</span><br><span class="line">e= 65537</span><br><span class="line">c= 3503642260356652709146238922524109958662904294960783002538080801812541066250054630388703111044476880736735293050981870188607423172569755787773844187968864154401877571841369405863039776168640398733652271901481011355613616501604253550518955798401688325758978229452917509250185446638440621370577787448830406012774098110626674643982237894594465314330430762197891518623179154817196804080833204022705250457312130649066549323662149979536277571713088400138622066675299398196616223928338380906509470745484038194668076044760702606468578463116759918532282316278957123919740093210668468418632533600987055894537005139535754057717</span><br><span class="line">#print(n//q)</span><br><span class="line">p=11020676230976310379144333480955164305481508337671531533958882857355974789786031075799055919576025910085939214749300811589385615762060836347634182559393351</span><br><span class="line">n = p ** 3 * q</span><br><span class="line">phi=(p-1) * p ** 2 * (q-1)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="P11-n分解3个素数"><a href="#P11-n分解3个素数" class="headerlink" title="P11-n分解3个素数"></a>P11-n分解3个素数</h2><p>当只有一个n的时候数值太大大概率是分解不出来的,但是题目中还给了r</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q*p=n//e</span><br></pre></td></tr></table></figure>

<p>当因数太多时,也可以进行遍历</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p= 8625629446002416087616014426101611680452369226619936101829519210875924864988663112442687558540403476239934502624312000873792293220687034723552312766306461</span><br><span class="line">q= 8787428457369906789111609101881945107673564450267581022773606833123277959949673902854543714680045950545233419267784298810198649680497763015775229200865411</span><br><span class="line">r= 8710571868980790416166199235274930138558733488320752393377660341832486800895531790664423913727588433527370059997560158592988096954880729283447791962933971</span><br><span class="line">z= 6728975748083903512055770788026455797266535046169402869706568593142106941234036297677674317814645964014118470219436880542585107766059284287955747430843033</span><br><span class="line">n= 4442712714596820006523243075386722399001540649880443633668931130899469080465568341233241314335828692216580674278474606439813143826989789136516291201188001414283032718285598315125566622793202664484211346919827375757443252375618224075563680996389063722114069895571961397810232782190410686777099953409981930356282701755077970898511081732478295148490702768600211657532405007703161631946268735347991422221493766068639234951604979177774225982713355966959175665549764227822550653877270949192231799024747011091747895075557561868027955480264717920845452927803679214301468064150659076880930447200008617802509348180204131134253</span><br><span class="line">e= 65537</span><br><span class="line">c= 3531508293002369327223430522340521723508183010904654829009577366628982233484427715841165993272843959889424045899727422240846421581930930539677428656846653566805435134186424688590921243567644666022160807835566999486299110585667491961281199059701126423704972412815170036356958099353703023897793236469552832908471077891875580715427887694084520010521374153909941447322992636456246460225895812542732210982224354623646602728566580134374898054199226214801500988642149239373775418753206352314472838835060760283395836668050850204861529118679470487762170301387879610864521789874459725701142865537988697282940262684188417365482</span><br><span class="line"></span><br><span class="line">nn = [p, q, r, z]</span><br><span class="line">phi = 1</span><br><span class="line">for i in nn:</span><br><span class="line">    phi *= (i - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="P12-e和phi-n不互素"><a href="#P12-e和phi-n不互素" class="headerlink" title="P12-e和phi_n不互素"></a>P12-e和phi_n不互素</h2><p>e和phi_n不互素是指它俩的公约数不为1. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">出题.py</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    e = random.randint(<span class="number">100</span>, <span class="number">1000</span>)</span><br><span class="line">    p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">    q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">    phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    t = gmpy2.gcd(e, phi_n)</span><br><span class="line">    <span class="keyword">if</span> t == e:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    t1 = e // t</span><br><span class="line">    <span class="keyword">if</span> gmpy2.invert(t1, phi_n) <span class="keyword">and</span> t &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br></pre></td></tr></table></figure>

<p>生成q,p并计算出n后,再计算n的欧拉函数.然后随机一个100-1000,且与n的欧拉函数互质的数作为公钥指数e.然后</p>
<h3 id="libnum-xgcd"><a href="#libnum-xgcd" class="headerlink" title="libnum.xgcd()"></a>libnum.xgcd()</h3><p><code>libnum.xgcd()</code>是一个用于计算最大公约数的函数，它的返回值是一个三元组 <code>(a, b, gcd)</code>，其中 <code>a</code> 和 <code>b</code> 是对于输入的 <code>x</code> 和 <code>y</code> 的贝祖等式解，<code>gcd</code> 是 <code>x</code> 和 <code>y</code> 的最大公约数。</p>
<h3 id="libnum-nroot-与gmpy2-iroot-有区别吗"><a href="#libnum-nroot-与gmpy2-iroot-有区别吗" class="headerlink" title="libnum.nroot()与gmpy2.iroot()有区别吗?"></a>libnum.nroot()与gmpy2.iroot()有区别吗?</h3><p><code>libnum.nroot()</code>和<code>gmpy2.iroot()</code>都是用来求整数的n次方根，但是它们的实现机制略有不同。<code>libnum.nroot()</code>使用的是牛顿迭代方法，而<code>gmpy2.iroot()</code>使用的是二分法和牛顿迭代相结合的方法。一般情况下，<code>gmpy2.iroot()</code>比<code>libnum.nroot()</code>更快，尤其是在需要计算高次方根时。但是，<code>gmpy2.iroot()</code>需要更多的内存，因为它使用了GMP库，而<code>libnum.nroot()</code>只是用了Python自带的整数计算库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p= 114860030223592619350237076742461403575528435402774766459705701680556072467298617610581777886510443798768760588917000064624429163483472033411173154226526417552755161814345957494400517446185751802692568711852997572341336163712934788566431727024238884168170191297981779113503335055398572978014942647431809270853</span><br><span class="line">q= 141482565717017233529669025580185565758429034465042343867181625442643980151252909726291828497489103438319103643405598161360684249778576450822593519521704724411078217709275434453930452079459665234089519451224803629599152230328076081266366130649851948619652836786462060176129275288779211468278776614039268608741</span><br><span class="line">e= 566</span><br><span class="line">c= 6474869810720227719792847921244356633448316005500658301523501001810915540630285841460205215171442133160380838970501228761826351818286973649330046985848821713764873885471316305023498157162154995032588507169615233169035227087146325247626806623552675929336124326942412915133611084499751391655929421428038758175761894411487885519860021503443808733034827547303678595679401956020281620652662094521117686138615982251884716358164958223086880425941936239186374552744762658955098490029891797313625205546072763790183958468331048662233738917068923045457808776246425515722038764979853387088737835072217998283752881117291687164516</span><br><span class="line">n=q*p</span><br><span class="line">phi=(q-1)*(p-1)</span><br><span class="line">t=gmpy2.gcd(e,phi)#求e,phi的最大公约数</span><br><span class="line">d,y,g=libnum.xgcd(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">flag=libnum.nroot(m,t)</span><br><span class="line">print(libnum.n2s(flag))</span><br></pre></td></tr></table></figure>

<p>另外long_to_bytes()与libnum.n2s()也是一样的</p>
<h2 id="P13-NC不互素"><a href="#P13-NC不互素" class="headerlink" title="P13-NC不互素"></a>P13-NC不互素</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">题目.py</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = <span class="number">2021</span> * m * <span class="number">1001</span> * p</span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = 17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line"><span class="comment">#c = 6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i0.hdslb.com/bfs/article/80a3ec0870529a8d97411987b6aae935b9abf62e.png@935w_381h_progressive.webp" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">n= 17483770234884142847456666352881633858141093959507406489438832657811880348544517317886235174580364402693136945332374390980468053811072776178864091768180166876221659675217180437370214612891072604883134760061297589091497848817124108984000363937311663848944163413212471490943544013729793140932153932722897244086933590069840634776188515344586162299372418033246808686151342011111253737930983815234958893340565218112060881945578082230607232140507764864201490541905951630320920698022711376246588071419161730102709168468030659029885654176255175171297966568656762020277408125453099365768353256668477237850688484624314512104837</span><br><span class="line">c= 7756412419736534306267281137444055853970895832135119947012680801728368453412511898214833061840593207999925914861147437172775590961864429038538036044372917920901477955515874667827839423934284921039793035016663689671993982388770276121107464667278667672531024583000281458905472417802844581894023365347884859881069456113169832521363450118618605256637768282911914962650680421804219666243987097956602779278718190490013281291054728762585198175600573970428128728004843715806947600331454660689313029334295614495527134693874900019066579958992524583794853232795458791635025434351607697221423673529269965794629214578773549342054</span><br><span class="line">e= 65537</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n, c)#为什么n,c的最大公约数是p,因为这里的c=pow(m*p,e,n)</span><br><span class="line">q = n // p</span><br><span class="line">assert p * q == n</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">m1 = m // p</span><br><span class="line">print(libnum.n2s(int(m1)))</span><br></pre></td></tr></table></figure>

<h2 id="P14-rabin"><a href="#P14-rabin" class="headerlink" title="P14-rabin"></a>P14-rabin</h2><h3 id="Rabin加密算法"><a href="#Rabin加密算法" class="headerlink" title="Rabin加密算法"></a>Rabin加密算法</h3><p>参考文章:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26816591/article/details/82949341?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167816716916800215090392%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=167816716916800215090392&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-82949341-null-null.blog_rank_default&amp;utm_term=rabin&amp;spm=1018.2226.3001.4450">https://blog.csdn.net/qq_26816591/article/details/82949341?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167816716916800215090392%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=167816716916800215090392&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-82949341-null-null.blog_rank_default&amp;utm_term=rabin&amp;spm=1018.2226.3001.4450</a></p>
<h4 id="密钥创建"><a href="#密钥创建" class="headerlink" title="密钥创建"></a>密钥创建</h4><p>随机选取大而不同的素数p,q,值相近</p>
<p>计算<code>N=p*q</code></p>
<p><code>PK(N)</code> <code>SK(p,q)</code></p>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p><code>C=M**2 mod N</code></p>
<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p><img src="https://private.codecogs.com/gif.latex?m_%7Bp%7D=%5Csqrt%7BC%7D%20mod%20p,m_%7Bq%7D=%5Csqrt%7BC%7D%20mod%20q,y_%7Bp%7D%5Ctimes%20p&plus;y_%7Bq%7D%5Ctimes%20q=1" alt="m_{p}=\sqrt{C} mod p,m_{q}=\sqrt{C} mod q,y_{p}\times p+y_{q}\times q=1"></p>
<p><img src="https://img-blog.csdn.net/20181006102332968?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2ODE2NTkx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="4M"></p>
<p>求出4个M,故需要提供额外验证信息</p>
<p>具体过程如图（点击进入全屏）：</p>
<p><img src="https://img-blog.csdn.net/20181006102516968?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2ODE2NTkx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="Rabin"></p>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><strong>密文flag</strong></p>
<p>ZNpjDckEhgOPDHBmMhKYQ+tMzVV&#x2F;EMe4W+oLoWKWqvQ<br><strong>公钥pubkey.pem</strong></p>
<p>—–BEGIN PUBLIC KEY—–<br>MDowDQYJKoZIhvcNAQEBBQADKQAwJgIhAMJjauXD2OQ&#x2F;+5erCQKPGqxsC&#x2F;bNPXDr<br>yigb&#x2F;+l&#x2F;vjDdAgEC<br>—–END PUBLIC KEY—– </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">题目.py</span><br><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">n = p * q</span><br><span class="line">e = 2</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">#单看出题看不出什么.</span><br></pre></td></tr></table></figure>

<p>脚本一把梭哈</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">p= 7792122537286410916458388293351860607688604511292344596918661119155253722812758382934048031344855784696048378797531951019608168378719301923902650317876259</span><br><span class="line">q= 8279749911926691124226705501808245974614987147711355018965419145913141477425391807253552818011949467266621201161250694748775831949075192563619278845806199</span><br><span class="line">n= 64516825891819145761245961999149062346764836337774412279532814976152553452961530891142431839168830669346498309718970407414664207402326748115870539429710753340448311266646841374827966777982592597825441505482051203126453304849513498189196937954076648359192685230992089742996108414088505304103502310062377129541</span><br><span class="line">c= 3136716033729285109182429766120038518392561923329542531593950566444100624149801988673790218160519702344805734260593699421186773099530182927108143419558870598355820534834890989449496435005462772709585161</span><br><span class="line">e= 2</span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = pow(c, (p + 1) // 4, p)</span><br><span class="line">mq = pow(c, (q + 1) // 4, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - int(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - int(c)</span><br><span class="line"># 因为rabin 加密有四种结果，全部列出。</span><br><span class="line">aa = [a, b, c, d]</span><br><span class="line">for i in aa:</span><br><span class="line">    print(i)</span><br><span class="line">    print(libnum.n2s(int(i)))</span><br></pre></td></tr></table></figure>

<h2 id="P15-m高位泄露"><a href="#P15-m高位泄露" class="headerlink" title="P15-m高位泄露"></a>P15-m高位泄露</h2><p>脚本一把梭哈,直接出明文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#sage</span><br><span class="line">import libnum</span><br><span class="line">n= 131917499434700248044275382461696718824806985676832376392826205031675268720989954179470797211169457140826839859469217649323301084204982204790901890593523164403145256068404143346783182542001188488303919469155887951553252719704313183682973432749971275744713080229645485484470703216367543977997065296226519329553</span><br><span class="line">c= 175676150266403074456738294710204622565025008386037001142785482640529523338991864461357145815832102381737462085151590621329147599386573099919969708243887609337194009221646222008417992291793015508635692836460848836371531362730179942256350305230518383301037205375342413652101623455889867597342746854391653</span><br><span class="line">e= 3</span><br><span class="line">m1= 56006392793404565555447896541754388635231681641159061674512681823768096127042573685919604921093863037</span><br><span class="line"></span><br><span class="line">#phase2(high_m, n, c,e):</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=&#x27;NTL&#x27;)</span><br><span class="line">m = m1 + x</span><br><span class="line">mm = m((m^e - c).small_roots()[0])</span><br><span class="line">#print(libnum.n2s(int(mm)))</span><br><span class="line">print(int(mm))</span><br><span class="line">#phase2(m1, n, c,e)</span><br></pre></td></tr></table></figure>

<p>当然也能直接出flag的但是不太会用sage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#sage</span><br><span class="line">import libnum</span><br><span class="line">n= 151960946972702081117093360145150451962009606399284283949493014851527184623949643832244795119390951664496262788801113061738745471705109651801469941245713981102683597278171804859002235073409069064532316371103411496330579589757997270705141792018944994603558174557515947534514865010671376327712345796006705526541</span><br><span class="line">c= 175676150266417004297584173166433352018610464097263332979457040860199735122833311628588245224087655808166100611110577476473768211724924905653808872550861589950953763432355842437271483012029579464732704952936714503937167618229688691848715162564826927771471544937668578504504217271902336934966580193607269</span><br><span class="line">e= 3</span><br><span class="line">m1= 56006392793406045855300363310507945362344210576887867606743770445705804994335695867672312071808311296</span><br><span class="line"></span><br><span class="line">def phase2(high_m, n, c,e):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=&#x27;NTL&#x27;)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    mm = m((m^e - c).small_roots()[0])</span><br><span class="line">    print(libnum.n2s(int(mm)))</span><br><span class="line"></span><br><span class="line">phase2(m1, n, c,e)</span><br></pre></td></tr></table></figure>



<h2 id="P16-p高位攻击"><a href="#P16-p高位攻击" class="headerlink" title="P16-p高位攻击"></a>P16-p高位攻击</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">出题脚本.py</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p1 = ((p &gt;&gt; <span class="number">256</span>) &lt;&lt; <span class="number">256</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p1=&quot;</span>, p1)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># sage</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">n = 13825843519571710873428859414579672354315071659439820628244472999485866649052110805457869338590187514116602837815124140432484262117371676976267721436244227104792863856722306533085878006249426437815405943285837409223882200429650139498565410193518318609186404321541002818447049590702693207093178119976930306188313389812258040902404991392273477524090663507230185854302508398487606160947861933574298409247029121725657976002346558116475950788745748638760678901488207720494815927253554983917627634826826305748104732049673766438361103134678640861807396808490547480920918122602522866517282598354247700246018620827186407222291</span><br><span class="line">c = 8069176849119953284725698979637300857649466313773809113683642222085416457809259502704557882469560357376639733126836429991182536164084894508162647211766121557706947090701813794460382373772210944822854491223080171468124365453829931994686613388386398672952889685840411999135073540598959537338763755743580187011320135902778073983544957246842281172553032459418474893043913045926987625022043858637785478142565769241237336503137679001977264793413893322859182579535729775068010748011003277877267258462798570180414065271758061734676359804300115257687481351307213343011733330342628658103765597956044989311340712232509671201918</span><br><span class="line">e = 65537</span><br><span class="line">p1 = 109808212971964883545767217899164260396892558575747412957992952622503445366463665637485518479176308697194263286931473866511191437500214960131113514969332424915850812713465121027047280080223105730986925447033745115390014601545111178800361343308690136190170861353596131750311275899169955729432487964244199866368</span><br><span class="line">kbits = 256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def phase3(high_p, n):</span><br><span class="line">    R. &lt; x &gt; = PolynomialRing(Zmod(n), implementation=&#x27;NTL&#x27;)</span><br><span class="line">    p = high_p + x</span><br><span class="line">    x0 = p.small_roots(X=2 ^ kbits, beta=0.1)[0]</span><br><span class="line"></span><br><span class="line">    P = int(p(x0))</span><br><span class="line">    Q = n // P</span><br><span class="line">    assert n == P * Q</span><br><span class="line">    return P, Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = phase3(p1, n)</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = libnum.invmod(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>



<h2 id="P17-d低位攻击-回去试一试"><a href="#P17-d低位攻击-回去试一试" class="headerlink" title="P17-d低位攻击(回去试一试)"></a>P17-d低位攻击(回去试一试)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">题目.py</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">    q = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(e, phi_n) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">d1 = d &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">486</span>) - <span class="number">1</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d1=&quot;</span>, d)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getFullP(low_p, n):</span><br><span class="line">    R. &lt; x &gt; = PolynomialRing(Zmod(n), implementation=&#x27;NTL&#x27;)</span><br><span class="line">    p = x * 2 ^ bit + low_p</span><br><span class="line">    root = (p - n).monic().small_roots(X=2 ^ 128, beta=0.4)</span><br><span class="line">    if root:</span><br><span class="line">        return p(root[0])</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def phase4(low_d, n, c):</span><br><span class="line">    maybe_p = []</span><br><span class="line">    for k in range(1, 4):</span><br><span class="line">        p = var(&#x27;p&#x27;)</span><br><span class="line">        p0 = solve_mod([3 * p * low_d == p + k * (n * p - p ^ 2 - n + p)], 2 ^ bit)</span><br><span class="line">        maybe_p += [int(x[0]) for x in p0]</span><br><span class="line">    # print(maybe_p)</span><br><span class="line"></span><br><span class="line">    for x in maybe_p:</span><br><span class="line">        P = getFullP(x, n)</span><br><span class="line">        if P: break</span><br><span class="line"></span><br><span class="line">    P = int(P)</span><br><span class="line">    Q = n // P</span><br><span class="line"></span><br><span class="line">    assert P * Q == n</span><br><span class="line">    print(P)</span><br><span class="line">    print(Q)</span><br><span class="line"></span><br><span class="line">    d = inverse_mod(3, (P - 1) * (Q - 1))</span><br><span class="line">    print(d)</span><br><span class="line">    print(libnum.n2s(int(power_mod(c, d, n))))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bit = 486</span><br><span class="line">n = 99233273001596380809501393613886417854988989363311895592445631124571940638105064581031336422148895730117448547059137492090852484233539441265373247940823283633017582469362503632785297924194187912199716752955609363457416190782142095008241313065484612071705711161086869849047664563205898255359661312582650481473</span><br><span class="line">e = 3</span><br><span class="line">c = 175676150266403937224898870626869248307097859453341599800113943191154294552011908698393750389195590199207971365632903719917006078351629939912360175671032635640354766675409868021903917260597989036476083685690139071290022752606720020238530580507331902326179201548484337939338062870542095137303322195300197</span><br><span class="line">d1 = 66155515334397587206334262409257611903325992908874597061630420749714627092070043054020890948099263820078299031372758328060568322822359627510248831960548842374360111368587702677016263988651746874367056185352095585037936034196599496577057035033718066207964292781685419156037246789689219471468151618592221802699</span><br><span class="line"></span><br><span class="line">phase4(d1, n, c)</span><br></pre></td></tr></table></figure>

<h2 id="P18-Franklin-Reiter-相关消息攻击"><a href="#P18-Franklin-Reiter-相关消息攻击" class="headerlink" title="P18-Franklin Reiter 相关消息攻击"></a>P18-Franklin Reiter 相关消息攻击</h2><h2 id="P19-Boneh-Durfee-攻击"><a href="#P19-Boneh-Durfee-攻击" class="headerlink" title="P19-Boneh Durfee 攻击"></a>P19-Boneh Durfee 攻击</h2><h2 id="P20-AMM算法"><a href="#P20-AMM算法" class="headerlink" title="P20-AMM算法"></a>P20-AMM算法</h2><h2 id="P21-共模攻击变形"><a href="#P21-共模攻击变形" class="headerlink" title="P21-共模攻击变形"></a>P21-共模攻击变形</h2><h2 id="P22-有限域开方"><a href="#P22-有限域开方" class="headerlink" title="P22-有限域开方"></a>P22-有限域开方</h2><h2 id="P23-维纳攻击-3素数"><a href="#P23-维纳攻击-3素数" class="headerlink" title="P23-维纳攻击(3素数)"></a>P23-维纳攻击(3素数)</h2><h1 id="RSA-风二西"><a href="#RSA-风二西" class="headerlink" title="RSA_风二西"></a>RSA_风二西</h1><p>这一篇主要是看的这位大佬的博客:</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sigenzhe/articles/15641699.html">https://www.cnblogs.com/sigenzhe/articles/15641699.html</a></p>
<h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><p>e很小为低加密指数攻击</p>
<ul>
<li>m^x&lt;n,也就是说m^x&#x3D;n</li>
<li>m^x&gt;n,即(m^x+i*n)mod n &#x3D; c (爆破)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(long_to_bytes(gmpy2.iroot(c, 2)[0]).decode())</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">k=0</span><br><span class="line">while(gmpy2.iroot(c+k*n,e)[1]==False):</span><br><span class="line">    k += 1</span><br><span class="line">m=gmpy2.iroot(c+k*n,e)[0]</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<p>当然还可以直接对c进行解码,因为</p>
<p>RSA的原理中<code>c =m^e(mod n)</code>,当e为1时,</p>
<p>c &#x3D; m (mod n)</p>
<p>因为m是小于n的</p>
<p>所以m就等于c,即密文就是明文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">m = <span class="number">56006392793403067781861231386277942050474101531963376999457063633948500765747587998496106575433840765</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><p>已知n,c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n1= 118092134022377360661225961672691761351</span><br><span class="line">c1= 63075178202446680079880283788108865386</span><br><span class="line">n2= 131982280798025482480679806750823740427</span><br><span class="line">c2= 15522850091847347005500042263079362509</span><br><span class="line">n3= 190702045710405249076460028068209136149</span><br><span class="line">c3= 174201535677204455900991898861699840140</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io">Jinmu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/">https://jinmu1108.github.io/Crypto%E9%A2%98%E7%9B%AE/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/%E9%A3%8E%E4%BA%8C%E8%A5%BFRSA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jinmu1108.github.io" target="_blank">J1Nmu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/%E5%88%B7%E9%A2%98/">刷题</a><a class="post-meta__tags" href="/tags/RSA/">RSA</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">攻防世界-crypto</div></div></a></div><div class="next-post pull-right"><a href="/Crypto/AES/Crypto-AES/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Crypto-AES</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Crypto%E9%A2%98%E7%9B%AE/ctf-crypto/ctfs-crypto/" title="ctf-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">ctf-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/qsn-crypto/qsn-crypto/" title="qsn-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">qsn-crypto</div></div></a></div><div><a href="/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/" title="攻防世界-crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-15</div><div class="title">攻防世界-crypto</div></div></a></div><div><a href="/Crypto/Crypto/" title="Crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-05</div><div class="title">Crypto</div></div></a></div><div><a href="/Python/Sagemath/sagemath%E7%9A%84%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/" title="sagemath的初步学习"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-09</div><div class="title">sagemath的初步学习</div></div></a></div><div><a href="/%E9%9D%B6%E5%9C%BA/NSSCTF/" title="NSSCTF"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-14</div><div class="title">NSSCTF</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jinmu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA-%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text">RSA_基础篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#P01-N%E5%88%86%E8%A7%A3"><span class="toc-number">1.1.</span> <span class="toc-text">P01 N分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P02-%E5%AF%86%E9%92%A5-OAEP"><span class="toc-number">1.2.</span> <span class="toc-text">P02 密钥-OAEP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P03-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.</span> <span class="toc-text">P03-共模攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P04-%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC"><span class="toc-number">1.4.</span> <span class="toc-text">P04-维纳攻击脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P05-%E5%B0%8Fe"><span class="toc-number">1.5.</span> <span class="toc-text">P05-小e</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P06-%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">1.6.</span> <span class="toc-text">P06-广播攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P07-N%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="toc-number">1.7.</span> <span class="toc-text">P07-N不互素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%B8%80"><span class="toc-number">1.7.1.</span> <span class="toc-text">题目一</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88p%E6%98%AFn1-n2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0%E5%91%A2"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">为什么p是n1,n2的最大公约数呢?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%BA%8C"><span class="toc-number">1.7.2.</span> <span class="toc-text">题目二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P08-dp%E6%B3%84%E9%9C%B2"><span class="toc-number">1.8.</span> <span class="toc-text">P08-dp泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P09-dp-dq"><span class="toc-number">1.9.</span> <span class="toc-text">P09-dp,dq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P10-N%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9"><span class="toc-number">1.10.</span> <span class="toc-text">P10-N是p的r次方</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%B8%80-1"><span class="toc-number">1.10.1.</span> <span class="toc-text">题目一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%BA%8C-1"><span class="toc-number">1.10.2.</span> <span class="toc-text">题目二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P11-n%E5%88%86%E8%A7%A33%E4%B8%AA%E7%B4%A0%E6%95%B0"><span class="toc-number">1.11.</span> <span class="toc-text">P11-n分解3个素数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P12-e%E5%92%8Cphi-n%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="toc-number">1.12.</span> <span class="toc-text">P12-e和phi_n不互素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#libnum-xgcd"><span class="toc-number">1.12.1.</span> <span class="toc-text">libnum.xgcd()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libnum-nroot-%E4%B8%8Egmpy2-iroot-%E6%9C%89%E5%8C%BA%E5%88%AB%E5%90%97"><span class="toc-number">1.12.2.</span> <span class="toc-text">libnum.nroot()与gmpy2.iroot()有区别吗?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P13-NC%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="toc-number">1.13.</span> <span class="toc-text">P13-NC不互素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P14-rabin"><span class="toc-number">1.14.</span> <span class="toc-text">P14-rabin</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.14.1.</span> <span class="toc-text">Rabin加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E5%88%9B%E5%BB%BA"><span class="toc-number">1.14.1.1.</span> <span class="toc-text">密钥创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">1.14.1.2.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">1.14.1.3.</span> <span class="toc-text">解密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.14.2.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P15-m%E9%AB%98%E4%BD%8D%E6%B3%84%E9%9C%B2"><span class="toc-number">1.15.</span> <span class="toc-text">P15-m高位泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P16-p%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB"><span class="toc-number">1.16.</span> <span class="toc-text">P16-p高位攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P17-d%E4%BD%8E%E4%BD%8D%E6%94%BB%E5%87%BB-%E5%9B%9E%E5%8E%BB%E8%AF%95%E4%B8%80%E8%AF%95"><span class="toc-number">1.17.</span> <span class="toc-text">P17-d低位攻击(回去试一试)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P18-Franklin-Reiter-%E7%9B%B8%E5%85%B3%E6%B6%88%E6%81%AF%E6%94%BB%E5%87%BB"><span class="toc-number">1.18.</span> <span class="toc-text">P18-Franklin Reiter 相关消息攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P19-Boneh-Durfee-%E6%94%BB%E5%87%BB"><span class="toc-number">1.19.</span> <span class="toc-text">P19-Boneh Durfee 攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P20-AMM%E7%AE%97%E6%B3%95"><span class="toc-number">1.20.</span> <span class="toc-text">P20-AMM算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P21-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%E5%8F%98%E5%BD%A2"><span class="toc-number">1.21.</span> <span class="toc-text">P21-共模攻击变形</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P22-%E6%9C%89%E9%99%90%E5%9F%9F%E5%BC%80%E6%96%B9"><span class="toc-number">1.22.</span> <span class="toc-text">P22-有限域开方</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P23-%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB-3%E7%B4%A0%E6%95%B0"><span class="toc-number">1.23.</span> <span class="toc-text">P23-维纳攻击(3素数)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA-%E9%A3%8E%E4%BA%8C%E8%A5%BF"><span class="toc-number">2.</span> <span class="toc-text">RSA_风二西</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA1"><span class="toc-number">2.1.</span> <span class="toc-text">RSA1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA2"><span class="toc-number">2.2.</span> <span class="toc-text">RSA2</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%B6%E5%9C%BA/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB/" title="攻防世界-Web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="攻防世界-Web"/></a><div class="content"><a class="title" href="/%E9%9D%B6%E5%9C%BA/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB/" title="攻防世界-Web">攻防世界-Web</a><time datetime="2023-03-18T01:41:31.101Z" title="发表于 2023-03-18 09:41:31">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="伪协议"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="伪协议"/></a><div class="content"><a class="title" href="/Web/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="伪协议">伪协议</a><time datetime="2023-03-18T01:34:11.979Z" title="发表于 2023-03-18 09:34:11">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/SSTI/SSTI%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/" title="SSTI初步学习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSTI初步学习"/></a><div class="content"><a class="title" href="/Web/SSTI/SSTI%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/" title="SSTI初步学习">SSTI初步学习</a><time datetime="2023-03-18T01:29:01.760Z" title="发表于 2023-03-18 09:29:01">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="序列化与反序列化"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="序列化与反序列化"/></a><div class="content"><a class="title" href="/Web/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="序列化与反序列化">序列化与反序列化</a><time datetime="2023-03-18T01:28:30.884Z" title="发表于 2023-03-18 09:28:30">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/" title="攻防世界-crypto"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="攻防世界-crypto"/></a><div class="content"><a class="title" href="/Crypto%E9%A2%98%E7%9B%AE/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Crypto/" title="攻防世界-crypto">攻防世界-crypto</a><time datetime="2023-03-15T05:19:45.011Z" title="发表于 2023-03-15 13:19:45">2023-03-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jinmu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>